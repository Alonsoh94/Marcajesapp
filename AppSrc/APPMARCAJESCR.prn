Compiling Program: C:\DataFlex Projects\MARCAJESAPP\AppSrc\APPMARCAJESCR.src
Memory Available: 2147483646
1>//**************************************************************
1>// WindowsProject.tpl for Spanish translated by Moose Software (www.moose-software.com) 
1>// 28/10/2008 revised for VDF 14.1 by Moose Software  
1>// 13/07/2010 Revised for VDF 16.0 by Moose Software
1>// 05/02/2012 Revised for VDF 17.0 by Moose Software
1>// 13/06/2013 Revised for VDF 17.1 by Moose Software
1>// 02/05/2014 Revised for VDF 18.0 by Moose Software
1>//*************************************************************************************
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 18.2\Pkg\dfallent.pkd)
75339>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardCommandBarSystem.pkg)
75339>>>// these are all the packages used in a standard MDI menubar/toolbar system
75339>>>
75339>>>Use cCJCommandBarSystem.pkg
75339>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardMenuItemClasses.pkg)
75339>>>>>Use Dfpanel.pkg
75339>>>>>Use cCJCommandBarSystem.pkg
75339>>>>>Use LanguageText.pkg
75339>>>>>
75339>>>>>
75339>>>>>Class cCJUndoMenuItem is a cCJMenuItem
75340>>>>>    
75340>>>>>    Procedure Construct_Object
75342>>>>>        Forward Send Construct_Object
75344>>>>>        Set psCaption   to C_$CaptionUndo
75345>>>>>        Set psToolTip to C_$ToolTipUndo
75346>>>>>        Set psDescription to C_$DescUndo
75347>>>>>        Set psImage to "ActionUndo.ico"
75348>>>>>        Set pbActiveUpdate to True
75349>>>>>        Set psCategory to C_$CategoryEdit
75350>>>>>        Set psShortcut to C_$Key_Ctrl_Z
75351>>>>>    End_Procedure
75352>>>>>
75352>>>>>    Procedure OnExecute Variant vCommandBarControl
75354>>>>>        Send Undo of (focus(Self))
75355>>>>>    End_Procedure
75356>>>>>    
75356>>>>>    Function IsEnabled Returns Boolean
75358>>>>>        Boolean bEnabled
75358>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
75359>>>>>        Function_Return bEnabled
75360>>>>>    End_Function
75361>>>>>         
75361>>>>>End_Class
75362>>>>>
75362>>>>>
75362>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
75363>>>>>    
75363>>>>>    Procedure Construct_Object
75365>>>>>        Forward Send Construct_Object
75367>>>>>        Set psCaption   to C_$CaptionDelete
75368>>>>>        Set psToolTip to C_$ToolTipDelete
75369>>>>>        Set psDescription to C_$DescDelete
75370>>>>>        Set psImage to "actionDelete.ico"
75371>>>>>        Set psShortcut to C_$Key_Delete
75372>>>>>        Set pbActiveUpdate to True
75373>>>>>        Set psCategory to C_$CategoryEdit
75374>>>>>    End_Procedure
75375>>>>>
75375>>>>>
75375>>>>>    Procedure OnExecute Variant vCommandBarControl
75377>>>>>        Send Delete of (focus(Self))
75378>>>>>    End_Procedure
75379>>>>>    
75379>>>>>    Function IsEnabled Returns Boolean
75381>>>>>        Boolean bEnabled
75381>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
75382>>>>>        Function_Return bEnabled
75383>>>>>    End_Function
75384>>>>>         
75384>>>>>End_Class
75385>>>>>
75385>>>>>
75385>>>>>Class cCJCutMenuItem is a cCJMenuItem
75386>>>>>    
75386>>>>>    Procedure Construct_Object
75388>>>>>        Forward Send Construct_Object
75390>>>>>        Set psCaption   to C_$CaptionCut
75391>>>>>        Set psToolTip to C_$TooltipCut
75392>>>>>        Set psDescription to C_$DescCut
75393>>>>>        Set psImage to "actionCut.ico"
75394>>>>>        Set psShortcut to C_$Key_Ctrl_X
75395>>>>>        Set pbActiveUpdate to True
75396>>>>>        Set psCategory to C_$CategoryEdit
75397>>>>>    End_Procedure
75398>>>>>
75398>>>>>
75398>>>>>    Procedure OnExecute Variant vCommandBarControl
75400>>>>>        Send Cut of (focus(Self))
75401>>>>>    End_Procedure
75402>>>>>    
75402>>>>>    Function IsEnabled Returns Boolean
75404>>>>>        Boolean bEnabled
75404>>>>>        Get CanCut of (Focus(Self)) to bEnabled
75405>>>>>        Function_Return bEnabled
75406>>>>>    End_Function
75407>>>>>         
75407>>>>>End_Class
75408>>>>>
75408>>>>>
75408>>>>>Class cCJCopyMenuItem is a cCJMenuItem
75409>>>>>    
75409>>>>>    Procedure Construct_Object
75411>>>>>        Forward Send Construct_Object
75413>>>>>        Set psCaption   to C_$CaptionCopy
75414>>>>>        Set psToolTip to C_$ToolTipCopy
75415>>>>>        Set psDescription to C_$DescCopy
75416>>>>>        Set psImage to "actionCopy.ico"
75417>>>>>        Set psShortcut to C_$Key_Ctrl_C
75418>>>>>        Set pbActiveUpdate to True
75419>>>>>        Set psCategory to C_$CategoryEdit
75420>>>>>    End_Procedure
75421>>>>>
75421>>>>>
75421>>>>>    Procedure OnExecute Variant vCommandBarControl
75423>>>>>        Send Copy of (focus(Self))
75424>>>>>    End_Procedure
75425>>>>>    
75425>>>>>    Function IsEnabled Returns Boolean
75427>>>>>        Boolean bEnabled
75427>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
75428>>>>>        Function_Return bEnabled
75429>>>>>    End_Function
75430>>>>>         
75430>>>>>End_Class
75431>>>>>
75431>>>>>
75431>>>>>Class cCJPasteMenuItem is a cCJMenuItem
75432>>>>>    
75432>>>>>    Procedure Construct_Object
75434>>>>>        Forward Send Construct_Object
75436>>>>>        Set psCaption   to C_$CaptionPaste
75437>>>>>        Set psToolTip to C_$ToolTipPaste
75438>>>>>        Set psDescription to C_$DescPaste
75439>>>>>        Set psImage to "actionPaste.ico"
75440>>>>>        Set pbActiveUpdate to True
75441>>>>>        Set psShortcut to C_$Key_Ctrl_V
75442>>>>>        Set psCategory to C_$CategoryEdit
75443>>>>>    End_Procedure
75444>>>>>
75444>>>>>
75444>>>>>    Procedure OnExecute Variant vCommandBarControl
75446>>>>>        Send Paste of (focus(Self))
75447>>>>>    End_Procedure
75448>>>>>    
75448>>>>>    Function IsEnabled Returns Boolean
75450>>>>>        Boolean bEnabled
75450>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
75451>>>>>        Function_Return bEnabled
75452>>>>>    End_Function
75453>>>>>         
75453>>>>>End_Class
75454>>>>>
75454>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
75455>>>>>    
75455>>>>>    Procedure Construct_Object
75457>>>>>        Forward Send Construct_Object
75459>>>>>        Set psCaption   to C_$CaptionSelectAll
75460>>>>>        Set psToolTip to C_$ToolTipSelectAll
75461>>>>>        Set psDescription to C_$DescSelectAll
75462>>>>>        Set pbActiveUpdate to True
75463>>>>>        Set psShortcut to C_$Key_Ctrl_A
75464>>>>>        Set psCategory to C_$CategoryEdit
75465>>>>>    End_Procedure
75466>>>>>
75466>>>>>
75466>>>>>    Procedure OnExecute Variant vCommandBarControl
75468>>>>>        Send Select_All of (focus(Self))
75469>>>>>    End_Procedure
75470>>>>>    
75470>>>>>    Function IsEnabled Returns Boolean
75472>>>>>        Boolean bEnabled
75472>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
75473>>>>>        Function_Return bEnabled
75474>>>>>    End_Function
75475>>>>>         
75475>>>>>End_Class
75476>>>>>
75476>>>>> 
75476>>>>>Class cCJExitMenuItem is a cCJMenuItem
75477>>>>>
75477>>>>>    Procedure Construct_Object
75479>>>>>        Forward Send Construct_Object
75481>>>>>        Set psCaption to C_$CaptionExit
75482>>>>>        Set psToolTip to C_$ToolTipExit
75483>>>>>        Set psDescription to C_$ToolTipExit
75484>>>>>        Set psShortcut to C_$Key_Alt_F4
75485>>>>>        Set psCategory to C_$CategoryFile
75486>>>>>    End_Procedure
75487>>>>>
75487>>>>>    Procedure OnExecute Variant vCommandBarControl
75489>>>>>        Send Exit_Application of Desktop
75490>>>>>    End_Procedure
75491>>>>>
75491>>>>>End_Class           
75492>>>>>
75492>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
75493>>>>>
75493>>>>>    Procedure Construct_Object
75495>>>>>        Forward Send Construct_Object
75497>>>>>        Set psCaption to C_$CaptionHelp
75498>>>>>        Set psDescription to C_$ToolTipHelp
75499>>>>>        Set psToolTip to C_$DescHelp
75500>>>>>        Set psImage to "ActionHelp.ico"
75501>>>>>        Set psShortcut to "F1"
75502>>>>>        Set psCategory to C_$CategoryHelp
75503>>>>>    End_Procedure
75504>>>>>    
75504>>>>>    Procedure OnExecute Variant vCommandBarControl
75506>>>>>        Send Help of (Focus(Self))
75507>>>>>    End_Procedure
75508>>>>>
75508>>>>>End_Class
75509>>>>>
75509>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
75510>>>>>
75510>>>>>    Procedure Construct_Object
75512>>>>>        Forward Send Construct_Object
75514>>>>>        Set psCaption to C_$CaptionAddStatusbar
75515>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
75516>>>>>        Set psDescription to  C_$DescAddStatusbar
75517>>>>>        Set psCategory to C_$CategoryWindow
75518>>>>>    End_Procedure
75519>>>>>
75519>>>>>    Procedure OnExecute Variant vCommandBarControl
75521>>>>>        Handle hoCommandBars hoClientArea
75521>>>>>        Get CommandBarSystemObject to hoCommandBars
75522>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75523>>>>>        If hoClientArea Begin
75525>>>>>            // the clientarea's parent panel has message
75525>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
75526>>>>>        End
75526>>>>>>
75526>>>>>    End_Procedure
75527>>>>>
75527>>>>>     Function IsChecked Returns Boolean
75529>>>>>        Boolean bOn
75529>>>>>        Handle hoCommandBars hoClientArea
75529>>>>>        Get CommandBarSystemObject to hoCommandBars
75530>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75531>>>>>        If hoClientArea Begin
75533>>>>>            // the clientarea's parent panel has message
75533>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
75534>>>>>        End
75534>>>>>>
75534>>>>>        Function_Return bOn
75535>>>>>     End_Function
75536>>>>>End_Class
75537>>>>>
75537>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
75538>>>>>
75538>>>>>    Procedure Construct_Object
75540>>>>>        Forward Send Construct_Object
75542>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
75543>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
75544>>>>>        Set psDescription to C_$DescAutoArrangeIcons
75545>>>>>        Set psCategory to C_$CategoryWindow
75546>>>>>    End_Procedure
75547>>>>>
75547>>>>>    Procedure OnExecute Variant vCommandBarControl
75549>>>>>        Handle hoCommandBars hoClientArea
75549>>>>>        Get CommandBarSystemObject to hoCommandBars
75550>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75551>>>>>        If hoClientArea Begin
75553>>>>>            // the clientarea's parent panel has message
75553>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
75554>>>>>        End
75554>>>>>>
75554>>>>>    End_Procedure
75555>>>>>    
75555>>>>>     Function IsChecked Returns Boolean
75557>>>>>        Boolean bOn
75557>>>>>        Handle hoCommandBars hoClientArea
75557>>>>>        Get CommandBarSystemObject to hoCommandBars
75558>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75559>>>>>        If hoClientArea Begin
75561>>>>>            // the clientarea's parent panel has message
75561>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
75562>>>>>        End
75562>>>>>>
75562>>>>>        Function_Return bOn
75563>>>>>     End_Function
75564>>>>>End_Class
75565>>>>>
75565>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
75566>>>>>
75566>>>>>    Procedure Construct_Object
75568>>>>>        Forward Send Construct_Object
75570>>>>>        Set psCaption to C_$CaptionRestoreMenus
75571>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
75572>>>>>        Set psDescription to C_$DescRestoreMenus
75573>>>>>        Set psCategory to C_$CategoryWindow
75574>>>>>    End_Procedure
75575>>>>>
75575>>>>>    Procedure OnExecute Variant vCommandBarControl
75577>>>>>        Handle hoCommandBars
75577>>>>>        Get CommandBarSystemObject to hoCommandBars
75578>>>>>        Send RestoreLayout of hoCommandBars
75579>>>>>    End_Procedure
75580>>>>>    
75580>>>>>End_Class
75581>>>>>
75581>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
75582>>>>>
75582>>>>>    Procedure Construct_Object
75584>>>>>        Forward Send Construct_Object
75586>>>>>        Set psCaption to C_$CaptionCascade
75587>>>>>        Set psToolTip to C_$ToolTipCascade
75588>>>>>        Set psDescription to  C_$DescCascade
75589>>>>>        Set psImage to "ActionCascade.ico"
75590>>>>>        Set psCategory to C_$CategoryWindow
75591>>>>>    End_Procedure
75592>>>>>    
75592>>>>>    Procedure OnExecute Variant vCommandBarControl
75594>>>>>        Handle hoCommandBars hoClientArea
75594>>>>>        Get CommandBarSystemObject to hoCommandBars
75595>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75596>>>>>        If hoClientArea Begin
75598>>>>>            Send Cascade_Windows of hoClientArea
75599>>>>>        End
75599>>>>>>
75599>>>>>    End_Procedure
75600>>>>>End_Class
75601>>>>>
75601>>>>>Class cCJTileHorizontally is a cCJMenuItem
75602>>>>>
75602>>>>>    Procedure Construct_Object
75604>>>>>        Forward Send Construct_Object
75606>>>>>        Set psCaption to C_$CaptionTileHorizontally 
75607>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
75608>>>>>        Set psDescription to  C_$DescTileHorizontally
75609>>>>>        Set psImage to "ActionTileHorizontally.ico"
75610>>>>>        Set psCategory to C_$CategoryWindow
75611>>>>>    End_Procedure
75612>>>>>
75612>>>>>    Procedure OnExecute Variant vCommandBarControl
75614>>>>>        Handle hoCommandBars hoClientArea
75614>>>>>        Get CommandBarSystemObject to hoCommandBars
75615>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75616>>>>>        If hoClientArea Begin
75618>>>>>            Send Tile_Windows_Horizontal of hoClientArea
75619>>>>>        End
75619>>>>>>
75619>>>>>    End_Procedure
75620>>>>>End_Class
75621>>>>>
75621>>>>>Class cCJTileVertically is a cCJMenuItem
75622>>>>>
75622>>>>>    Procedure Construct_Object
75624>>>>>        Forward Send Construct_Object
75626>>>>>        Set psCaption to C_$CaptionTileVertically  
75627>>>>>        Set psToolTip to C_$ToolTipTileVertically
75628>>>>>        Set psDescription to  C_$DescTileVertically
75629>>>>>        Set psImage to "ActionTileVertically.ico"
75630>>>>>        Set psCategory to C_$CategoryWindow
75631>>>>>    End_Procedure
75632>>>>>
75632>>>>>    Procedure OnExecute Variant vCommandBarControl
75634>>>>>        Handle hoCommandBars hoClientArea
75634>>>>>        Get CommandBarSystemObject to hoCommandBars
75635>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75636>>>>>        If hoClientArea Begin
75638>>>>>            Send Tile_Windows_Vertical of hoClientArea
75639>>>>>        End
75639>>>>>>
75639>>>>>    End_Procedure
75640>>>>>End_Class
75641>>>>>
75641>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
75642>>>>>
75642>>>>>    Procedure Construct_Object
75644>>>>>        Forward Send Construct_Object
75646>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
75647>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
75648>>>>>        Set psDescription to  C_$DescMinimizeWindows
75649>>>>>        Set psCategory to C_$CategoryWindow
75650>>>>>    End_Procedure
75651>>>>>
75651>>>>>    Procedure OnExecute Variant vCommandBarControl
75653>>>>>        Handle hoCommandBars hoClientArea
75653>>>>>        Get CommandBarSystemObject to hoCommandBars
75654>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75655>>>>>        If hoClientArea Begin
75657>>>>>            // the clientarea's parent panel has message
75657>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
75658>>>>>        End
75658>>>>>>
75658>>>>>    End_Procedure
75659>>>>>End_Class
75660>>>>>
75660>>>>>
75660>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
75661>>>>>
75661>>>>>    Procedure Construct_Object
75663>>>>>        Forward Send Construct_Object
75665>>>>>        Set psCaption to C_$CaptionRestoreWindows
75666>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
75667>>>>>        Set psDescription to  C_$DescRestoreWindows
75668>>>>>        Set psCategory to C_$CategoryWindow
75669>>>>>    End_Procedure
75670>>>>>
75670>>>>>    Procedure OnExecute Variant vCommandBarControl
75672>>>>>        Handle hoCommandBars hoClientArea
75672>>>>>        Get CommandBarSystemObject to hoCommandBars
75673>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75674>>>>>        If hoClientArea Begin
75676>>>>>            // the clientarea's parent panel has message
75676>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
75677>>>>>        End
75677>>>>>>
75677>>>>>    End_Procedure
75678>>>>>End_Class
75679>>>>>
75679>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
75680>>>>>
75680>>>>>    Procedure Construct_Object
75682>>>>>        Forward Send Construct_Object
75684>>>>>        Set psCaption to C_$CaptionArrangeIcons  
75685>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
75686>>>>>        Set psDescription to  C_$DescArrangeIcons
75687>>>>>        Set psCategory to C_$CategoryWindow
75688>>>>>    End_Procedure
75689>>>>>
75689>>>>>    Procedure OnExecute Variant vCommandBarControl
75691>>>>>        Handle hoCommandBars hoClientArea
75691>>>>>        Get CommandBarSystemObject to hoCommandBars
75692>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75693>>>>>        If hoClientArea Begin
75695>>>>>            Send Arrange_Icons of hoClientArea
75696>>>>>        End
75696>>>>>>
75696>>>>>    End_Procedure
75697>>>>>
75697>>>>>End_Class
75698>>>>>    
75698>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJAboutMenuItem.pkg)
75698>>>>>Use cCJCommandBarSystem.pkg
75698>>>>>Use LanguageText.pkg
75698>>>>>
75698>>>>>// It is expected that if you use this class that you provide an about object that is
75698>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
75698>>>>>// because you may wish to create your own custom about package.
75698>>>>>
75698>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
75699>>>>>
75699>>>>>    Procedure Construct_Object
75701>>>>>        Forward Send Construct_Object
75703>>>>>        Set psCaption to C_$CaptionAbout
75704>>>>>        Set psDescription to C_$ToolTipAbout
75705>>>>>        Set psToolTip to C_$DescAbout
75706>>>>>        Set psImage to "ActionAbout.ico"
75707>>>>>        Set psCategory to C_$CategoryHelp
75708>>>>>    End_Procedure
75709>>>>>    
75709>>>>>    Procedure OnExecute Variant vCommandBarControl
75711>>>>>        Handle hoCommandBars hoClientArea
75711>>>>>        Get CommandBarSystemObject to hoCommandBars
75712>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75713>>>>>        If hoClientArea Begin
75715>>>>>            Send Activate_About of hoClientArea
75716>>>>>        End
75716>>>>>>
75716>>>>>    End_Procedure
75717>>>>>
75717>>>>>End_Class
75718>>>>>
75718>>>>>
75718>>>Use cCJDeoMenuItemClasses.pkg
75718>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJMDIWindowsMenuItem.pkg)
75718>>>>>Use cCJCommandBarSystem.pkg
75718>>>>>
75718>>>>>Register_Function Client_ID Returns Integer
75718>>>>>
75718>>>>>// only used by cCJMDIWIndowsMenuItem
75718>>>>>Class cCJMDIWindowItem is a cCJMenuItem
75719>>>>>
75719>>>>>    Procedure Construct_Object
75721>>>>>        Forward Send Construct_Object
75723>>>>>        Property Handle phWindow 0 // object id of view
75724>>>>>        Set pbControlFlagNoMovable to True
75725>>>>>        Set pbActiveUpdate to True
75726>>>>>    End_Procedure
75727>>>>>    
75727>>>>>    Procedure OnExecute Variant vCommandBarControl
75729>>>>>        Handle hWindow
75729>>>>>        Get phWindow to hWindow
75730>>>>>        Send Activate_View of hWindow
75731>>>>>    End_Procedure
75732>>>>>    
75732>>>>>End_Class                
75733>>>>>
75733>>>>>
75733>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
75734>>>>>    
75734>>>>>    Procedure Construct_Object
75736>>>>>        Forward Send Construct_Object
75738>>>>>        Property Handle[] phArrayOfWindows
75739>>>>>        Set peControlType to xtpControlPopup
75740>>>>>        Set psCategory to C_$CategoryWindow
75741>>>>>    End_Procedure
75742>>>>>    
75742>>>>>     // This adds MDI windows to the existing menu items.
75742>>>>>     // This removes any existing windows menus and always adds a new set to the end
75742>>>>>
75742>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
75744>>>>>        Handle  hClientArea hView
75744>>>>>        String  sLabel
75744>>>>>        Integer i iWindows
75744>>>>>        Handle[] hArrayOfWindows
75745>>>>>        Variant vItem
75745>>>>>        
75745>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
75745>>>>>        // also assume that destroying an action removes all menu instances of that action
75745>>>>>        Get phArrayOfWindows to hArrayOfWindows
75746>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
75747>>>>>        For i from 0 to (iWindows-1)
75753>>>>>>
75753>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
75754>>>>>        Loop
75755>>>>>>
75755>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
75756>>>>>
75756>>>>>        // Add all views to this menu. Create the action and add the item
75756>>>>>        Move 0 to i
75757>>>>>        Get Client_Id to hClientArea // object id of client area
75758>>>>>        If (hClientArea > 0) Begin
75760>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
75761>>>>>            While (hView <> 0)
75765>>>>>                If (Active_State(hView)) Begin
75767>>>>>                    // create the action
75767>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
75768>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
75769>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
75770>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
75771>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
75773>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
75774>>>>>                    End
75774>>>>>>
75774>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
75775>>>>>                    If (i=0) Begin
75777>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
75778>>>>>                    End
75778>>>>>>
75778>>>>>                    // Create a menu item for this action
75778>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
75779>>>>>                    Increment i
75780>>>>>                End
75780>>>>>>
75780>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
75781>>>>>            Loop
75782>>>>>>
75782>>>>>        End
75782>>>>>>
75782>>>>>
75782>>>>>        Set phArrayOfWindows to hArrayOfWindows
75783>>>>>
75783>>>>>     End_Procedure
75784>>>>>     
75784>>>>>End_Class
75785>>>>>
75785>
75785>Object oHtmlHelp is a cHtmlHelp
75787>End_Object
75788>
75788>Object oApplication is a cApplication
75790>    Set peHelpType to htHtmlHelp
75791>End_Object
75792>
75792>Object oToolTipController is a cToolTipController
75794>    Move Self to ghoToolTipController
75795>End_Object
75796>
75796>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oEditContextMenu.pkg)
75796>>>Use cCJStandardMenuItemClasses.pkg
75796>>>
75796>>>Object oEditContextMenu is a cCJContextMenu
75798>>>    
75798>>>    Move Self to Default_Form_Floating_Menu_ID
75799>>>    
75799>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75801>>>    End_Object
75802>>>    
75802>>>    Object oCutMenuItem is a cCJCutMenuItem
75804>>>        Set pbControlBeginGroup to True
75805>>>    End_Object
75806>>>    
75806>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75808>>>    End_Object
75809>>>
75809>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75811>>>    End_Object
75812>>>
75812>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75814>>>    End_Object
75815>>>
75815>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75817>>>        Set pbControlBeginGroup to True
75818>>>    End_Object
75819>>>
75819>>>End_Object
75820>>>
75820>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oDEOEditContextMenu17.pkg)
75820>>>Use Windows.pkg
75820>>>Use cCJStandardMenuItemClasses.pkg
75820>>>Use cCJDeoMenuItemClasses.pkg
75820>>>
75820>>>
75820>>>Object oDEOEditContextMenu17 is a cCJContextMenu
75822>>>    
75822>>>    Move Self to Default_dbFloating_Menu_ID
75823>>>    
75823>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75825>>>    End_Object
75826>>>    
75826>>>    Object oCutMenuItem is a cCJCutMenuItem
75828>>>        Set pbControlBeginGroup to True
75829>>>    End_Object
75830>>>    
75830>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75832>>>    End_Object
75833>>>
75833>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75835>>>    End_Object
75836>>>
75836>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75838>>>    End_Object
75839>>>
75839>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75841>>>        Set pbControlBeginGroup to True
75842>>>    End_Object
75843>>>
75843>>>    Object oPromptMenuItem is a cCJPromptMenuItem
75845>>>        Set pbControlBeginGroup to True
75846>>>    End_Object
75847>>>
75847>>>    Object oFindNextMenu is a cCJFindNextMenuItem
75849>>>        Set pbControlBeginGroup to True
75850>>>    End_Object
75851>>>
75851>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75853>>>    End_Object
75854>>>
75854>>>    Object oClearMenuItem is a cCJClearMenuItem
75856>>>        Set pbControlBeginGroup to True
75857>>>    End_Object
75858>>>
75858>>>    Object oClearAllMenu is a cCJClearAllMenuItem
75860>>>    End_Object
75861>>>
75861>>>    Object oSaveMenu is a cCJSaveMenuItem
75863>>>    End_Object
75864>>>    
75864>>>    Object oDeleteMenu is a cCJDeleteMenuItem
75866>>>    End_Object
75867>>>
75867>>>    Object oRememberitem is a cCJRememberFieldMenuItem
75869>>>        Set pbControlBeginGroup to True
75870>>>    End_Object
75871>>>
75871>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
75873>>>    End_Object
75874>>>
75874>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
75876>>>    End_Object
75877>>>
75877>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
75879>>>    End_Object
75880>>>
75880>>>End_Object
75881>
75881>Object oMain is a Panel
75883>    Set Label to "Mi Proyecto"
75884>    Set Location to 4 3
75885>    Set Size to 300 589
75886>
75886>    Object oCommandBarSystem is a cCJCommandBarSystem
75888>        Set pbTimerUpdate to True
75889>
75889>        Procedure OnCreateCommandBars
75892>            Handle hoOptions
75892>            Get OptionsObject to hoOptions
75893>            Forward Send OnCreateCommandBars
75895>        End_Procedure
75896>
75896>        Object oMenuBar is a cCJMenuBar
75898>
75898>            Object oFileMenu is a cCJMenuItem
75900>                Set peControlType to xtpControlPopup          
75901>                Set psCaption   to "Archivo"    // &F   <--------------------------
75902>                Set psDescription to "Buscar, Grabar, Borrar, limpiar informaci¢n o salir de esta aplicaci¢n."
75903>                Set psCategory to "Men£s"
75904>
75904>                Object oClearMenuItem is a cCJClearMenuItem
75906>                    Set pbAddToDesignerMenu to True
75907>                End_Object
75908>
75908>                Object oClearAllMenu is a cCJClearAllMenuItem
75910>                    Set pbAddToDesignerMenu to True
75911>                End_Object
75912>
75912>                Object oPromptMenuItem is a cCJPromptMenuItem
75914>                    Set pbAddToDesignerMenu to True
75915>                    Set pbControlBeginGroup to True
75916>                End_Object
75917>
75917>                Object oFindMenuItem is a cCJFindMenuItem
75919>                    Set pbAddToDesignerMenu to True
75920>                    Set pbControlBeginGroup to True
75921>                End_Object
75922>
75922>                Object oFindNextMenu is a cCJFindNextMenuItem
75924>                    Set pbAddToDesignerMenu to True
75925>                End_Object
75926>
75926>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75928>                    Set pbAddToDesignerMenu to True
75929>                End_Object
75930>
75930>                Object oFindFirstMenu is a cCJFindFirstMenuItem
75932>                    Set pbAddToDesignerMenu to True
75933>                End_Object
75934>
75934>                Object oFindLastMenu is a cCJFindLastMenuItem
75936>                    Set pbAddToDesignerMenu to True
75937>                End_Object
75938>
75938>                Object oSaveMenuItem is a cCJSaveMenuItem
75940>                    Set pbAddToDesignerMenu to True
75941>                    Set pbControlBeginGroup to True
75942>                End_Object
75943>
75943>                Object oDeleteMenuItem is a cCJDeleteMenuItem
75945>                    Set pbAddToDesignerMenu to True
75946>                End_Object
75947>
75947>                Object oExitMenu is a cCJExitMenuItem
75949>                    Set pbControlBeginGroup to True
75950>                End_Object
75951>
75951>            End_Object
75952>
75952>            Object oViewMenu is a cCJMenuItem
75954>                Set peControlType to xtpControlPopup
75955>                Set psCaption to "&Vistas"
75956>                Set psToolTip to "Vistas"
75957>               Set psDescription to "Vistas disponibles"
75958>
75958>               Object oEMPLEADOSMenuItem is a cCJMenuItem
75960>                   Set psCaption to "EMPLEADOS"
75961>                   Set psTooltip to "EMPLEADOS"
75962>               
75962>                   Procedure OnExecute Variant vCommandBarControl
75965>                       Handle hoClient
75965>                       Get Client_Id to hoClient
75966>                       Send Activate_EMPLEADOS of hoClient
75967>                   End_Procedure
75968>               End_Object
75969>
75969>               Object oMARCAJESMenuItem is a cCJMenuItem
75971>                   Set psCaption to "MARCAJES"
75972>                   Set psTooltip to "MARCAJES"
75973>               
75973>                   Procedure OnExecute Variant vCommandBarControl
75976>                       Handle hoClient
75976>                       Get Client_Id to hoClient
75977>                       Send Activate_MARCAJES of hoClient
75978>                   End_Procedure
75979>               End_Object
75980>            End_Object
75981>            
75981>            Object oReportMenu is a cCJMenuItem
75983>                Set peControlType to xtpControlPopup
75984>                Set psCaption to "&Informes"
75985>                Set psToolTip to "Informes"
75986>                Set psDescription to "Informes disponibles"
75987>
75987>                Object oRMarcajeMenuItem is a cCJMenuItem
75989>                    Set psCaption to "Repore de Marcaje"
75990>                    Set psTooltip to "Repore de Marcaje"
75991>                
75991>                    Procedure OnExecute Variant vCommandBarControl
75994>                        Handle hoClient
75994>                        Get Client_Id to hoClient
75995>                        Send Activate_MarcajesEmpleado of hoClient
75996>                    End_Procedure
75997>                End_Object
75998>            End_Object
75999>
75999>            Object oNavigateMenu is a cCJMenuItem
76001>                Set peControlType to xtpControlPopup      
76002>                Set psCaption to "&Navegar"    
76003>                Set psTooltip to "Navegar"    
76004>                Set psDescription to "Desplazarse a diferentes areas de la aplicaci¢n"
76005>
76005>                Object oNextAreaMenu is a cCJNextAreaMenu
76007>                End_Object
76008>
76008>                Object oPriorAreaMenu is a cCJPriorAreaMenu
76010>                End_Object
76011>
76011>                Object oNextViewMenu is a cCJNextViewMenu
76013>                End_Object
76014>
76014>                Object oPriorViewMenu is a cCJPriorViewMenu
76016>                End_Object
76017>
76017>                Object oPromptMenu is a cCJPromptMenuItem
76019>                    Set pbControlBeginGroup to True
76020>                End_Object
76021>
76021>                Object oZoomMenu is a cCJZoomMenuItem
76023>                End_Object
76024>
76024>            End_Object
76025>
76025>            Object oWindowMenu is a cCJMDIWindowsMenuItem
76027>                Set peControlType to xtpControlPopup
76028>                Set psCaption to "Ventana"      // &W <---------------
76029>                Set psToolTip to "Ventana"
76030>                Set psDescription to "Muestre vistas actuales y fije otras opciones de visualizaci¢n."
76031>
76031>                // These are the static windows items. More will be created in onInitPopup 
76031>                Object oDisplayOptionsMenu is a cCJMenuItem
76033>                    Set peControlType to xtpControlPopup          
76034>                    Set psCaption to "Opciones de visualizaci¢n"  // &D <--------------
76035>                    Set psToolTip to "Opciones de visualizaci¢n"
76036>                    Set psDescription to "Fije opciones de visualizaci¢n"
76037>
76037>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
76039>                    End_Object
76040>
76040>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
76042>                    End_Object
76043>
76043>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
76045>                        Set pbControlBeginGroup to True
76046>                    End_Object
76047>
76047>                End_Object
76048>
76048>                Object oCascadeMenu is a cCJCascadeMenuItem
76050>                    Set pbControlBeginGroup to True
76051>                End_Object
76052>
76052>                Object oHorizTile is a cCJTileHorizontally
76054>                End_Object
76055>
76055>                Object oVertTile is a cCJTileVertically
76057>                End_Object
76058>
76058>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
76060>                    Set pbControlBeginGroup to True
76061>                End_Object
76062>
76062>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
76064>                End_Object
76065>
76065>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
76067>                    Set pbControlBeginGroup to True
76068>                End_Object
76069>
76069>            End_Object
76070>
76070>            Object oHelpMenu is a cCJMenuItem
76072>                Set peControlType to xtpControlPopup    
76073>                Set psCaption to "&Ayuda"   // &H    <----------------------
76074>                Set psDescription to "Informaci¢n para aprender y para usar esta aplicaci¢n VDF"
76075>                Set psToolTip to "Ayuda"
76076>
76076>                Object oHelpMenuItem is a cCJHelpMenuItem 
76078>                End_Object
76079>
76079>                Object oAboutMenuItem is a cCJAboutMenuItem
76081>                End_Object
76082>
76082>            End_Object
76083>
76083>        End_Object
76084>
76084>        Object oFindToolBar is a cCJToolbar
76086>            Set psTitle to "Barra de herramientas de b£squeda"
76087>
76087>            Object oFindFirstTool is a cCJFindFirstMenuItem
76089>            End_Object
76090>
76090>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
76092>            End_Object
76093>
76093>            Object oFindMenuTool is a cCJFindMenuItem
76095>            End_Object
76096>
76096>            Object oFindNextTool is a cCJFindNextMenuItem
76098>            End_Object
76099>
76099>            Object oFindLastTool is a cCJFindLastMenuItem
76101>            End_Object
76102>
76102>            Object oPromptToolItem is a cCJPromptMenuItem
76104>                Set pbControlBeginGroup to True
76105>            End_Object
76106>
76106>        End_Object
76107>
76107>        Object oFileToolBar is a cCJToolbar
76109>            Set psTitle to "Barra de herramientas de introducci¢n de datos"
76110>
76110>            Object oClearToolItem is a cCJClearMenuItem
76112>                Set peControlStyle to xtpButtonIconAndCaption
76113>            End_Object
76114>
76114>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
76116>                Set peControlStyle to xtpButtonIconAndCaption
76117>            End_Object
76118>
76118>            Object oSaveToolItem is a cCJSaveMenuItem
76120>                Set peControlStyle to xtpButtonIconAndCaption
76121>                Set pbControlBeginGroup to True
76122>            End_Object
76123>
76123>            Object oDeleteToolItem is a cCJDeleteMenuItem
76125>                Set peControlStyle to xtpButtonIconAndCaption
76126>            End_Object
76127>
76127>        End_Object
76128>
76128>        Object oEditToolBar is a cCJToolbar
76130>            Set psTitle to "Barra de herramientas de edici¢n"
76131>
76131>            Object oCutToolbarItem is a cCJCutMenuItem
76133>            End_Object
76134>
76134>            Object oCopyToolbarItem is a cCJCopyMenuItem
76136>            End_Object
76137>
76137>            Object oPasteToolbarItem is a cCJPasteMenuItem
76139>            End_Object
76140>
76140>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
76142>                Set pbControlBeginGroup to True
76143>            End_Object
76144>
76144>        End_Object
76145>
76145>        Object oRememberToolbar is a cCJToolbar
76147>            Set psTitle to C_$Remember
76148>
76148>            Object oRememberItems is a cCJMenuItem
76150>
76150>                Set peControlType to xtpControlPopup
76151>                Set peControlStyle to xtpButtonCaption
76152>                Set psCaption to C_$Remember
76153>                
76153>                Object oMenuItem is a cCJRememberFieldMenuItem
76155>                    Set peControlStyle to xtpButtonIconAndCaption
76156>                End_Object
76157>                
76157>                Object oMenuItem is a cCJRememberLastFieldMenuItem
76159>                    Set peControlStyle to xtpButtonIconAndCaption
76160>                End_Object
76161>                
76161>                Object oMenuItem is a cCJUnRememberFieldMenuItem
76163>                    Set peControlStyle to xtpButtonIconAndCaption
76164>                End_Object
76165>                
76165>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
76167>                    Set peControlStyle to xtpButtonIconAndCaption
76168>                End_Object
76169>
76169>            End_Object
76170>            
76170>        End_Object
76171>        
76171>        Object oStatusBar is a cCJStatusBar
76173>
76173>            Object oStatusPane1 is a cCJStatusBarPane
76175>                Set piID to sbpIDIdlePane
76176>                Set pbStyleStretch to True
76177>            End_Object
76178>
76178>            Object oStatusPane2 is a cCJStatusBarPane
76180>                Set phoViewPane to Self
76181>                Set pbStyleStretch to True
76182>            End_Object
76183>
76183>        End_Object
76184>
76184>    End_Object
76185>
76185>    Object oClientArea is a ClientArea
76187>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\StdAbout.pkg)
76187>>>//************************************************************************
76187>>>// Confidential Trade Secret.
76187>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76187>>>// as an unpublished work.  All rights reserved.
76187>>>// DataFlex is a registered trademark of Data Access Corporation.
76187>>>//
76187>>>//************************************************************************
76187>>>//************************************************************************
76187>>>//
76187>>>// $File name  : StdAbout.pkg
76187>>>// $File title : Standard about object package for VDF
76187>>>// Notice      :
76187>>>// $Author(s)  : John Tuohy
76187>>>//
76187>>>// $Rev History
76187>>>//
76187>>>// JT 06/27/97   File created
76187>>>//************************************************************************
76187>>>
76187>>>// This provides a quick and simple way to create an about package for a program.
76187>>>// You need to create a message inside you client area called Activate_About.
76187>>>// Within this message you should send the message DoAbout passing needed
76187>>>// string information.
76187>>>//
76187>>>//       Procedure Activate_About
76187>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
76187>>>//       End_Procedure
76187>>>//    where: sTitle =     Name of application. If none provided, uses caption
76187>>>//                        bar title
76187>>>//           sVersion   = Version Line. If none provided, will be blank
76187>>>//           sCopyRight = Copyright Line. If none provided, will be blank
76187>>>//           sAuthor    = Author name, blank if none provided
76187>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
76187>>>//                        is used.
76187>>>// It is expected that you will place this in your own object package. For
76187>>>// example an order about package may look like this:
76187>>>//
76187>>>//   // OrderAbout.pkg
76187>>>//   Use StdAbout.pkg
76187>>>//   Procedure Activate_About
76187>>>//      String sTitle sCopyright sVersion sAuthor
76187>>>//      Move "My Order Entry System" to sTitle
76187>>>//      Move "Version 2.1" to sVersion
76187>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
76187>>>//      Move "John Smith"  to sAuthor
76187>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
76187>>>//   end_procedure
76187>>>//   // end of file.
76187>>>
76187>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\Dfabout.pkg)
76187>>>>>//************************************************************************
76187>>>>>// Confidential Trade Secret.
76187>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76187>>>>>// as an unpublished work.  All rights reserved.
76187>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
76187>>>>>//
76187>>>>>//************************************************************************
76187>>>>>//************************************************************************
76187>>>>>//
76187>>>>>// $File name  : DfAbout.pkg
76187>>>>>// $File title : About class support
76187>>>>>// Notice      :
76187>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
76187>>>>>//
76187>>>>>// $Rev History
76187>>>>>//
76187>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
76187>>>>>//                Windows for the size first. 
76187>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
76187>>>>>//                with anchor technique. Removed unnessary property in the
76187>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
76187>>>>>//                object To better look in Windows XP. Repositioned the close
76187>>>>>//                button in the sysinfo dialog To line up with the display area
76187>>>>>//                Replaced obsolete code and techniques. Removed dead code.
76187>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
76187>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
76187>>>>>//                the global Workspace object, if it is present
76187>>>>>// JJT 11/05/98   Added version information
76187>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
76187>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
76187>>>>>//                workspace package.
76187>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
76187>>>>>//                class can create this object.
76187>>>>>//                Cleaned up the interface (used correct classes and messages)
76187>>>>>//                Added workspace reporting support To sys-info.
76187>>>>>//                Turned off wrapping in the sys-info editor.
76187>>>>>// KR  ??/??/96   File created
76187>>>>>//************************************************************************
76187>>>>>Use LanguageText.pkg
76187>>>>>Use Windows.pkg
76187>>>>>Use DFbitmap.pkg
76187>>>>>Use GlobalFunctionsProcedures.pkg
76187>>>>>Use cTextEdit.pkg
76187>>>>>
76187>>>>>Use cli.pkg
Including file: cli.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cli.pkg)
76187>>>>>>>//*****************************************************************************
76187>>>>>>>//*** CLI.PKG                                                               ***
76187>>>>>>>//***                                                                       ***
76187>>>>>>>//*** Author: Ben Weijers                                                   ***
76187>>>>>>>//***         Data Access Nederland                                         ***
76187>>>>>>>//***         10 September 1998                                             ***
76187>>>>>>>//***                                                                       ***
76187>>>>>>>//*** Purpose:                                                              ***
76187>>>>>>>//***   CLI specific functionality. There are several connectivity kits     ***
76187>>>>>>>//***   based on  SQL/92 CLI. Those are:                                    ***
76187>>>>>>>//***    - ODBC_DRV  The Data Access CK for ODBC                            ***
76187>>>>>>>//***    - DB2_DRV   The Data Access CK for DB2                             ***
76187>>>>>>>//***    - MSSQLDRV  The Data Access CK for Microsoft SQL Server            ***
76187>>>>>>>//***                                                                       ***
76187>>>>>>>//***   This package defines the common functionality for all CLI based     ***
76187>>>>>>>//***   drivers.                                                            ***
76187>>>>>>>//***                                                                       ***
76187>>>>>>>//***   Updated:  May 23rd 2008 (Current CK build: 5.0.0.53 )               ***
76187>>>>>>>//***             Added NULLABLE and DEFAULT attributes for DATETIME type   ***
76187>>>>>>>//***   Updated:  Apr  6th 2009 (Current CK build: 5.0.0.61 )               ***
76187>>>>>>>//***             Added DF_DRIVER_MATCH_CLIENT_SERVER_VERSION attribute     ***
76187>>>>>>>//***                   DF_DRIVER_SQLSERVER_CLIENT_VERSION    attribute     ***
76187>>>>>>>//***   Updated:  Mar 30th 2012 (Current CK build: 5.1.0.93 )               ***
76187>>>>>>>//***             Added SQLSERVER2012CLIENT return value for                ***
76187>>>>>>>//***             DF_DRIVER_SQLSERVER_CLIENT_VERSION attribute              ***
76187>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
76187>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
76187>>>>>>>//***             mssqldrv.pkg                                              ***
76187>>>>>>>//***   Updated:  april 23, 2013 (Current CK build: 6.0.0.4)                ***
76187>>>>>>>//***             Added type mappings attributes                            ***
76187>>>>>>>//***   Updated:  october 11, 2013 (Current CK build: 6.0.0.18)             ***
76187>>>>>>>//***             Added DF_FILE_SQL_FILTER_EQ attribute                     ***
76187>>>>>>>//*****************************************************************************
76187>>>>>>>
76187>>>>>>>//*** We are not using ifndef below because that is not supported in Character Mode
76187>>>>>>>//*** Driver attributes
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>//------------------------------------------------------------
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>//-------------------------------------
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>//*** Replacement for logical column number that indicates all columns
76187>>>>>>>
76187>>>>>>>//*** Possible DF_FILE_GENERATE_RECORD_ID_METHOD values
76187>>>>>>>
76187>>>>>>>//*** Possible DF_FIELD_READ_ONLY values
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>//*** Possible DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA values
76187>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK5        1       
76187>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK6        2   
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>// Moved to Mssqldrv.pkg
76187>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
76187>>>>>>>//#REPLACE SQLSERVERUNKNOWNCLIENT  0
76187>>>>>>>//#REPLACE SQLSERVER2000CLIENT     8          //   "SQL Server"
76187>>>>>>>//#REPLACE SQLSERVER2005CLIENT     9          //   "SQL Native Client"
76187>>>>>>>//#REPLACE SQLSERVER2008CLIENT    10          //   "SQL Server Native Client 10.0"
76187>>>>>>>//#Replace SQLSERVER2012CLIENT    11          //   "SQL Server Native Client 11.0"
76187>>>>>>>
76187>>>>>>>//*** Possible SQL Column type values
76187>>>>>>>Define SQL_UNKNOWN_TYPE   For    0
76187>>>>>>>Define SQL_CHAR           For    1
76187>>>>>>>Define SQL_NUMERIC        For    2
76187>>>>>>>Define SQL_DECIMAL        For    3
76187>>>>>>>Define SQL_INTEGER        For    4
76187>>>>>>>Define SQL_SMALLINT       For    5
76187>>>>>>>Define SQL_FLOAT          For    6
76187>>>>>>>Define SQL_REAL           For    7
76187>>>>>>>Define SQL_DOUBLE         For    8
76187>>>>>>>Define SQL_DATETIME       For    9
76187>>>>>>>Define SQL_VARCHAR        For   12
76187>>>>>>>Define SQL_TYPE_DATE      For   91
76187>>>>>>>Define SQL_TYPE_TIME      For   92
76187>>>>>>>Define SQL_TYPE_TIMESTAMP for   93
76187>>>>>>>// Moved to mssqldrv.pkg
76187>>>>>>>//Define SQL_TYPE_TIMESTAMP2 for   (-200) //SQL server datetime2 type */
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>Define SQL_DATE           For    9
76187>>>>>>>Define SQL_INTERVAL       For   10
76187>>>>>>>Define SQL_TIME           For   10
76187>>>>>>>Define SQL_TIMESTAMP      For   11
76187>>>>>>>Define SQL_LONGVARCHAR    For  (-1)
76187>>>>>>>Define SQL_BINARY         For  (-2)
76187>>>>>>>Define SQL_VARBINARY      For  (-3)
76187>>>>>>>Define SQL_LONGVARBINARY  For  (-4)
76187>>>>>>>Define SQL_BIGINT         For  (-5)
76187>>>>>>>Define SQL_TINYINT        For  (-6)
76187>>>>>>>Define SQL_BIT            For  (-7)
76187>>>>>>>Define SQL_WCHAR          For  (-8)
76187>>>>>>>Define SQL_WVARCHAR       For  (-9)
76187>>>>>>>Define SQL_WLONGVARCHAR   For (-10)
76187>>>>>>>Define SQL_GUID           For (-11)
76187>>>>>>>
76187>>>>>>>//*** Driver level attributes
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>//*** Error number constants
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>//*** Call driver function identifiers
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>//*** Init data source types
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>//*** Dummy strings used in the commands
76187>>>>>>>    String  CLI$StrDummy 255
76187>>>>>>>    Integer CLI$IntDummy
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>//*****************************************************************************
76187>>>>>>>//*** CLI_SetConstraint <FileNum> <NewState>                                ***
76187>>>>>>>//***                                                                       ***
76187>>>>>>>//***   Setup a constraint for a file.                                      ***
76187>>>>>>>//*****************************************************************************
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>//*****************************************************************************
76187>>>>>>>//*** CLI_Set_Driver_Atrtribute / CLI_Get_Driver_Attribute                  ***
76187>>>>>>>//***                                                                       ***
76187>>>>>>>//*** Set or get an attribute at driver level. These attributes, when set,  ***
76187>>>>>>>//*** will be set for the remainder of the session or until set again. To   ***
76187>>>>>>>//*** permanently set driver level attributes change the driver             ***
76187>>>>>>>//*** configuration file.                                                   ***
76187>>>>>>>//*****************************************************************************
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>
76187>>>>>>>//*****************************************************************************
76187>>>>>>>//*** Class  : cCLIHandler                                                  ***
76187>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76187>>>>>>>//***          call several CLI releated methods.                           ***
76187>>>>>>>//*****************************************************************************
76187>>>>>>>
76187>>>>>>>Class cCLIHandler Is An Array
76188>>>>>>>
76188>>>>>>>    Procedure Construct_Object Integer iImage
76190>>>>>>>        Forward Send Construct_object iImage
76192>>>>>>>
76192>>>>>>>        Property String  psDriverID       Public ""
76193>>>>>>>    End_Procedure // Construct_Object
76194>>>>>>>
76194>>>>>>>
76194>>>>>>>
76194>>>>>>>    //***
76194>>>>>>>    //*** Fucntion: CKRevsion
76194>>>>>>>    //*** Purpose : The revsion of a CLI Connectivity Kit
76194>>>>>>>    //***
76194>>>>>>>
76194>>>>>>>    Function CKRevision Returns String
76196>>>>>>>        Local String  sDriverID
76196>>>>>>>        Local String  sRevision
76196>>>>>>>        Local String  sVoid
76196>>>>>>>        Local Integer iRetval
76196>>>>>>>
76196>>>>>>>        Get psDriverID To sDriverID
76197>>>>>>>        If (sDRiverID <> "") Begin
76199>>>>>>>            Move (Repeat(" ", 255)) To sRevision
76200>>>>>>>            Call_Driver 0 sDRiverID Function CLI_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76205>>>>>>>        End
76205>>>>>>>>
76205>>>>>>>
76205>>>>>>>        Function_Return sRevision
76206>>>>>>>    End_Function // CKRevision
76207>>>>>>>
76207>>>>>>>
76207>>>>>>>
76207>>>>>>>    //***
76207>>>>>>>    //*** Function: ExtractPartFromRevision
76207>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76207>>>>>>>    //***
76207>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76207>>>>>>>    //***
76207>>>>>>>
76207>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76209>>>>>>>        Local Integer iPartRev
76209>>>>>>>        Local Integer iCurrentPart
76209>>>>>>>        Local Integer iSeparatorPos
76209>>>>>>>
76209>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76212>>>>>>>
76212>>>>>>>        Move 0 To iCurrentPart
76213>>>>>>>        Repeat
76213>>>>>>>>
76213>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76214>>>>>>>            If (iSeparatorPos > 0) Begin
76216>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76217>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76218>>>>>>>                Increment iCurrentPart
76219>>>>>>>            End
76219>>>>>>>>
76219>>>>>>>            Else If (sRevision <> "") Begin
76222>>>>>>>                Move sRevision To iPartRev
76223>>>>>>>                Move "" To sRevision
76224>>>>>>>                Increment iCurrentPart
76225>>>>>>>            End
76225>>>>>>>>
76225>>>>>>>            Else ;                Move -1 To iPartRev
76227>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76229>>>>>>>
76229>>>>>>>        Function_Return iPartRev
76230>>>>>>>    End_Function // EcxtractPartFromRevision
76231>>>>>>>
76231>>>>>>>
76231>>>>>>>
76231>>>>>>>    //***
76231>>>>>>>    //*** Function: CKMajorRevision
76231>>>>>>>    //*** Purpose : Returns the major revision of the CK
76231>>>>>>>    //***
76231>>>>>>>
76231>>>>>>>    Function CKMajorRevision Returns Integer
76233>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76234>>>>>>>    End_Function // CKMajorRevision
76235>>>>>>>
76235>>>>>>>
76235>>>>>>>
76235>>>>>>>    //***
76235>>>>>>>    //*** Function: CKMinorRevision
76235>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76235>>>>>>>    //***
76235>>>>>>>
76235>>>>>>>    Function CKMinorRevision Returns Integer
76237>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76238>>>>>>>    End_Function // CKMinorRevision
76239>>>>>>>
76239>>>>>>>
76239>>>>>>>
76239>>>>>>>    //***
76239>>>>>>>    //*** Function: CKReleaseRevision
76239>>>>>>>    //*** Purpose : Returns the release revision of the CK
76239>>>>>>>    //***
76239>>>>>>>
76239>>>>>>>    Function CKReleaseRevision Returns Integer
76241>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76242>>>>>>>    End_Function // CKReleaseRevision
76243>>>>>>>
76243>>>>>>>
76243>>>>>>>
76243>>>>>>>    //***
76243>>>>>>>    //*** Function: CKBuildRevision
76243>>>>>>>    //*** Purpose : Returns the major revision of the CK
76243>>>>>>>    //***
76243>>>>>>>
76243>>>>>>>    Function CKBuildRevision Returns Integer
76245>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76246>>>>>>>    End_Function // CKBuildRevision
76247>>>>>>>
76247>>>>>>>
76247>>>>>>>
76247>>>>>>>    //***
76247>>>>>>>    //*** Function: IsMinimalRevision
76247>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76247>>>>>>>    //***
76247>>>>>>>
76247>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76249>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76252>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76255>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76258>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76261>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76264>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76268>>>>>>>            End
76268>>>>>>>>
76268>>>>>>>        End
76268>>>>>>>>
76268>>>>>>>
76268>>>>>>>        Function_Return (FALSE)
76269>>>>>>>    End_Function // IsMinimalRevision
76270>>>>>>>
76270>>>>>>>
76270>>>>>>>
76270>>>>>>>    //***
76270>>>>>>>    //*** Function: RegistrationName
76270>>>>>>>    //*** Purpose : Returns the Connectiivty Kit registration name.
76270>>>>>>>    //***
76270>>>>>>>
76270>>>>>>>    Function RegistrationName Returns String
76272>>>>>>>        Local String  sRegistration
76272>>>>>>>        Local String  sDRiverId
76272>>>>>>>        Local String  sVoid
76272>>>>>>>        Local Integer iRetval
76272>>>>>>>
76272>>>>>>>        Get psDriverID To sDriverID
76273>>>>>>>        If (sDRiverID <> "") Begin
76275>>>>>>>            Move (Repeat(" ", 255)) To sRegistration
76276>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETREGNAME Callback 0 Passing sRegistration sVoid 0 Result iRetval
76281>>>>>>>        End
76281>>>>>>>>
76281>>>>>>>
76281>>>>>>>        Function_Return sRegistration
76282>>>>>>>    End_Function // RegistrationName
76283>>>>>>>
76283>>>>>>>
76283>>>>>>>
76283>>>>>>>    //***
76283>>>>>>>    //*** Function: SerialNumber
76283>>>>>>>    //*** Purpose : Returns the Connectiivty Kit serial number.
76283>>>>>>>    //***
76283>>>>>>>
76283>>>>>>>    Function SerialNumber Returns Integer
76285>>>>>>>        Local String  sDRiverId
76285>>>>>>>        Local String  sVoid
76285>>>>>>>        Local Integer iRetval
76285>>>>>>>
76285>>>>>>>        Get psDriverID To sDriverID
76286>>>>>>>        If (sDRiverID <> "") Begin
76288>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETSERIALNUM Callback 0 Passing sVoid sVoid 0 Result iRetval
76293>>>>>>>        End
76293>>>>>>>>
76293>>>>>>>
76293>>>>>>>        Function_Return iRetval
76294>>>>>>>    End_Function // SerialNumber
76295>>>>>>>
76295>>>>>>>
76295>>>>>>>
76295>>>>>>>    //***
76295>>>>>>>    //*** Function: MaxUsers
76295>>>>>>>    //*** Purpose : Returns the Connectiivty Kit maximum number of users.
76295>>>>>>>    //***
76295>>>>>>>
76295>>>>>>>    Function MaxUsers Returns Integer
76297>>>>>>>        Local String  sDRiverId
76297>>>>>>>        Local String  sVoid
76297>>>>>>>        Local Integer iRetval
76297>>>>>>>
76297>>>>>>>        Get psDriverID To sDriverID
76298>>>>>>>        If (sDRiverID <> "") Begin
76300>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETMAXUSERS Callback 0 Passing sVoid sVoid 0 Result iRetval
76305>>>>>>>        End
76305>>>>>>>>
76305>>>>>>>
76305>>>>>>>        Function_Return iRetval
76306>>>>>>>    End_Function // MaxUsers
76307>>>>>>>
76307>>>>>>>
76307>>>>>>>
76307>>>>>>>    //***
76307>>>>>>>    //*** Procedure: DumpStatus
76307>>>>>>>    //*** Purpose  : Dump the current status of the drver in the passed disk file.
76307>>>>>>>    //***
76307>>>>>>>
76307>>>>>>>    Procedure DumpStatus String sFileName
76309>>>>>>>        Local String  sVoid
76309>>>>>>>        Local String  sDriverID
76309>>>>>>>        Local Integer iVoid
76309>>>>>>>
76309>>>>>>>        Get psDriverID To sDriverID
76310>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_DUMPSTATUS Callback 0 Passing sFileName sVoid iVoid Result iVoid
76317>>>>>>>    End_Procedure // DumpStatus
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>    //***
76318>>>>>>>    //*** Procedure: ReadConfiguration
76318>>>>>>>    //*** Purpose  : Reset all driver level configurable attributes to the
76318>>>>>>>    //***            default value and then reread the configuration.
76318>>>>>>>    //***
76318>>>>>>>
76318>>>>>>>    Procedure ReadConfiguration
76320>>>>>>>        Local String  sVoid
76320>>>>>>>        Local String  sDriverID
76320>>>>>>>        Local Integer iVoid
76320>>>>>>>
76320>>>>>>>        Get psDriverID To sDriverID
76321>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_READCONFIGURATION Callback 0 Passing sVoid sVoid iVoid Result iVoid
76328>>>>>>>    End_Procedure // ReadConfiguration
76329>>>>>>>
76329>>>>>>>
76329>>>>>>>
76329>>>>>>>    //***
76329>>>>>>>    //*** Function: TextToRIMValue
76329>>>>>>>    //*** Purpose : Convert a text to the corresponding
76329>>>>>>>    //***           Generate_Record_ID_Method attribute value
76329>>>>>>>    //***
76329>>>>>>>
76329>>>>>>>    Function TextToRIMValue String sText Returns Integer
76331>>>>>>>        If (sText = "None") ;            Function_return RIM_NONE
76334>>>>>>>        Else If (sText = "Identity Column") ;            Function_return RIM_IDENTITY_COLUMN
76338>>>>>>>        Else If (sText = "Dispenser Table") ;            Function_return RIM_DISPENSER_TABLE
76342>>>>>>>        Else If (sText = "External") ;            Function_return RIM_EXTERNAL
76346>>>>>>>    End_Function // TextToRIMValue
76347>>>>>>>
76347>>>>>>>
76347>>>>>>>
76347>>>>>>>    //***
76347>>>>>>>    //*** Function: RIMValueTotext
76347>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76347>>>>>>>    //***           corresponding text.
76347>>>>>>>    //***
76347>>>>>>>
76347>>>>>>>    Function RIMValueToText Integer iAttrValue Returns String
76349>>>>>>>        If (iAttrValue = RIM_NONE) ;            Function_return "None"
76352>>>>>>>        Else If (iAttrValue = RIM_IDENTITY_COLUMN) ;            Function_return "Identity Column"
76356>>>>>>>        Else If (iAttrValue = RIM_DISPENSER_TABLE) ;            Function_return "Dispenser Table"
76360>>>>>>>        Else If (iAttrValue = RIM_EXTERNAL) ;            Function_return "External"
76364>>>>>>>    End_Function // RIMValueToText
76365>>>>>>>
76365>>>>>>>
76365>>>>>>>
76365>>>>>>>    //***
76365>>>>>>>    //*** Function: TextToROValue
76365>>>>>>>    //*** Purpose : Convert a text to the corresponding
76365>>>>>>>    //***           Generate_Record_ID_Method attribute value
76365>>>>>>>    //***
76365>>>>>>>
76365>>>>>>>    Function TextToROValue String sText Returns Integer
76367>>>>>>>        If (sText = "No") ;            Function_return RO_NO
76370>>>>>>>        Else If (sText = "Ignore Change") ;            Function_return RO_IGNORECHANGE
76374>>>>>>>        Else If (sText = "Accept Change") ;            Function_return RO_ACCEPTCHANGE
76378>>>>>>>        Else If (sText = "Error On Change") ;            Function_return RO_ERRORONCHANGE
76382>>>>>>>    End_Function // TextToRIMValue
76383>>>>>>>
76383>>>>>>>
76383>>>>>>>
76383>>>>>>>    //***
76383>>>>>>>    //*** Function: ROValueTotext
76383>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76383>>>>>>>    //***           corresponding text.
76383>>>>>>>    //***
76383>>>>>>>
76383>>>>>>>    Function ROValueToText Integer iAttrValue Returns String
76385>>>>>>>        If (iAttrValue = RO_NO) ;            Function_return "No"
76388>>>>>>>        Else If (iAttrValue = RO_IGNORECHANGE) ;            Function_return "Ignore Change"
76392>>>>>>>        Else If (iAttrValue = RO_ACCEPTCHANGE) ;            Function_return "Accept Change"
76396>>>>>>>        Else If (iAttrValue = RO_ERRORONCHANGE) ;            Function_return "Error On Change"
76400>>>>>>>    End_Function // RIMValueToText
76401>>>>>>>
76401>>>>>>>
76401>>>>>>>
76401>>>>>>>    //***
76401>>>>>>>    //*** Function: LastDriverError
76401>>>>>>>    //*** Purpose : Return the text f the last error geneated by the driver.
76401>>>>>>>    //***
76401>>>>>>>
76401>>>>>>>    Function LastDriverError Returns String
76403>>>>>>>        Local String  sDriverID
76403>>>>>>>        Local String  sLastError
76403>>>>>>>        Local String  sLastErrorLength
76403>>>>>>>        Local Integer iLastErrorLength
76403>>>>>>>        Local Integer iVoid
76403>>>>>>>
76403>>>>>>>        //*** Initialize
76403>>>>>>>        Move "" To sLastError
76404>>>>>>>
76404>>>>>>>        Get psDriverID To sDriverID
76405>>>>>>>        If (sDriverID <> "") Begin
76407>>>>>>>            //*** Get the text of the last error
76407>>>>>>>            Move (Repeat(Character(" "), 14)) To sLastErrorlength
76408>>>>>>>            Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastErrorLength iVoid DRVR_LASTERRORTEXTLENGTH Result iVoid
76413>>>>>>>            Move (Left(sLastErrorLength, Pos(Character(0), sLastErrorLength) - 1)) To iLastErrorLength
76414>>>>>>>
76414>>>>>>>            If (iLastErrorLength > 0) Begin
76416>>>>>>>                Move (Repeat(Character(" "), iLastErrorLength + 1)) To sLastError
76417>>>>>>>                Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastError iVoid DRVR_LASTERRORTEXT Result iVoid
76422>>>>>>>                Move (Left(sLastError, Pos(Character(0), sLastError) - 1)) To sLastError
76423>>>>>>>            End
76423>>>>>>>>
76423>>>>>>>        End
76423>>>>>>>>
76423>>>>>>>
76423>>>>>>>        Function_Return sLastError
76424>>>>>>>    End_Function // LastDriverError
76425>>>>>>>
76425>>>>>>>
76425>>>>>>>
76425>>>>>>>    //***
76425>>>>>>>    //*** Function: EnumerateTables
76425>>>>>>>    //*** Purpose : Enumerate the tables in a database
76425>>>>>>>    //***
76425>>>>>>>
76425>>>>>>>    Function EnumerateTables String sLogin Returns Integer
76427>>>>>>>        Local String  sDriver
76427>>>>>>>        Local String  sVoid
76427>>>>>>>        Local Integer iNumTables
76427>>>>>>>        Local Integer iVoid
76427>>>>>>>
76427>>>>>>>        Get psDriverID To sDriver
76428>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_TABLES Callback 0 Passing sLogin sVoid iVoid Result iNumTables
76435>>>>>>>
76435>>>>>>>        Function_Return iNumTables
76436>>>>>>>    End_Function // EnumerateTables
76437>>>>>>>
76437>>>>>>>
76437>>>>>>>
76437>>>>>>>    //***
76437>>>>>>>    //*** Function: TableName
76437>>>>>>>    //*** Purpose : Returns the name of the table enumerated at the given position
76437>>>>>>>    //***
76437>>>>>>>
76437>>>>>>>    Function TableName Integer iIndex Returns String
76439>>>>>>>        Local String  sDriver
76439>>>>>>>        Local String  sTableName
76439>>>>>>>        Local String  sVoid
76439>>>>>>>        Local Integer iVoid
76439>>>>>>>
76439>>>>>>>        Get psDriverID To sDriver
76440>>>>>>>        If (sDriver <> "") Begin
76442>>>>>>>            Move (Repeat(" ", 255)) To sTableName
76443>>>>>>>            Call_driver 0 sDriver Function CLI_TABLENAME Callback 0 Passing sTableName sVoid iIndex Result iVoid
76448>>>>>>>        End
76448>>>>>>>>
76448>>>>>>>
76448>>>>>>>        Function_Return sTableName
76449>>>>>>>    End_Function // TableName
76450>>>>>>>
76450>>>>>>>
76450>>>>>>>
76450>>>>>>>    //***
76450>>>>>>>    //*** Function: SchemaName
76450>>>>>>>    //*** Purpose : Returns the name of the schema of the table enumerated at the given position
76450>>>>>>>    //***
76450>>>>>>>
76450>>>>>>>    Function SchemaName Integer iIndex Returns String
76452>>>>>>>        Local String  sDriver
76452>>>>>>>        Local String  sSchemaName
76452>>>>>>>        Local String  sVoid
76452>>>>>>>        Local Integer iVoid
76452>>>>>>>
76452>>>>>>>        Get psDriverID To sDriver
76453>>>>>>>        If (sDriver <> "") Begin
76455>>>>>>>            Move (Repeat(" ", 255)) To sSchemaName
76456>>>>>>>            Call_driver 0 sDriver Function CLI_TABLESCHEMA Callback 0 Passing sSchemaName sVoid iIndex Result iVoid
76461>>>>>>>        End
76461>>>>>>>>
76461>>>>>>>
76461>>>>>>>        Function_Return sSchemaName
76462>>>>>>>    End_Function // SchemaName
76463>>>>>>>
76463>>>>>>>
76463>>>>>>>
76463>>>>>>>    //***
76463>>>>>>>    //*** Function: TableType
76463>>>>>>>    //*** Purpose : Returns the type of the table enumerated at the given position.
76463>>>>>>>    //***           Types can be "TABLE", "VIEW", "SYSTEM TABLE", "GLOBAL TEMPORARY",
76463>>>>>>>    //***           "LOCAL TEMPORARY", "ALIAS", "SYNONYM"
76463>>>>>>>    //***
76463>>>>>>>
76463>>>>>>>    Function TableType Integer iIndex Returns String
76465>>>>>>>        Local String  sDriver
76465>>>>>>>        Local String  sTableType
76465>>>>>>>        Local String  sVoid
76465>>>>>>>        Local Integer iVoid
76465>>>>>>>
76465>>>>>>>        Get psDriverID To sDriver
76466>>>>>>>        If (sDriver <> "") Begin
76468>>>>>>>            Move (Repeat(" ", 25)) To sTableType
76469>>>>>>>            Call_driver 0 sDriver Function CLI_TABLETYPE Callback 0 Passing sTableType sVoid iIndex Result iVoid
76474>>>>>>>        End
76474>>>>>>>>
76474>>>>>>>
76474>>>>>>>        Function_Return sTableType
76475>>>>>>>    End_Function // TableType
76476>>>>>>>
76476>>>>>>>
76476>>>>>>>
76476>>>>>>>    //***
76476>>>>>>>    //*** Function: TableComment
76476>>>>>>>    //*** Purpose : Returns the comment of the table enumerated at the given position
76476>>>>>>>    //***
76476>>>>>>>
76476>>>>>>>    Function TableComment Integer iIndex Returns String
76478>>>>>>>        Local String  sDriver
76478>>>>>>>        Local String  sTableComment
76478>>>>>>>        Local String  sVoid
76478>>>>>>>        Local Integer iVoid
76478>>>>>>>
76478>>>>>>>        Get psDriverID To sDriver
76479>>>>>>>        If (sDriver <> "") Begin
76481>>>>>>>            Move (Repeat(" ", 255)) To sTableComment
76482>>>>>>>            Call_driver 0 sDriver Function CLI_TABLECOMMENT Callback 0 Passing sTableComment sVoid iIndex Result iVoid
76487>>>>>>>        End
76487>>>>>>>>
76487>>>>>>>
76487>>>>>>>        Function_Return sTableComment
76488>>>>>>>    End_Function // TableComment
76489>>>>>>>
76489>>>>>>>
76489>>>>>>>
76489>>>>>>>    //***
76489>>>>>>>    //*** Function: EnumerateColumns
76489>>>>>>>    //*** Purpose : Enumerate the columns in a table
76489>>>>>>>    //***
76489>>>>>>>
76489>>>>>>>    Function EnumerateColumns String sLogin String sTableName Returns Integer
76491>>>>>>>        Local String  sDriver
76491>>>>>>>        Local Integer iNumColumns
76491>>>>>>>        Local Integer iVoid
76491>>>>>>>
76491>>>>>>>        Get psDriverID To sDriver
76492>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_COLUMNS Callback 0 Passing sLogin sTablename iVoid Result iNumColumns
76499>>>>>>>
76499>>>>>>>        Function_Return iNumColumns
76500>>>>>>>    End_Function // EnumerateColumns
76501>>>>>>>
76501>>>>>>>
76501>>>>>>>
76501>>>>>>>    //***
76501>>>>>>>    //*** Function: ColumnName
76501>>>>>>>    //*** Purpose : Returns the name of the column enumerated at the given position
76501>>>>>>>    //***
76501>>>>>>>
76501>>>>>>>    Function ColumnName Integer iIndex Returns String
76503>>>>>>>        Local String  sDriver
76503>>>>>>>        Local String  sColumnName
76503>>>>>>>        Local String  sVoid
76503>>>>>>>        Local Integer iVoid
76503>>>>>>>
76503>>>>>>>        Get psDriverID To sDriver
76504>>>>>>>        If (sDriver <> "") Begin
76506>>>>>>>            Move (Repeat(" ", 255)) To sColumnName
76507>>>>>>>            Call_driver 0 sDriver Function CLI_COLUMNNAME Callback 0 Passing sColumnName sVoid iIndex Result iVoid
76512>>>>>>>        End
76512>>>>>>>>
76512>>>>>>>
76512>>>>>>>        Function_Return sColumnName
76513>>>>>>>    End_Function // ColumnName
76514>>>>>>>
76514>>>>>>>
76514>>>>>>>
76514>>>>>>>    //***
76514>>>>>>>    //*** Function: CLIDFDateToSQLDate
76514>>>>>>>    //*** Purpose : Convert a DataFlex date to a SQL date using the dummy zero date value.
76514>>>>>>>    //***
76514>>>>>>>
76514>>>>>>>    Function CLIDFDateToSQLDate String sDRiver Date dDFDate Returns String
76516>>>>>>>        Local String sSQLDate
76516>>>>>>>        Local Integer iOrgDateFmt
76516>>>>>>>        Local Integer iOrgDateSep
76516>>>>>>>
76516>>>>>>>        //*** Change date format to military, SQL dates are military dates
76516>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76519>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76522>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76525>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76528>>>>>>>
76528>>>>>>>        //*** We only need to convert if the date is 0
76528>>>>>>>        If (Integer(dDFDate = 0)) ;            CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sSQLDate
76537>>>>>>>        Else ;            Move dDFDate To sSQLDate
76539>>>>>>>
76539>>>>>>>        //*** Change date format back to original
76539>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76542>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76545>>>>>>>
76545>>>>>>>        Function_Return sSQLDate
76546>>>>>>>    End_Function // CLIDFDateToSQLDate
76547>>>>>>>
76547>>>>>>>
76547>>>>>>>
76547>>>>>>>    //***
76547>>>>>>>    //*** Function: CLISQLDateToDFDate
76547>>>>>>>    //*** Purpose : Convert a SQL date to a DataFlex date using the dummy zero date value.
76547>>>>>>>    //***
76547>>>>>>>
76547>>>>>>>    Function CLISQLDateToDFDate String sDRiver String sSQLDate Returns Date
76549>>>>>>>        Local Date dDFDate
76549>>>>>>>        Local String sDummyDateValue
76549>>>>>>>        Local Integer iOrgDateFmt
76549>>>>>>>        Local Integer iOrgDateSep
76549>>>>>>>
76549>>>>>>>        //*** Change date format to military, SQL dates are military dates
76549>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76552>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76555>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76558>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76561>>>>>>>
76561>>>>>>>        //*** We only need to convert if the date is the dummy zero date value
76561>>>>>>>        CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sDummyDateValue
76568>>>>>>>        If (sDummyDateValue = sSQLDate) ;            Move 0 To dDFDate
76571>>>>>>>        Else ;            Move sSQLDate To dDFDate
76573>>>>>>>
76573>>>>>>>        //*** Change date format back to original
76573>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76576>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76579>>>>>>>
76579>>>>>>>        Function_Return dDFDate
76580>>>>>>>    End_Function // CLISQLDateToDFDate
76581>>>>>>>
76581>>>>>>>
76581>>>>>>>
76581>>>>>>>    //***
76581>>>>>>>    //*** Function: RedirectConnection
76581>>>>>>>    //*** Purpose : Redirect an exisitng connection. The existing connection
76581>>>>>>>    //***           will point to another database but all tables will stay
76581>>>>>>>    //***           open!
76581>>>>>>>    //***
76581>>>>>>>
76581>>>>>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
76583>>>>>>>        Local String  sDriver
76583>>>>>>>        Local String  sVoid
76583>>>>>>>        Local Integer iResult
76583>>>>>>>        Local Integer iVoid
76583>>>>>>>
76583>>>>>>>        Get psDriverID To sDriver
76584>>>>>>>        If (sDriver <> "") Begin
76586>>>>>>>            Call_driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sOldConnection sNewConnection iVoid Result iResult
76591>>>>>>>        End
76591>>>>>>>>
76591>>>>>>>        Function_Return iResult
76592>>>>>>>    End_Function // RedirectConnect
76593>>>>>>>
76593>>>>>>>
76593>>>>>>>
76593>>>>>>>    //***
76593>>>>>>>    //*** Function: CreateConnectionID
76593>>>>>>>    //*** Purpose : Create a DataFlex side connection id that can be used later on.
76593>>>>>>>    //***
76593>>>>>>>
76593>>>>>>>    Function CreateConnectionID String sID String sConnStr Integer iOpt Returns Integer
76595>>>>>>>        Local String  sDriver
76595>>>>>>>        Local Integer iResult
76595>>>>>>>        Local Integer iOptions
76595>>>>>>>
76595>>>>>>>        Get psDriverID to sDriver
76596>>>>>>>        If (Num_Arguments = 2) ;            Move 0 to iOptions
76599>>>>>>>        Else ;            Move iOpt to iOptions
76601>>>>>>>        If (sDriver <> "") Begin
76603>>>>>>>            Call_Driver 0 sDriver Function CLI_CREATECONNECTIONID Callback 0 Passing sID sConnStr iOptions Result iResult
76608>>>>>>>        End
76608>>>>>>>>
76608>>>>>>>        Function_Return iResult
76609>>>>>>>    End_Function // CreateConnectionID
76610>>>>>>>
76610>>>>>>>
76610>>>>>>>
76610>>>>>>>    //***
76610>>>>>>>    //*** Function: DeleteConnectionID
76610>>>>>>>    //*** Purpose : Delete a DataFlex side connection id.
76610>>>>>>>    //***
76610>>>>>>>
76610>>>>>>>    Function DeleteConnectionID String sID Integer iIndex Returns Integer
76612>>>>>>>        Local String  sDriver
76612>>>>>>>        Local Integer iResult
76612>>>>>>>        Local String sVoid
76612>>>>>>>
76612>>>>>>>        Get psDriverID To sDriver
76613>>>>>>>        If (sDriver <> "") Begin
76615>>>>>>>            Call_Driver 0 sDriver Function CLI_DELETECONNECTIONID Callback 0 Passing sID sVoid iIndex Result iResult
76620>>>>>>>        End
76620>>>>>>>>
76620>>>>>>>        Function_Return iResult
76621>>>>>>>    End_Function // DeleteConnectionID
76622>>>>>>>
76622>>>>>>>End_Class // cCLIHandler
76623>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 18.2\Pkg\DFBTRDRV.PKG)
76623>>>>>>>//****************************************************************************
76623>>>>>>>//
76623>>>>>>>// $File name  : DFBTRDRV.PKG
76623>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
76623>>>>>>>// Notice      : This package contains constants and commands, used to call
76623>>>>>>>//               specific functions in the DFBTRDRV.
76623>>>>>>>// $Author(s)  : Eddy Kleinjan
76623>>>>>>>//
76623>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
76623>>>>>>>// Created     : 01-07-97 @ 12:00:00
76623>>>>>>>//
76623>>>>>>>// Changed     : 04-04-2001.
76623>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
76623>>>>>>>//
76623>>>>>>>// Changed     : June 6, 2001
76623>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
76623>>>>>>>//
76623>>>>>>>//               Added DFBTR_DDF_OWNER command.
76623>>>>>>>//
76623>>>>>>>// Changed     : June 12, 2001
76623>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
76623>>>>>>>//
76623>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
76623>>>>>>>//
76623>>>>>>>// Changed     : August 4, 2004
76623>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
76623>>>>>>>//
76623>>>>>>>//               Added cDfbtrdrvHandler class.
76623>>>>>>>//               New functions in this class:
76623>>>>>>>//                  Function CKRevision Returns String
76623>>>>>>>//                  Function CkUsesUri Returns Integer
76623>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76623>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76623>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76623>>>>>>>//
76623>>>>>>>// Changed     : September 30, 2005
76623>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
76623>>>>>>>//
76623>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
76623>>>>>>>//****************************************************************************
76623>>>>>>>Use Ui
76623>>>>>>>//
76623>>>>>>>// Driver Indentification
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>//*** Driver attributes
76623>>>>>>>//
76623>>>>>>>// Call_Driver functions ID's
76623>>>>>>>//
76623>>>>>>>//
76623>>>>>>>// DFBTRFN_CONVERT_FILE options
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// DFBTRFN_SET_OWNER options
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to create all vars which may be needed
76623>>>>>>>// in other commands.
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to set the owner of a Btrieve file.
76623>>>>>>>// File must have been opened.
76623>>>>>>>// Filenumber needs to be passed.
76623>>>>>>>// To clear set the owner to "".
76623>>>>>>>// Examples:
76623>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
76623>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
76623>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
76623>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
76623>>>>>>>// To clear:
76623>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to parse DFBTR_SET_OWNVER
76623>>>>>>>// options.
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to parse for Callback
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to clear the owner of a Btrieve file.
76623>>>>>>>// File must have been opened.
76623>>>>>>>// Filenumber needs to be passed.
76623>>>>>>>// Examples:
76623>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to add a owner name to the internal list of ownernames
76623>>>>>>>// which will be tries when opening files.
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to remove all owners from the internal list of ownernames
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to set the owner name to be used when opening the DDF files.
76623>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
76623>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
76623>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to change the transaction type.
76623>>>>>>>// Valid types are:
76623>>>>>>>//     DFBTRTT_NONE
76623>>>>>>>//     DFBTRTT_EXCLUSIVE
76623>>>>>>>//     DFBTRTT_CONCURRENT
76623>>>>>>>//
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to get the current transaction type.
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to set explicit_locking
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to get explicit locking
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>//
76623>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
76623>>>>>>>//
76623>>>>>>>
76623>>>>>>>//*****************************************************************************
76623>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
76623>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76623>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
76623>>>>>>>//*****************************************************************************
76623>>>>>>>
76623>>>>>>>Class cDFBtrDrvHandler Is An Array
76624>>>>>>>
76624>>>>>>>    Procedure Construct_Object Integer iImage
76626>>>>>>>        Forward Send Construct_object iImage
76628>>>>>>>
76628>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
76629>>>>>>>    End_Procedure // Construct_Object
76630>>>>>>>
76630>>>>>>>
76630>>>>>>>
76630>>>>>>>    //***
76630>>>>>>>    //*** Function: CKRevsion
76630>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
76630>>>>>>>    //***
76630>>>>>>>
76630>>>>>>>    Function CKRevision Returns String
76632>>>>>>>        Local String  sDriverID
76632>>>>>>>        Local String  sRevision
76632>>>>>>>        Local String  sVoid
76632>>>>>>>        Local Integer iRetval
76632>>>>>>>
76632>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76632>>>>>>>        // This error would otherwise be raised when we have an older
76632>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76632>>>>>>>        Send Ignore_error To Error_object_Id 20491
76633>>>>>>>        Get psDriverID To sDriverID
76634>>>>>>>        Move (Repeat(" ", 255)) To sRevision
76635>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76640>>>>>>>        Send Trap_Error To Error_object_Id 20491
76641>>>>>>>        If (Trim(sRevision) = "") Begin
76643>>>>>>>            // Unable to get the revision. return all zeroes.
76643>>>>>>>            Move "0.0.0.0" To sRevision
76644>>>>>>>        End
76644>>>>>>>>
76644>>>>>>>        Function_Return sRevision
76645>>>>>>>    End_Function // CKRevision
76646>>>>>>>
76646>>>>>>>    Function CkUsesUri Returns Integer
76648>>>>>>>        Local String  sDriverID
76648>>>>>>>        Local String  sVoid1
76648>>>>>>>        Local String  sVoid2
76648>>>>>>>        Local Integer iRetval
76648>>>>>>>
76648>>>>>>>        Get psDriverID To sDriverID
76649>>>>>>>
76649>>>>>>>        Move 0 To iRetval
76650>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76650>>>>>>>        // This error would otherwise be raised when we have an older
76650>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
76650>>>>>>>        Send Ignore_error To Error_object_Id 20491
76651>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
76656>>>>>>>        Send Trap_Error To Error_object_Id 20491
76657>>>>>>>
76657>>>>>>>        Function_Return iRetval
76658>>>>>>>    End_Function // CKUsesUri
76659>>>>>>>
76659>>>>>>>
76659>>>>>>>
76659>>>>>>>    //***
76659>>>>>>>    //*** Function: ExtractPartFromRevsion
76659>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76659>>>>>>>    //***
76659>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76659>>>>>>>    //***
76659>>>>>>>
76659>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76661>>>>>>>        Local Integer iPartRev
76661>>>>>>>        Local Integer iCurrentPart
76661>>>>>>>        Local Integer iSeparatorPos
76661>>>>>>>
76661>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76664>>>>>>>
76664>>>>>>>        Move 0 To iCurrentPart
76665>>>>>>>        Repeat
76665>>>>>>>>
76665>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76666>>>>>>>            If (iSeparatorPos > 0) Begin
76668>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76669>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76670>>>>>>>                Increment iCurrentPart
76671>>>>>>>            End
76671>>>>>>>>
76671>>>>>>>            Else If (sRevision <> "") Begin
76674>>>>>>>                Move sRevision To iPartRev
76675>>>>>>>                Move "" To sRevision
76676>>>>>>>                Increment iCurrentPart
76677>>>>>>>            End
76677>>>>>>>>
76677>>>>>>>            Else ;                Move -1 To iPartRev
76679>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76681>>>>>>>
76681>>>>>>>        Function_Return iPartRev
76682>>>>>>>    End_Function // EcxtractPartFromRevision
76683>>>>>>>
76683>>>>>>>
76683>>>>>>>
76683>>>>>>>    //***
76683>>>>>>>    //*** Function: CKMajorRevision
76683>>>>>>>    //*** Purpose : Returns the major revision of the CK
76683>>>>>>>    //***
76683>>>>>>>
76683>>>>>>>    Function CKMajorRevision Returns Integer
76685>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76686>>>>>>>    End_Function // CKMajorRevision
76687>>>>>>>
76687>>>>>>>
76687>>>>>>>
76687>>>>>>>    //***
76687>>>>>>>    //*** Function: CKMinorRevision
76687>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76687>>>>>>>    //***
76687>>>>>>>
76687>>>>>>>    Function CKMinorRevision Returns Integer
76689>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76690>>>>>>>    End_Function // CKMinorRevision
76691>>>>>>>
76691>>>>>>>
76691>>>>>>>
76691>>>>>>>    //***
76691>>>>>>>    //*** Function: CKReleaseRevision
76691>>>>>>>    //*** Purpose : Returns the release revision of the CK
76691>>>>>>>    //***
76691>>>>>>>
76691>>>>>>>    Function CKReleaseRevision Returns Integer
76693>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76694>>>>>>>    End_Function // CKReleaseRevision
76695>>>>>>>
76695>>>>>>>
76695>>>>>>>
76695>>>>>>>    //***
76695>>>>>>>    //*** Function: CKBuildRevision
76695>>>>>>>    //*** Purpose : Returns the major revision of the CK
76695>>>>>>>    //***
76695>>>>>>>
76695>>>>>>>    Function CKBuildRevision Returns Integer
76697>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76698>>>>>>>    End_Function // CKBuildRevision
76699>>>>>>>
76699>>>>>>>
76699>>>>>>>
76699>>>>>>>    //***
76699>>>>>>>    //*** Function: IsMinimalRevision
76699>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76699>>>>>>>    //***
76699>>>>>>>
76699>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76701>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76704>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76707>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76710>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76713>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76716>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76720>>>>>>>            End
76720>>>>>>>>
76720>>>>>>>        End
76720>>>>>>>>
76720>>>>>>>
76720>>>>>>>        Function_Return (FALSE)
76721>>>>>>>    End_Function // IsMinimalRevision
76722>>>>>>>
76722>>>>>>>    //   Functions to query the Pervasive.SQL version:
76722>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
76722>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
76722>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
76722>>>>>>>    //
76722>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
76722>>>>>>>    //   in the following format:
76722>>>>>>>    //       <version>.<revision>.<type>
76722>>>>>>>    //   possible values for <type>:
76722>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
76722>>>>>>>    //         server using Workgroup authentication mode
76722>>>>>>>    //       C for client cache engine
76722>>>>>>>    //       D for DOS workstation
76722>>>>>>>    //       N for client Requester
76722>>>>>>>    //       S for NetWare server
76722>>>>>>>    //       T for 32-bit Windows server engine
76722>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
76722>>>>>>>    //
76722>>>>>>>    //   example:
76722>>>>>>>    //       8.50.T
76722>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
76722>>>>>>>    //   32-bits Windows server.
76722>>>>>>>    //
76722>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
76722>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
76722>>>>>>>    //
76722>>>>>>>    //   If the version information is not available or can not be obtained
76722>>>>>>>    //   the functions will return "0.0.0"
76722>>>>>>>
76722>>>>>>>
76722>>>>>>>    //***
76722>>>>>>>    //*** Function: PSQLRequesterVersionInfo
76722>>>>>>>    //*** Purpose : Returns the version information of the
76722>>>>>>>    //***           Pervasive.SQL Client requester.
76722>>>>>>>
76722>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76724>>>>>>>
76724>>>>>>>        Local String  sDriverID
76724>>>>>>>        Local String  sVersion
76724>>>>>>>        Local String  sVoid
76724>>>>>>>        Local Integer iRetval
76724>>>>>>>
76724>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76724>>>>>>>        // This error would otherwise be raised when we have an older
76724>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76724>>>>>>>        Send Ignore_error To Error_object_Id 20491
76725>>>>>>>        Get psDriverID To sDriverID
76726>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76727>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76732>>>>>>>        Send Trap_Error To Error_object_Id 20491
76733>>>>>>>        If (Trim(sVersion) = "") Begin
76735>>>>>>>            // Unable to get the revision. return all zeroes.
76735>>>>>>>            Move "0.0.0" To sVersion
76736>>>>>>>        End
76736>>>>>>>>
76736>>>>>>>        Function_Return sVersion
76737>>>>>>>    End_Function //  PSQLRequesterVersion
76738>>>>>>>
76738>>>>>>>    //***
76738>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
76738>>>>>>>    //*** Purpose : Returns the version information of the
76738>>>>>>>    //***           Pervasive.SQL Local Engine
76738>>>>>>>
76738>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76740>>>>>>>
76740>>>>>>>        Local String  sDriverID
76740>>>>>>>        Local String  sVersion
76740>>>>>>>        Local String  sVoid
76740>>>>>>>        Local Integer iRetval
76740>>>>>>>
76740>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76740>>>>>>>        // This error would otherwise be raised when we have an older
76740>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76740>>>>>>>        Send Ignore_error To Error_object_Id 20491
76741>>>>>>>        Get psDriverID To sDriverID
76742>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76743>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76748>>>>>>>        Send Trap_Error To Error_object_Id 20491
76749>>>>>>>        If (Trim(sVersion) = "") Begin
76751>>>>>>>            // Unable to get the revision. return all zeroes.
76751>>>>>>>            Move "0.0.0" To sVersion
76752>>>>>>>        End
76752>>>>>>>>
76752>>>>>>>        Function_Return sVersion
76753>>>>>>>    End_Function //  PSQLLocalEngineVersion
76754>>>>>>>
76754>>>>>>>    //***
76754>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
76754>>>>>>>    //*** Purpose : Returns the version information of the
76754>>>>>>>    //***           Pervasive.SQL Server Engine
76754>>>>>>>
76754>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76756>>>>>>>
76756>>>>>>>        Local String  sDriverID
76756>>>>>>>        Local String  sVersion
76756>>>>>>>        Local String  sVoid
76756>>>>>>>        Local Integer iRetval
76756>>>>>>>
76756>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76756>>>>>>>        // This error would otherwise be raised when we have an older
76756>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76756>>>>>>>        Send Ignore_error To Error_object_Id 20491
76757>>>>>>>        Get psDriverID To sDriverID
76758>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76759>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76764>>>>>>>        Send Trap_Error To Error_object_Id 20491
76765>>>>>>>        If (Trim(sVersion) = "") Begin
76767>>>>>>>            // Unable to get the revision. return all zeroes.
76767>>>>>>>            Move "0.0.0" To sVersion
76768>>>>>>>        End
76768>>>>>>>>
76768>>>>>>>        Function_Return sVersion
76769>>>>>>>    End_Function //  PSQLServerEngineVersion
76770>>>>>>>
76770>>>>>>>End_Class // cDfbtrdrvHandler
76771>>>>>>>
76771>>>>>
76771>>>>>
76771>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
76772>>>>>
76772>>>>>Register_Function phoWorkspace Returns Handle
76772>>>>>Register_Function Help_filename Returns String
76772>>>>>Register_Function GetHelpFile Returns String
76772>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
76772>>>>>
76772>>>>>//****************************************************************************
76772>>>>>// $Module type: FUNCTION
76772>>>>>// $Module name: Network_User_Name
76772>>>>>// $Author     : AK/VOO/KCR
76772>>>>>// Created     : 09-24-96 @ 19:17
76772>>>>>//
76772>>>>>// Description
76772>>>>>//    This function reads the current username Of windows and returns that
76772>>>>>//    name or an text unknown user
76772>>>>>//
76772>>>>>// $Rev History
76772>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
76772>>>>>//  07/25/2003  Replaced obsolete code
76772>>>>>//  09/24/1996  Module header created
76772>>>>>//****************************************************************************
76772>>>>>Function Network_User_Name for cDesktop Returns String
76774>>>>>    String sName
76774>>>>>    Integer iRetval iLength
76774>>>>>
76774>>>>>    Move 0 to iLength
76775>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
76776>>>>>    ZeroString iLength to sName
76777>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
76778>>>>>
76778>>>>>    If (iRetval = NO_ERROR) Begin
76780>>>>>        Function_Return (CString (sName))
76781>>>>>    End
76781>>>>>>
76781>>>>>    
76781>>>>>    Function_Return "User Unknown"
76782>>>>>End_Function
76783>>>>>
76783>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
76783>>>>>Type MEMORYSTATUS
76783>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
76783>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
76783>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
76783>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
76783>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
76783>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
76783>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
76783>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
76783>>>>>End_Type // MEMORYSTATUS
76783>>>>>
76783>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
76784>>>>>
76784>>>>>Struct tWinMemoryStatusEx
76784>>>>>    UInteger dwLength                
76784>>>>>    UInteger dwMemoryLoad          
76784>>>>>    UBigInt ullTotalPhys           
76784>>>>>    UBigInt ullAvailPhys           
76784>>>>>    UBigInt ullTotalPageFile       
76784>>>>>    UBigInt ullAvailPageFile       
76784>>>>>    UBigInt ullTotalVirtual        
76784>>>>>    UBigInt ullAvailVirtual        
76784>>>>>    UBigInt ullAvailExtendedVirtual
76784>>>>>End_Struct
76784>>>>>
76784>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
76785>>>>>
76785>>>>>Class SysinfoDisplay is a cTextEdit
76786>>>>>    Procedure Construct_Object
76788>>>>>        Forward Send Construct_Object
76790>>>>>
76790>>>>>        Set Location To 6 6
76791>>>>>        Set Size To 110 255
76792>>>>>        Set Read_Only_State To True
76793>>>>>        Set pbWrap to False
76794>>>>>    End_Procedure
76795>>>>>
76795>>>>>    //****************************************************************************
76795>>>>>    // $Module type: PROCEDURE
76795>>>>>    // $Module name: Show_Current_Directory
76795>>>>>    // $Author     : VOO
76795>>>>>    // Created     : 06-10-96 @ 15:24
76795>>>>>    //
76795>>>>>    // Description
76795>>>>>    //    This method will show the name Of the current directory in the system
76795>>>>>    //    information box
76795>>>>>    //
76795>>>>>    // $Rev History
76795>>>>>    //    06-10-96  Module header created
76795>>>>>    //****************************************************************************
76795>>>>>    Procedure Show_Current_Directory
76797>>>>>        String sDir
76797>>>>>
76797>>>>>        Get_Current_Directory To sDir
76798>>>>>
76798>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
76799>>>>>    End_Procedure
76800>>>>>
76800>>>>>    Procedure Show_Windows_Directory
76802>>>>>        String sWindir
76802>>>>>
76802>>>>>        Get_Windows_Directory To sWindir
76803>>>>>
76803>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
76804>>>>>    End_Procedure
76805>>>>>
76805>>>>>    Procedure Show_Current_User
76807>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
76808>>>>>    End_Procedure
76809>>>>>
76809>>>>>    Procedure Show_Number_Format
76811>>>>>        Integer iFormat
76811>>>>>        String sFormatText
76811>>>>>
76811>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
76814>>>>>        Move (Character (iFormat)) To sFormatText
76815>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
76816>>>>>
76816>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
76819>>>>>        Move (Character (iFormat)) to sFormatText
76820>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
76821>>>>>    End_Procedure
76822>>>>>
76822>>>>>    Procedure Show_Filelist_Name
76824>>>>>        String sFilename
76824>>>>>
76824>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
76827>>>>>
76827>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
76828>>>>>        Send AppendTextLn ""
76829>>>>>    End_Procedure
76830>>>>>
76830>>>>>    Procedure Show_Lock_Delay
76832>>>>>        Integer iLockdelay
76832>>>>>
76832>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
76835>>>>>
76835>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
76836>>>>>    End_Procedure
76837>>>>>
76837>>>>>    Procedure Show_Lock_Timeout
76839>>>>>        Integer iLockTimeout
76839>>>>>
76839>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
76842>>>>>
76842>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
76843>>>>>    End_Procedure
76844>>>>>
76844>>>>>    Procedure Show_Screen_Size
76846>>>>>        Integer iYscreensize iXscreensize
76846>>>>>
76846>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
76847>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
76848>>>>>
76848>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
76849>>>>>    End_Procedure
76850>>>>>
76850>>>>>    Procedure Show_Page_Size
76852>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
76853>>>>>    End_procedure
76854>>>>>
76854>>>>>    Procedure Show_Date
76856>>>>>        Date dToday
76856>>>>>
76856>>>>>        Sysdate dToday
76857>>>>>
76857>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
76858>>>>>    End_procedure
76859>>>>>
76859>>>>>    Procedure Show_Date_Format
76861>>>>>        Integer iDateFormat
76861>>>>>        String sDateFormat
76861>>>>>
76861>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
76864>>>>>        Case Begin
76864>>>>>            Case (iDateFormat = DF_DATE_USA)
76866>>>>>                Move C_$USA To sDateFormat
76867>>>>>                Case Break
76868>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
76871>>>>>                Move C_$European To sDateFormat
76872>>>>>                Case Break
76873>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
76876>>>>>                Move C_$Military To sDateFormat
76877>>>>>                Case Break
76878>>>>>            Case Else
76878>>>>>                Move C_$UnknownDateType To sDateFormat
76879>>>>>                Case Break
76880>>>>>        Case End
76880>>>>>
76880>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
76881>>>>>    End_Procedure
76882>>>>>
76882>>>>>    Procedure Show_Systemresources
76884>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76884>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76884>>>>>        Integer iRetval
76884>>>>>
76884>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
76885>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
76886>>>>>        If (iRetval = 0) Begin
76888>>>>>            Move (ShowLastError ()) to iRetval
76889>>>>>        End
76889>>>>>>
76889>>>>>
76889>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
76890>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
76891>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
76892>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
76893>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
76894>>>>>    End_Procedure
76895>>>>>
76895>>>>>    Procedure Show_Registration
76897>>>>>        String sRegName
76897>>>>>        Integer iSN iMaxUsers
76897>>>>>
76897>>>>>        Registration sRegName iSN
76898>>>>>>
76898>>>>>        
76898>>>>>        Get_Licensed_Max_Users to iMaxUsers
76899>>>>>
76899>>>>>        Send AppendTextLn ""
76900>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
76901>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
76902>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
76903>>>>>    End_Procedure
76904>>>>>
76904>>>>>    //****************************************************************************
76904>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
76904>>>>>    // To the workspace object passing the an object and message To send back
76904>>>>>    // To this object. It is expected that the workspace object will send this
76904>>>>>    // message for every line Of information it wants displayed (passing the
76904>>>>>    // information To be displayed
76904>>>>>    //****************************************************************************
76904>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
76904>>>>>
76904>>>>>    Procedure Show_ServicePack
76906>>>>>        String sKey sVersionDescription sVersion 
76906>>>>>        Handle hoRegistry
76906>>>>>        Boolean bExists bOpened
76906>>>>>        
76906>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
76907>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
76908>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
76909>>>>>
76909>>>>>        Move C_DFVersionRegistryRoot to sKey
76910>>>>>        Get KeyExists of hoRegistry sKey to bExists
76911>>>>>        If (bExists) Begin
76913>>>>>            Get OpenKey of hoRegistry sKey to bOpened
76914>>>>>            If (bOpened) Begin
76916>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
76917>>>>>                If (bExists) Begin
76919>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
76920>>>>>                End
76920>>>>>>
76920>>>>>                
76920>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
76921>>>>>                If (bExists) Begin
76923>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
76924>>>>>                End                
76924>>>>>>
76924>>>>>                Send CloseKey of hoRegistry
76925>>>>>            End
76925>>>>>>
76925>>>>>        End
76925>>>>>>
76925>>>>>        Send Destroy of hoRegistry
76926>>>>>
76926>>>>>        If (sVersionDescription <> "") Begin
76928>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
76929>>>>>           Send AppendTextLn ""
76930>>>>>        End
76930>>>>>>
76930>>>>>    End_Procedure
76931>>>>>    
76931>>>>>
76931>>>>>    Procedure Show_WorkspaceInformation
76933>>>>>        Integer hoWorkspace
76933>>>>>
76933>>>>>        If (ghoApplication <> 0) Begin
76935>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
76936>>>>>            If (hoWorkspace <> 0) Begin
76938>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
76939>>>>>                Send AppendTextLn ""
76940>>>>>            End
76940>>>>>>
76940>>>>>        End
76940>>>>>>
76940>>>>>    End_Procedure
76941>>>>>
76941>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
76943>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
76944>>>>>    End_Function
76945>>>>>
76945>>>>>    Procedure Show_Versions
76947>>>>>        Integer iVersion iRevision iBuild
76947>>>>>
76947>>>>>        Version_Information iVersion iRevision iBuild
76949>>>>>
76949>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
76950>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
76951>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
76952>>>>>    End_Procedure
76953>>>>>    
76953>>>>>    Function CKRevisionNumber String sDriverID Returns String
76955>>>>>        Handle hoCLIHandler
76955>>>>>        Handle hoDFBtrDrvHandler
76955>>>>>        String sCKRevision
76955>>>>>
76955>>>>>
76955>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
76957>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
76958>>>>>            Set psDriverID of hoCLIHandler to sDriverID
76959>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
76960>>>>>            Send Destroy of hoCLIHandler
76961>>>>>        End
76961>>>>>>
76961>>>>>        Else Begin
76962>>>>>            If (sDriverID = "DFBTRDRV") Begin
76964>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
76965>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
76966>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
76967>>>>>                Send Destroy of hoDFBtrDrvHandler
76968>>>>>            End
76968>>>>>>
76968>>>>>        End
76968>>>>>>
76968>>>>>        
76968>>>>>        Function_Return sCKRevision
76969>>>>>    End_Function
76970>>>>>    
76970>>>>>    
76970>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
76972>>>>>        
76972>>>>>        If (sDriverID = "DATAFLEX") Begin
76974>>>>>            Function_Return False
76975>>>>>        End
76975>>>>>>
76975>>>>>    
76975>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
76976>>>>>    End_Function    
76977>>>>>
76977>>>>>
76977>>>>>    //***
76977>>>>>    //*** BW
76977>>>>>    //*** Procedure: Show_Drivers
76977>>>>>    //*** Purpose  : Show loaded database drivers
76977>>>>>    //***
76977>>>>>
76977>>>>>    Procedure Show_Drivers
76979>>>>>        String sCurrentDriver sRevNumber
76979>>>>>        String sLoadedDrivers
76979>>>>>        Integer iNumberOfDrivers iCount
76979>>>>>        Boolean bOK
76979>>>>>
76979>>>>>        Move "" To sLoadedDrivers
76980>>>>>        Get_Attribute DF_NUMBER_DRIVERS To iNumberOfDrivers
76983>>>>>        For iCount From 1 To iNumberOfDrivers
76989>>>>>>
76989>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
76992>>>>>            If (sLoadedDrivers <> "") Begin
76994>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
76995>>>>>            End
76995>>>>>>
76995>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
76996>>>>>            If (bOK) Begin
76998>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
76999>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
77000>>>>>            End
77000>>>>>>
77000>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) To sLoadedDrivers
77001>>>>>        Loop
77002>>>>>>
77002>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
77003>>>>>    End_Procedure
77004>>>>>
77004>>>>>    Procedure Show_HelpFile
77006>>>>>        String sHelpFile
77006>>>>>        Integer eHelpType
77006>>>>>
77006>>>>>        If (ghoApplication <> 0) Begin
77008>>>>>            Get peHelpType Of ghoApplication To eHelpType
77009>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
77011>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
77012>>>>>            End
77012>>>>>>
77012>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
77015>>>>>                Get Help_filename Of Help_object_id To sHelpFile
77016>>>>>            End
77016>>>>>>
77016>>>>>            Else Begin
77017>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
77018>>>>>            End
77018>>>>>>
77018>>>>>
77018>>>>>            Send AppendTextLn ""
77019>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
77020>>>>>        End
77020>>>>>>
77020>>>>>    End_Procedure
77021>>>>>
77021>>>>>    Procedure Show_EnterAsTab
77023>>>>>        Boolean bEnterKeyAsTabKey
77023>>>>>        String sText
77023>>>>>
77023>>>>>        If (ghoApplication <> 0) Begin
77025>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
77026>>>>>            If (bEnterKeyAsTabKey) Begin
77028>>>>>                Move "True" To sText
77029>>>>>            End
77029>>>>>>
77029>>>>>            Else Begin
77030>>>>>                Move "False" To sText
77031>>>>>            End
77031>>>>>>
77031>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
77032>>>>>        End
77032>>>>>>
77032>>>>>    End_Procedure
77033>>>>>
77033>>>>>    //****************************************************************************
77033>>>>>    // $Module type: PROCEDURE
77033>>>>>    // $Module name: Add_Focus
77033>>>>>    // $Author     : VOO
77033>>>>>    // Created     : 24-09-96 @ 19:43
77033>>>>>    //
77033>>>>>    // Description
77033>>>>>    //    During activation we will remove the old information and add the newly
77033>>>>>    //    found systeminformation
77033>>>>>    //
77033>>>>>    // $Rev History
77033>>>>>    //    24-09-96  Module header created
77033>>>>>    //****************************************************************************
77033>>>>>    Procedure Add_Focus Integer hoRoot
77035>>>>>        Forward Send Add_Focus hoRoot
77037>>>>>
77037>>>>>        Send Delete_Data
77038>>>>>
77038>>>>>        Set Changed_State To False
77039>>>>>        Set Read_Only_State To True
77040>>>>>
77040>>>>>        Send Show_ServicePack
77041>>>>>        Send Show_Versions   
77042>>>>>        Send Show_Drivers         
77043>>>>>        Send Show_HelpFile
77044>>>>>        Send Show_Current_Directory
77045>>>>>        Send Show_Filelist_Name          
77046>>>>>        If (ghoApplication <> 0) Begin
77048>>>>>            Send Show_WorkSpaceInformation // added To show WS info
77049>>>>>        End
77049>>>>>>
77049>>>>>        Send Show_Current_User 
77050>>>>>        Send Show_Windows_Directory 
77051>>>>>        Send Show_Screen_Size
77052>>>>>        Send Show_Page_Size
77053>>>>>        Send Show_EnterAsTab        
77054>>>>>        Send Show_Number_Format
77055>>>>>        Send Show_Date_Format
77056>>>>>        Send Show_Lock_Delay
77057>>>>>        Send Show_Lock_Timeout
77058>>>>>        Send Show_Date
77059>>>>>        Send Show_Systemresources
77060>>>>>        Send Show_Registration
77061>>>>>        Send Beginning_of_Data
77062>>>>>
77062>>>>>        Set Icon to 'default.ico'
77063>>>>>    End_Procedure
77064>>>>>End_Class
77065>>>>>
77065>>>>>//****************************************************************************
77065>>>>>// $Module type: OBJECT
77065>>>>>// $Module name: Sysinfo_Dialog
77065>>>>>// $Author     : VOO
77065>>>>>// Created     : 24-09-96 @ 18:47
77065>>>>>//
77065>>>>>// Description
77065>>>>>//    This object shows the systeminformation on the screen
77065>>>>>//
77065>>>>>// $Rev History
77065>>>>>//    24-09-96  Module header created
77065>>>>>//****************************************************************************
77065>>>>>Class SysInfoDialog Is A ModalPanel
77066>>>>>    Procedure Construct_Object
77068>>>>>        Forward Send Construct_Object
77070>>>>>
77070>>>>>        Set Label to C_$SystemInformation
77071>>>>>        Set Size to 140 267
77072>>>>>        Set piMinSize to 140 267
77073>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77074>>>>>        Set Border_Style to Border_Thick
77075>>>>>
77075>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
77077>>>>>            Set peAnchors to anAll
77078>>>>>        End_Object
77079>>>>>
77079>>>>>        Object oCloseButton Is A Button
77081>>>>>            Set Label To C_$Close
77082>>>>>            Set Location To 120 210
77083>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
77084>>>>>            Set Default_State To True
77085>>>>>            Set peAnchors to anBottomRight
77086>>>>>        End_Object
77087>>>>>
77087>>>>>        On_Key kCancel Send Close_Panel
77088>>>>>    End_Procedure
77089>>>>>End_Class
77090>>>>>
77090>>>>>// Purpose:
77090>>>>>//
77090>>>>>// Ken Ross 12/17/96 5:16PM
77090>>>>>//
77090>>>>>Class AboutDialog Is A ModalPanel
77091>>>>>    Procedure Construct_Object
77093>>>>>        String sVdfRootDir
77093>>>>>
77093>>>>>        Forward Send Construct_Object
77095>>>>>
77095>>>>>        Set Label To C_$About
77096>>>>>        Set Size to 89 212
77097>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77098>>>>>
77098>>>>>        Object oSysInfoDialog Is A SysInfoDialog
77100>>>>>        End_Object
77101>>>>>
77101>>>>>        Object oBox Is A Container3d
77103>>>>>            Set Border_Style To Border_StaticEdge
77104>>>>>            Set Size to 63 202
77105>>>>>            Set Location To 4 5
77106>>>>>
77106>>>>>            Object oAboutGraphic Is A BitmapContainer
77108>>>>>                Set Border_Style To Border_None
77109>>>>>                Set Bitmap_Style To Bitmap_Center
77110>>>>>                Set Size To 48 48
77111>>>>>                Set Location To 7 2
77112>>>>>            End_Object
77113>>>>>
77113>>>>>            Object oProductName Is A TextBox
77115>>>>>                Set Label To C_$ProductName
77116>>>>>                Set Size To 10 45
77117>>>>>                Set Location To 8 53
77118>>>>>            End_Object
77119>>>>>
77119>>>>>            Object oVersion Is A TextBox
77121>>>>>                Set Label To C_$Version
77122>>>>>                Set Size To 10 25
77123>>>>>                Set Location To 21 53
77124>>>>>            End_Object
77125>>>>>
77125>>>>>            Object oCopyright Is A TextBox
77127>>>>>                Set Label To C_$Copyright
77128>>>>>                Set Size To 10 31
77129>>>>>                Set Location To 34 53
77130>>>>>            End_Object
77131>>>>>
77131>>>>>            Object oAuthor Is A TextBox
77133>>>>>                Set Label To C_$Author
77134>>>>>                Set Size To 10 22
77135>>>>>                Set Location To 46 53
77136>>>>>            End_Object
77137>>>>>        End_Object
77138>>>>>
77138>>>>>        Object oOKButton Is A Button
77140>>>>>            On_Item C_$OK Send Close_Panel
77141>>>>>            Set Size To 14 50
77142>>>>>            Set Location To 71 157
77143>>>>>        End_Object
77144>>>>>
77144>>>>>        Object oSysInfoButton Is A Button
77146>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
77147>>>>>            Set Size To 14 50
77148>>>>>            Set Location To 71 101
77149>>>>>        End_Object
77150>>>>>
77150>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
77151>>>>>
77151>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
77152>>>>>    End_Procedure
77153>>>>>
77153>>>>>    Procedure Set ProductName String sProductName
77155>>>>>        Set Label Of oProductName To sProductName
77156>>>>>    End_Procedure
77157>>>>>
77157>>>>>    Procedure Set Version String sVersion
77159>>>>>        Set Label Of oVersion To sVersion
77160>>>>>    End_Procedure
77161>>>>>
77161>>>>>    Procedure Set Copyright string sCopyright
77163>>>>>        Set Label Of oCopyright To sCopyright
77164>>>>>    End_Procedure
77165>>>>>
77165>>>>>    Procedure Set Author String sAuthor
77167>>>>>        Set Label Of oAuthor To sAuthor
77168>>>>>    End_Procedure
77169>>>>>
77169>>>>>    Procedure Set Logo string sLogo
77171>>>>>        // square bitmaps Of 42x42 work best
77171>>>>>        Set Bitmap Of oAboutGraphic To sLogo
77172>>>>>    End_Procedure
77173>>>>>
77173>>>>>    Procedure Show_Sysinfo
77175>>>>>        Send Popup_Modal Of oSysinfoDialog
77176>>>>>    End_Procedure
77177>>>>>
77177>>>>>    Procedure End_Construct_Object
77179>>>>>        Handle hoVersionInfo
77179>>>>>        Boolean bIncluded
77179>>>>>        Integer iMajor iMinor iRelease iBuild
77179>>>>>        String sLabel
77179>>>>>
77179>>>>>        Get Label Of oVersion To sLabel
77180>>>>>        If (sLabel = C_$VERSION) Begin
77182>>>>>            // set it To the version info Of the program, if available
77182>>>>>            If (ghoApplication <> 0) Begin
77184>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
77185>>>>>                If (hoVersionInfo <> 0) Begin
77187>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
77188>>>>>                    If (bIncluded) Begin
77190>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
77191>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
77192>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
77193>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
77194>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
77195>>>>>                        Set Version to sLabel
77196>>>>>                    End
77196>>>>>>
77196>>>>>                End
77196>>>>>>
77196>>>>>            End
77196>>>>>>
77196>>>>>        End
77196>>>>>>
77196>>>>>
77196>>>>>        Forward Send End_Construct_Object
77198>>>>>    End_Procedure
77199>>>>>End_Class
77200>>>
77200>>>// *************************************************************************
77200>>>//  Public message. This is the default message. It is expected that you will
77200>>>//   create your own message to override this
77200>>>// *************************************************************************
77200>>>
77200>>>Procedure Activate_About
77203>>>   Send DoAbout "" "" "" "" ""
77204>>>End_Procedure
77205>>>
77205>>>// *************************************************************************
77205>>>//  Public message. It is expected that you will send this message (most
77205>>>//  likely from Activate_About. This creates an about object, activates it
77205>>>//  and destroys it when done. It is not exepected that you will augment this.
77205>>>// *************************************************************************
77205>>>
77205>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
77208>>>        integer hoObj hoMain
77208>>>
77208>>>        // create object
77208>>>        Object About is an AboutDialog
77210>>>            // if no title passed use the label of the main panel
77210>>>            // (if a main panel exists).
77210>>>            if sTitle     eq '' Begin
77212>>>                Get Main_Window of desktop to hoMain
77213>>>                if hoMain Get Label of hoMain to sTitle
77216>>>            end
77216>>>>
77216>>>            set productname to sTitle
77217>>>            set version     to sVersion
77218>>>            set copyright   to sCopyRight
77219>>>            set author      to sAuthor
77220>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
77223>>>            Move self to hoObj // object Id
77224>>>        End_Object
77225>>>        Send Popup   of hoObj    // popup the about object
77226>>>        Send Destroy of hoObj // when done, it will be destroyed
77227>>>End_procedure
77228>        Use EMPLEADOS.vw
Including file: EMPLEADOS.vw    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\EMPLEADOS.vw)
77228>>>// C:\DataFlex Projects\JUEVESAPPMARCAJES\AppSrc\EMPLEADOS.vw
77228>>>// EMPLEADOS
77228>>>//
77228>>>
77228>>>Use DFClient.pkg
77228>>>Use DFEntry.pkg
77228>>>
77228>>>Use cNacionalidadDataDictionary.dd
Including file: cNacionalidadDataDictionary.dd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\cNacionalidadDataDictionary.dd)
77228>>>>>Use DataDict.pkg
77228>>>>>
77228>>>>>Open Nacionalidad
Including file: Nacionalidad.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\Nacionalidad.fd)
77230>>>>>Open sysemFile
Including file: sysemFile.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\sysemFile.fd)
77232>>>>>Open EmpleadoTable
Including file: EmpleadoTable.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\EmpleadoTable.fd)
77234>>>>>
77234>>>>>Register_Object Nacionalidad_sl
77234>>>>>
77234>>>>>Class cNacionalidadDataDictionary is a DataDictionary
77235>>>>>    
77235>>>>>    Procedure Construct_Object
77237>>>>>        Forward Send Construct_Object
77239>>>>>        Set Main_File to Nacionalidad.File_Number
77240>>>>>
77240>>>>>        Set Add_Client_File to EmpleadoTable.File_Number
77241>>>>>
77241>>>>>        Set Add_System_File to sysemFile.File_Number DD_Lock_On_All
77242>>>>>
77242>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77243>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77244>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77245>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77246>>>>>
77246>>>>>        Set Field_Option Field Nacionalidad.CodigoNacionalidad DD_CAPSLOCK to True
77247>>>>>        Set Key_Field_State Field Nacionalidad.CodigoNacionalidad to True
77248>>>>>        Set Field_Auto_Increment Field Nacionalidad.CodigoNacionalidad to File_Field sysemFile.CodigoNacionalidad
77249>>>>>        Set Field_Prompt_Object Field Nacionalidad.CodigoNacionalidad to Nacionalidad_sl
77250>>>>>
77250>>>>>        Set Field_Option Field Nacionalidad.Pais DD_CAPSLOCK to True
77251>>>>>
77251>>>>>    End_Procedure
77252>>>>>
77252>>>>>End_Class
77253>>>>>
77253>>>>>Use Nacionalidad.sl
Including file: Nacionalidad.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\Nacionalidad.sl)
77253>>>>>>>// Nacionalidad.sl
77253>>>>>>>// Nacionalidad Lookup List
77253>>>>>>>
77253>>>>>>>Use DFClient.pkg
77253>>>>>>>Use cDbCJGridPromptList.pkg
77253>>>>>>>Use cDbCJGridColumn.pkg
77253>>>>>>>Use Windows.pkg
77253>>>>>>>
77253>>>>>>>Use cNacionalidadDataDictionary.dd
77253>>>>>>>
77253>>>>>>>CD_Popup_Object Nacionalidad_sl is a dbModalPanel
77271>>>>>>>>
77271>>>>>>>    Set Location to 5 5
77272>>>>>>>    Set Size to 134 260
77273>>>>>>>    Set Label To "Nacionalidad Lookup List"
77274>>>>>>>    Set Border_Style to Border_Thick
77275>>>>>>>    Set Minimize_Icon to False
77276>>>>>>>
77276>>>>>>>
77276>>>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77278>>>>>>>    End_Object 
77279>>>>>>>
77279>>>>>>>    Set Main_DD To oNacionalidad_DD
77280>>>>>>>    Set Server  To oNacionalidad_DD
77281>>>>>>>
77281>>>>>>>
77281>>>>>>>
77281>>>>>>>    Object oSelList is a cDbCJGridPromptList
77283>>>>>>>        Set Size to 105 250
77284>>>>>>>        Set Location to 5 5
77285>>>>>>>        Set peAnchors to anAll
77286>>>>>>>        Set psLayoutSection to "Nacionalidad_sl_oSelList"
77287>>>>>>>        Set Ordering to 1
77288>>>>>>>        Set pbAutoServer to True
77289>>>>>>>
77289>>>>>>>        Object oNacionalidad_CodigoNacionalidad is a cDbCJGridColumn
77291>>>>>>>            Entry_Item Nacionalidad.CodigoNacionalidad
77292>>>>>>>            Set piWidth to 157
77293>>>>>>>            Set psCaption to "Codigo"
77294>>>>>>>        End_Object 
77295>>>>>>>
77295>>>>>>>        Object oNacionalidad_Pais is a cDbCJGridColumn
77297>>>>>>>            Entry_Item Nacionalidad.Pais
77298>>>>>>>            Set piWidth to 262
77299>>>>>>>            Set psCaption to "Pais"
77300>>>>>>>        End_Object 
77301>>>>>>>
77301>>>>>>>
77301>>>>>>>    End_Object 
77302>>>>>>>
77302>>>>>>>    Object oOk_bn is a Button
77304>>>>>>>        Set Label to "&Ok"
77305>>>>>>>        Set Location to 115 97
77306>>>>>>>        Set peAnchors to anBottomRight
77307>>>>>>>
77307>>>>>>>        Procedure OnClick
77310>>>>>>>            Send OK of oSelList
77311>>>>>>>        End_Procedure
77312>>>>>>>
77312>>>>>>>    End_Object 
77313>>>>>>>
77313>>>>>>>    Object oCancel_bn is a Button
77315>>>>>>>        Set Label to "&Cancel"
77316>>>>>>>        Set Location to 115 151
77317>>>>>>>        Set peAnchors to anBottomRight
77318>>>>>>>
77318>>>>>>>        Procedure OnClick
77321>>>>>>>            Send Cancel of oSelList
77322>>>>>>>        End_Procedure
77323>>>>>>>
77323>>>>>>>    End_Object 
77324>>>>>>>
77324>>>>>>>    Object oSearch_bn is a Button
77326>>>>>>>        Set Label to "&Search..."
77327>>>>>>>        Set Location to 115 205
77328>>>>>>>        Set peAnchors to anBottomRight
77329>>>>>>>
77329>>>>>>>        Procedure OnClick
77332>>>>>>>            Send Search of oSelList
77333>>>>>>>        End_Procedure
77334>>>>>>>
77334>>>>>>>    End_Object 
77335>>>>>>>
77335>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77336>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77337>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77338>>>>>>>
77338>>>>>>>
77338>>>>>>>CD_End_Object // Nacionalidad_sl
77340>>>>>>>>
77340>>>Use cEmpleadoTableDataDictionary.dd
Including file: cEmpleadoTableDataDictionary.dd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\cEmpleadoTableDataDictionary.dd)
77340>>>>>Use DataDict.pkg
77340>>>>>
77340>>>>>Open EmpleadoTable
77342>>>>>Open Nacionalidad
77344>>>>>Open sysemFile
77346>>>>>Open MarcajeTable
Including file: MarcajeTable.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\MarcajeTable.fd)
77348>>>>>
77348>>>>>Register_Object EmpleadoTable_sl
77348>>>>>Register_Object Nacionalidad_sl
77348>>>>>
77348>>>>>Class cEmpleadoTableDataDictionary is a DataDictionary
77349>>>>>    
77349>>>>>    Procedure Construct_Object
77351>>>>>        Forward Send Construct_Object
77353>>>>>        Set Main_File to EmpleadoTable.File_Number
77354>>>>>
77354>>>>>        Set Add_Client_File to MarcajeTable.File_Number
77355>>>>>
77355>>>>>        Set Add_System_File to sysemFile.File_Number DD_Lock_On_All
77356>>>>>
77356>>>>>        Set Add_Server_File to Nacionalidad.File_Number
77357>>>>>
77357>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77358>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77359>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77360>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77361>>>>>
77361>>>>>        Set Key_Field_State Field EmpleadoTable.Codigo to True
77362>>>>>        Set Field_Auto_Increment Field EmpleadoTable.Codigo to File_Field sysemFile.CodigoEmpleado
77363>>>>>        Set Field_Prompt_Object Field EmpleadoTable.Codigo to EmpleadoTable_sl
77364>>>>>
77364>>>>>        Set Field_Option Field EmpleadoTable.PrimerNombre DD_CAPSLOCK to True
77365>>>>>        Set Field_Option Field EmpleadoTable.PrimerNombre DD_REQUIRED to True
77366>>>>>
77366>>>>>        Set Field_Option Field EmpleadoTable.SegundoNombre DD_CAPSLOCK to True
77367>>>>>        Set Field_Option Field EmpleadoTable.SegundoNombre DD_REQUIRED to True
77368>>>>>
77368>>>>>        Set Field_Option Field EmpleadoTable.PrimerApellido DD_CAPSLOCK to True
77369>>>>>        Set Field_Option Field EmpleadoTable.PrimerApellido DD_REQUIRED to True
77370>>>>>
77370>>>>>        Set Field_Option Field EmpleadoTable.SegundoApellido DD_CAPSLOCK to True
77371>>>>>        Set Field_Option Field EmpleadoTable.SegundoApellido DD_REQUIRED to True
77372>>>>>        Set Field_Option Field EmpleadoTable.Nacionalidad DD_CAPSLOCK to True
77373>>>>>        Set Field_Prompt_Object Field EmpleadoTable.Nacionalidad to Nacionalidad_sl
77374>>>>>        Set Field_Option Field EmpleadoTable.Nacionalidad DD_REQUIRED to True
77375>>>>>
77375>>>>>    End_Procedure
77376>>>>>
77376>>>>>End_Class
77377>>>>>
77377>>>>>Use Nacionalidad.sl
77377>>>>>Use EmpleadoTable.sl
Including file: EmpleadoTable.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\EmpleadoTable.sl)
77377>>>>>>>// EmpleadoTable.sl
77377>>>>>>>// EmpleadoTable Lookup List
77377>>>>>>>
77377>>>>>>>Use DFClient.pkg
77377>>>>>>>Use cDbCJGridPromptList.pkg
77377>>>>>>>Use cDbCJGridColumn.pkg
77377>>>>>>>Use Windows.pkg
77377>>>>>>>
77377>>>>>>>Use cNacionalidadDataDictionary.dd
77377>>>>>>>Use cEmpleadoTableDataDictionary.dd
77377>>>>>>>
77377>>>>>>>CD_Popup_Object EmpleadoTable_sl is a dbModalPanel
77395>>>>>>>>
77395>>>>>>>    Set Location to 5 5
77396>>>>>>>    Set Size to 134 610
77397>>>>>>>    Set Label To "EmpleadoTable Lookup List"
77398>>>>>>>    Set Border_Style to Border_Thick
77399>>>>>>>    Set Minimize_Icon to False
77400>>>>>>>
77400>>>>>>>
77400>>>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77402>>>>>>>    End_Object 
77403>>>>>>>
77403>>>>>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
77405>>>>>>>        Set DDO_Server To oNacionalidad_DD
77406>>>>>>>    End_Object 
77407>>>>>>>
77407>>>>>>>    Set Main_DD To oEmpleadoTable_DD
77408>>>>>>>    Set Server  To oEmpleadoTable_DD
77409>>>>>>>
77409>>>>>>>
77409>>>>>>>
77409>>>>>>>    Object oSelList is a cDbCJGridPromptList
77411>>>>>>>        Set Size to 105 600
77412>>>>>>>        Set Location to 5 5
77413>>>>>>>        Set peAnchors to anAll
77414>>>>>>>        Set psLayoutSection to "EmpleadoTable_sl_oSelList"
77415>>>>>>>        Set Ordering to 1
77416>>>>>>>        Set pbAutoServer to True
77417>>>>>>>
77417>>>>>>>        Object oEmpleadoTable_Codigo is a cDbCJGridColumn
77419>>>>>>>            Entry_Item EmpleadoTable.Codigo
77420>>>>>>>            Set piWidth to 105
77421>>>>>>>            Set psCaption to "Codigo"
77422>>>>>>>        End_Object 
77423>>>>>>>
77423>>>>>>>        Object oEmpleadoTable_PrimerNombre is a cDbCJGridColumn
77425>>>>>>>            Entry_Item EmpleadoTable.PrimerNombre
77426>>>>>>>            Set piWidth to 262
77427>>>>>>>            Set psCaption to "Primer Nombre"
77428>>>>>>>        End_Object 
77429>>>>>>>
77429>>>>>>>        Object oEmpleadoTable_SegundoNombre is a cDbCJGridColumn
77431>>>>>>>            Entry_Item EmpleadoTable.SegundoNombre
77432>>>>>>>            Set piWidth to 262
77433>>>>>>>            Set psCaption to "Segundo Nombre"
77434>>>>>>>        End_Object 
77435>>>>>>>
77435>>>>>>>        Object oEmpleadoTable_PrimerApellido is a cDbCJGridColumn
77437>>>>>>>            Entry_Item EmpleadoTable.PrimerApellido
77438>>>>>>>            Set piWidth to 262
77439>>>>>>>            Set psCaption to "Primer Apellido"
77440>>>>>>>        End_Object 
77441>>>>>>>
77441>>>>>>>        Object oEmpleadoTable_SegundoApellido is a cDbCJGridColumn
77443>>>>>>>            Entry_Item EmpleadoTable.SegundoApellido
77444>>>>>>>            Set piWidth to 262
77445>>>>>>>            Set psCaption to "Segundo Apellido"
77446>>>>>>>        End_Object 
77447>>>>>>>
77447>>>>>>>        Object oNacionalidad_CodigoNacionalidad is a cDbCJGridColumn
77449>>>>>>>            Entry_Item Nacionalidad.CodigoNacionalidad
77450>>>>>>>            Set piWidth to 157
77451>>>>>>>            Set psCaption to "Nacionalidad"
77452>>>>>>>        End_Object 
77453>>>>>>>
77453>>>>>>>
77453>>>>>>>    End_Object 
77454>>>>>>>
77454>>>>>>>    Object oOk_bn is a Button
77456>>>>>>>        Set Label to "&Ok"
77457>>>>>>>        Set Location to 115 447
77458>>>>>>>        Set peAnchors to anBottomRight
77459>>>>>>>
77459>>>>>>>        Procedure OnClick
77462>>>>>>>            Send OK of oSelList
77463>>>>>>>        End_Procedure
77464>>>>>>>
77464>>>>>>>    End_Object 
77465>>>>>>>
77465>>>>>>>    Object oCancel_bn is a Button
77467>>>>>>>        Set Label to "&Cancel"
77468>>>>>>>        Set Location to 115 501
77469>>>>>>>        Set peAnchors to anBottomRight
77470>>>>>>>
77470>>>>>>>        Procedure OnClick
77473>>>>>>>            Send Cancel of oSelList
77474>>>>>>>        End_Procedure
77475>>>>>>>
77475>>>>>>>    End_Object 
77476>>>>>>>
77476>>>>>>>    Object oSearch_bn is a Button
77478>>>>>>>        Set Label to "&Search..."
77479>>>>>>>        Set Location to 115 555
77480>>>>>>>        Set peAnchors to anBottomRight
77481>>>>>>>
77481>>>>>>>        Procedure OnClick
77484>>>>>>>            Send Search of oSelList
77485>>>>>>>        End_Procedure
77486>>>>>>>
77486>>>>>>>    End_Object 
77487>>>>>>>
77487>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77488>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77489>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77490>>>>>>>
77490>>>>>>>
77490>>>>>>>CD_End_Object // EmpleadoTable_sl
77492>>>>>>>>
77492>>>
77492>>>ACTIVATE_VIEW Activate_EMPLEADOS FOR EMPLEADOS
77502>>>>
77502>>>Object EMPLEADOS is a dbView
77504>>>    Set Location to 5 5
77505>>>    Set Size to 168 512
77506>>>    Set Label To "EMPLEADOS"
77507>>>    Set Border_Style to Border_Thick
77508>>>
77508>>>
77508>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77510>>>    End_Object 
77511>>>
77511>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
77513>>>        Set DDO_Server To oNacionalidad_DD
77514>>>    End_Object 
77515>>>
77515>>>    Set Main_DD To oEmpleadoTable_DD
77516>>>    Set Server  To oEmpleadoTable_DD
77517>>>
77517>>>
77517>>>
77517>>>    Object oEmpleadoTableCodigo is a dbForm
77519>>>        Entry_Item EmpleadoTable.Codigo
77520>>>        Set Size to 13 262
77521>>>        Set Location to 5 61
77522>>>        Set peAnchors to anTopLeftRight
77523>>>        Set Label to "Codigo"
77524>>>        Set Label_Justification_mode to jMode_Left
77525>>>        Set Label_Col_Offset to 56
77526>>>        Set Label_row_Offset to 0
77527>>>    End_Object 
77528>>>
77528>>>    Object oEmpleadoTablePrimerNombre is a dbForm
77530>>>        Entry_Item EmpleadoTable.PrimerNombre
77531>>>        Set Size to 13 446
77532>>>        Set Location to 20 61
77533>>>        Set peAnchors to anTopLeftRight
77534>>>        Set Label to "Primer Nombre"
77535>>>        Set Label_Justification_mode to jMode_Left
77536>>>        Set Label_Col_Offset to 56
77537>>>        Set Label_row_Offset to 0
77538>>>    End_Object 
77539>>>
77539>>>    Object oEmpleadoTableSegundoNombre is a dbForm
77541>>>        Entry_Item EmpleadoTable.SegundoNombre
77542>>>        Set Size to 13 446
77543>>>        Set Location to 35 61
77544>>>        Set peAnchors to anTopLeftRight
77545>>>        Set Label to "Segundo Nombre"
77546>>>        Set Label_Justification_mode to jMode_Left
77547>>>        Set Label_Col_Offset to 56
77548>>>        Set Label_row_Offset to 0
77549>>>    End_Object 
77550>>>
77550>>>    Object oEmpleadoTablePrimerApellido is a dbForm
77552>>>        Entry_Item EmpleadoTable.PrimerApellido
77553>>>        Set Size to 13 446
77554>>>        Set Location to 50 61
77555>>>        Set peAnchors to anTopLeftRight
77556>>>        Set Label to "Primer Apellido"
77557>>>        Set Label_Justification_mode to jMode_Left
77558>>>        Set Label_Col_Offset to 56
77559>>>        Set Label_row_Offset to 0
77560>>>    End_Object 
77561>>>
77561>>>    Object oEmpleadoTableSegundoApellido is a dbForm
77563>>>        Entry_Item EmpleadoTable.SegundoApellido
77564>>>        Set Size to 13 446
77565>>>        Set Location to 65 61
77566>>>        Set peAnchors to anTopLeftRight
77567>>>        Set Label to "Segundo Apellido"
77568>>>        Set Label_Justification_mode to jMode_Left
77569>>>        Set Label_Col_Offset to 56
77570>>>        Set Label_row_Offset to 0
77571>>>    End_Object 
77572>>>
77572>>>    Object oNacionalidadCodigoNacionalidad is a dbForm
77574>>>        Entry_Item Nacionalidad.CodigoNacionalidad
77575>>>        Set Size to 13 292
77576>>>        Set Location to 80 61
77577>>>        Set peAnchors to anTopLeftRight
77578>>>        Set Label to "Nacionalidad"
77579>>>        Set Label_Justification_mode to jMode_Left
77580>>>        Set Label_Col_Offset to 56
77581>>>        Set Label_row_Offset to 0
77582>>>    End_Object 
77583>>>
77583>>>
77583>>>End_Object 
77584>        Use MARCAJES.vw
Including file: MARCAJES.vw    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\MARCAJES.vw)
77584>>>// C:\DataFlex Projects\JUEVESAPPMARCAJES\AppSrc\MARCAJES.vw
77584>>>// MARCAJES
77584>>>//
77584>>>
77584>>>Use DFClient.pkg
77584>>>Use DFEntry.pkg
77584>>>
77584>>>Use cNacionalidadDataDictionary.dd
77584>>>Use cEmpleadoTableDataDictionary.dd
77584>>>Use cTipoMarcajeTableDataDictionary.dd
Including file: cTipoMarcajeTableDataDictionary.dd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\cTipoMarcajeTableDataDictionary.dd)
77584>>>>>Use DataDict.pkg
77584>>>>>
77584>>>>>Open TipoMarcajeTable
Including file: TipoMarcajeTable.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\TipoMarcajeTable.fd)
77586>>>>>Open sysemFile
77588>>>>>Open MarcajeTable
77590>>>>>
77590>>>>>Register_Object TipoMarcajeTable_sl
77590>>>>>
77590>>>>>Class cTipoMarcajeTableDataDictionary is a DataDictionary
77591>>>>>    
77591>>>>>    Procedure Construct_Object
77593>>>>>        Forward Send Construct_Object
77595>>>>>        Set Main_File to TipoMarcajeTable.File_Number
77596>>>>>
77596>>>>>        Set Add_Client_File to MarcajeTable.File_Number
77597>>>>>
77597>>>>>        Set Add_System_File to sysemFile.File_Number DD_Lock_On_All
77598>>>>>
77598>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77599>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77600>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77601>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77602>>>>>
77602>>>>>        Set Key_Field_State Field TipoMarcajeTable.Codigo to True
77603>>>>>        Set Field_Auto_Increment Field TipoMarcajeTable.Codigo to File_Field sysemFile.CodigoTipoMarcaje
77604>>>>>        Set Field_Prompt_Object Field TipoMarcajeTable.Codigo to TipoMarcajeTable_sl
77605>>>>>
77605>>>>>    End_Procedure
77606>>>>>
77606>>>>>End_Class
77607>>>>>
77607>>>>>Use TipoMarcajeTable.sl
Including file: TipoMarcajeTable.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\TipoMarcajeTable.sl)
77607>>>>>>>// TipoMarcajeTable.sl
77607>>>>>>>// TipoMarcajeTable Lookup List
77607>>>>>>>
77607>>>>>>>Use DFClient.pkg
77607>>>>>>>Use cDbCJGridPromptList.pkg
77607>>>>>>>Use cDbCJGridColumn.pkg
77607>>>>>>>Use Windows.pkg
77607>>>>>>>
77607>>>>>>>Use cTipoMarcajeTableDataDictionary.dd
77607>>>>>>>
77607>>>>>>>CD_Popup_Object TipoMarcajeTable_sl is a dbModalPanel
77625>>>>>>>>
77625>>>>>>>    Set Location to 5 5
77626>>>>>>>    Set Size to 134 200
77627>>>>>>>    Set Label To "TipoMarcajeTable Lookup List"
77628>>>>>>>    Set Border_Style to Border_Thick
77629>>>>>>>    Set Minimize_Icon to False
77630>>>>>>>
77630>>>>>>>
77630>>>>>>>    Object oTipoMarcajeTable_DD is a cTipoMarcajeTableDataDictionary
77632>>>>>>>    End_Object 
77633>>>>>>>
77633>>>>>>>    Set Main_DD To oTipoMarcajeTable_DD
77634>>>>>>>    Set Server  To oTipoMarcajeTable_DD
77635>>>>>>>
77635>>>>>>>
77635>>>>>>>
77635>>>>>>>    Object oSelList is a cDbCJGridPromptList
77637>>>>>>>        Set Size to 105 190
77638>>>>>>>        Set Location to 5 5
77639>>>>>>>        Set peAnchors to anAll
77640>>>>>>>        Set psLayoutSection to "TipoMarcajeTable_sl_oSelList"
77641>>>>>>>        Set Ordering to 1
77642>>>>>>>        Set pbAutoServer to True
77643>>>>>>>
77643>>>>>>>        Object oTipoMarcajeTable_Codigo is a cDbCJGridColumn
77645>>>>>>>            Entry_Item TipoMarcajeTable.Codigo
77646>>>>>>>            Set piWidth to 105
77647>>>>>>>            Set psCaption to "Codigo"
77648>>>>>>>        End_Object 
77649>>>>>>>
77649>>>>>>>        Object oTipoMarcajeTable_TipoMarcaje is a cDbCJGridColumn
77651>>>>>>>            Entry_Item TipoMarcajeTable.TipoMarcaje
77652>>>>>>>            Set piWidth to 210
77653>>>>>>>            Set psCaption to "Tipo Marcaje"
77654>>>>>>>        End_Object 
77655>>>>>>>
77655>>>>>>>
77655>>>>>>>    End_Object 
77656>>>>>>>
77656>>>>>>>    Object oOk_bn is a Button
77658>>>>>>>        Set Label to "&Ok"
77659>>>>>>>        Set Location to 115 37
77660>>>>>>>        Set peAnchors to anBottomRight
77661>>>>>>>
77661>>>>>>>        Procedure OnClick
77664>>>>>>>            Send OK of oSelList
77665>>>>>>>        End_Procedure
77666>>>>>>>
77666>>>>>>>    End_Object 
77667>>>>>>>
77667>>>>>>>    Object oCancel_bn is a Button
77669>>>>>>>        Set Label to "&Cancel"
77670>>>>>>>        Set Location to 115 91
77671>>>>>>>        Set peAnchors to anBottomRight
77672>>>>>>>
77672>>>>>>>        Procedure OnClick
77675>>>>>>>            Send Cancel of oSelList
77676>>>>>>>        End_Procedure
77677>>>>>>>
77677>>>>>>>    End_Object 
77678>>>>>>>
77678>>>>>>>    Object oSearch_bn is a Button
77680>>>>>>>        Set Label to "&Search..."
77681>>>>>>>        Set Location to 115 145
77682>>>>>>>        Set peAnchors to anBottomRight
77683>>>>>>>
77683>>>>>>>        Procedure OnClick
77686>>>>>>>            Send Search of oSelList
77687>>>>>>>        End_Procedure
77688>>>>>>>
77688>>>>>>>    End_Object 
77689>>>>>>>
77689>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77690>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77691>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77692>>>>>>>
77692>>>>>>>
77692>>>>>>>CD_End_Object // TipoMarcajeTable_sl
77694>>>>>>>>
77694>>>Use cMarcajeTableDataDictionary.dd
Including file: cMarcajeTableDataDictionary.dd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\cMarcajeTableDataDictionary.dd)
77694>>>>>Use DataDict.pkg
77694>>>>>
77694>>>>>Open MarcajeTable
77696>>>>>Open EmpleadoTable
77698>>>>>Open TipoMarcajeTable
77700>>>>>Open sysemFile
77702>>>>>
77702>>>>>Register_Object TipoMarcajeTable_sl
77702>>>>>Register_Object LISTAMARCAJESLS
77702>>>>>
77702>>>>>Class cMarcajeTableDataDictionary is a DataDictionary
77703>>>>>    
77703>>>>>    Procedure Construct_Object
77705>>>>>        Forward Send Construct_Object
77707>>>>>        Set Main_File to MarcajeTable.File_Number
77708>>>>>
77708>>>>>        Set Add_System_File to sysemFile.File_Number DD_Lock_On_All
77709>>>>>
77709>>>>>        Set Add_Server_File to EmpleadoTable.File_Number
77710>>>>>        Set Add_Server_File to TipoMarcajeTable.File_Number
77711>>>>>
77711>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77712>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77713>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77714>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77715>>>>>
77715>>>>>        Set Key_Field_State Field MarcajeTable.Codigo to True
77716>>>>>        Set Field_Auto_Increment Field MarcajeTable.Codigo to File_Field sysemFile.CodigoMarcaje
77717>>>>>        Set Field_Option Field MarcajeTable.Codigo DD_CAPSLOCK to True
77718>>>>>        Set Field_Prompt_Object Field MarcajeTable.Codigo to LISTAMARCAJESLS
77719>>>>>
77719>>>>>        Set Field_Option Field MarcajeTable.EmpleadoCodigo DD_REQUIRED to True
77720>>>>>
77720>>>>>        Set Field_Option Field MarcajeTable.FechaMarcaje DD_CAPSLOCK to True
77721>>>>>        Set Field_Option Field MarcajeTable.FechaMarcaje DD_REQUIRED to True
77722>>>>>
77722>>>>>        Set Field_Option Field MarcajeTable.HoraMarcaje DD_CAPSLOCK to True
77723>>>>>        Set Field_Option Field MarcajeTable.HoraMarcaje DD_REQUIRED to True
77724>>>>>
77724>>>>>        Set Field_Prompt_Object Field MarcajeTable.TipoMarcaje to TipoMarcajeTable_sl
77725>>>>>        Set Field_Option Field MarcajeTable.TipoMarcaje DD_REQUIRED to True
77726>>>>>
77726>>>>>    End_Procedure
77727>>>>>
77727>>>>>End_Class
77728>>>>>
77728>>>>>Use LISTAMARCAJESLS.sl
Including file: LISTAMARCAJESLS.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\LISTAMARCAJESLS.sl)
77728>>>>>>>// LISTAMARCAJESLS.sl
77728>>>>>>>// MarcajeTable Lookup List
77728>>>>>>>
77728>>>>>>>Use DFClient.pkg
77728>>>>>>>Use cDbCJGridPromptList.pkg
77728>>>>>>>Use cDbCJGridColumn.pkg
77728>>>>>>>Use Windows.pkg
77728>>>>>>>
77728>>>>>>>Use cNacionalidadDataDictionary.dd
77728>>>>>>>Use cEmpleadoTableDataDictionary.dd
77728>>>>>>>Use cTipoMarcajeTableDataDictionary.dd
77728>>>>>>>Use cMarcajeTableDataDictionary.dd
77728>>>>>>>
77728>>>>>>>CD_Popup_Object LISTAMARCAJESLS is a dbModalPanel
77746>>>>>>>>
77746>>>>>>>    Set Location to 5 5
77747>>>>>>>    Set Size to 134 246
77748>>>>>>>    Set Label To "MarcajeTable Lookup List"
77749>>>>>>>    Set Border_Style to Border_Thick
77750>>>>>>>    Set Minimize_Icon to False
77751>>>>>>>
77751>>>>>>>
77751>>>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77753>>>>>>>    End_Object 
77754>>>>>>>
77754>>>>>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
77756>>>>>>>        Set DDO_Server To oNacionalidad_DD
77757>>>>>>>    End_Object 
77758>>>>>>>
77758>>>>>>>    Object oTipoMarcajeTable_DD is a cTipoMarcajeTableDataDictionary
77760>>>>>>>    End_Object 
77761>>>>>>>
77761>>>>>>>    Object oMarcajeTable_DD is a cMarcajeTableDataDictionary
77763>>>>>>>        Set DDO_Server To oEmpleadoTable_DD
77764>>>>>>>        Set DDO_Server To oTipoMarcajeTable_DD
77765>>>>>>>    End_Object 
77766>>>>>>>
77766>>>>>>>    Set Main_DD To oMarcajeTable_DD
77767>>>>>>>    Set Server  To oMarcajeTable_DD
77768>>>>>>>
77768>>>>>>>
77768>>>>>>>
77768>>>>>>>    Object oSelList is a cDbCJGridPromptList
77770>>>>>>>        Set Size to 105 236
77771>>>>>>>        Set Location to 5 5
77772>>>>>>>        Set peAnchors to anAll
77773>>>>>>>        Set psLayoutSection to "LISTAMARCAJESLS_oSelList"
77774>>>>>>>        Set Ordering to 1
77775>>>>>>>        Set pbAutoServer to True
77776>>>>>>>
77776>>>>>>>        Object oMarcajeTable_Codigo is a cDbCJGridColumn
77778>>>>>>>            Entry_Item MarcajeTable.Codigo
77779>>>>>>>            Set piWidth to 90
77780>>>>>>>            Set psCaption to "Codigo"
77781>>>>>>>        End_Object
77782>>>>>>>
77782>>>>>>>        Object oMarcajeTable_EmpleadoCodigo is a cDbCJGridColumn
77784>>>>>>>            Entry_Item EmpleadoTable.Codigo
77785>>>>>>>            Set piWidth to 90
77786>>>>>>>            Set psCaption to "EmpleadoCodigo"
77787>>>>>>>        End_Object
77788>>>>>>>
77788>>>>>>>        Object oMarcajeTable_FechaMarcaje is a cDbCJGridColumn
77790>>>>>>>            Entry_Item MarcajeTable.FechaMarcaje
77791>>>>>>>            Set piWidth to 90
77792>>>>>>>            Set psCaption to "FechaMarcaje"
77793>>>>>>>        End_Object
77794>>>>>>>
77794>>>>>>>        Object oMarcajeTable_HoraMarcaje is a cDbCJGridColumn
77796>>>>>>>            Entry_Item MarcajeTable.HoraMarcaje
77797>>>>>>>            Set piWidth to 132
77798>>>>>>>            Set psCaption to "HoraMarcaje"
77799>>>>>>>        End_Object
77800>>>>>>>
77800>>>>>>>        Object oMarcajeTable_TipoMarcaje is a cDbCJGridColumn
77802>>>>>>>            Entry_Item TipoMarcajeTable.Codigo
77803>>>>>>>            Set piWidth to 90
77804>>>>>>>            Set psCaption to "TipoMarcaje"
77805>>>>>>>        End_Object
77806>>>>>>>
77806>>>>>>>
77806>>>>>>>    End_Object 
77807>>>>>>>
77807>>>>>>>    Object oOk_bn is a Button
77809>>>>>>>        Set Label to "&Ok"
77810>>>>>>>        Set Location to 115 83
77811>>>>>>>        Set peAnchors to anBottomRight
77812>>>>>>>
77812>>>>>>>        Procedure OnClick
77815>>>>>>>            Send OK of oSelList
77816>>>>>>>        End_Procedure
77817>>>>>>>
77817>>>>>>>    End_Object 
77818>>>>>>>
77818>>>>>>>    Object oCancel_bn is a Button
77820>>>>>>>        Set Label to "&Cancel"
77821>>>>>>>        Set Location to 115 137
77822>>>>>>>        Set peAnchors to anBottomRight
77823>>>>>>>
77823>>>>>>>        Procedure OnClick
77826>>>>>>>            Send Cancel of oSelList
77827>>>>>>>        End_Procedure
77828>>>>>>>
77828>>>>>>>    End_Object 
77829>>>>>>>
77829>>>>>>>    Object oSearch_bn is a Button
77831>>>>>>>        Set Label to "&Search..."
77832>>>>>>>        Set Location to 115 191
77833>>>>>>>        Set peAnchors to anBottomRight
77834>>>>>>>
77834>>>>>>>        Procedure OnClick
77837>>>>>>>            Send Search of oSelList
77838>>>>>>>        End_Procedure
77839>>>>>>>
77839>>>>>>>    End_Object 
77840>>>>>>>
77840>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77841>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77842>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77843>>>>>>>
77843>>>>>>>
77843>>>>>>>CD_End_Object // LISTAMARCAJESLS
77845>>>>>>>>
77845>>>>>Use TipoMarcajeTable.sl
77845>>>Use cDbCJGrid.pkg
77845>>>Use cdbCJGridColumn.pkg
77845>>>
77845>>>ACTIVATE_VIEW Activate_MARCAJES FOR MARCAJES
77855>>>>
77855>>>Object MARCAJES is a dbView
77857>>>    Set Location to 5 5
77858>>>    Set Size to 301 585
77859>>>    Set Label To "MARCAJES"
77860>>>    Set Border_Style to Border_Thick
77861>>>
77861>>>
77861>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77863>>>    End_Object 
77864>>>
77864>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
77866>>>        Set DDO_Server To oNacionalidad_DD
77867>>>    End_Object 
77868>>>
77868>>>    Object oTipoMarcajeTable_DD is a cTipoMarcajeTableDataDictionary
77870>>>    End_Object 
77871>>>
77871>>>    Object oMarcajeTable_DD is a cMarcajeTableDataDictionary
77873>>>        Set DDO_Server To oEmpleadoTable_DD
77874>>>        Set DDO_Server To oTipoMarcajeTable_DD
77875>>>    End_Object 
77876>>>
77876>>>    Set Main_DD To oMarcajeTable_DD
77877>>>    Set Server  To oMarcajeTable_DD
77878>>>
77878>>>    Object oDbCJGrid1 is a cDbCJGrid
77880>>>        Set Size to 262 526
77881>>>        Set Location to 22 23
77882>>>
77882>>>        Object oMarcajeTable_Codigo is a cDbCJGridColumn
77884>>>            Entry_Item MarcajeTable.Codigo
77885>>>            Set piWidth to 168
77886>>>            Set psCaption to "Codigo"
77887>>>        End_Object
77888>>>
77888>>>        Object oMarcajeTable_EmpleadoCodigo is a cDbCJGridColumn
77890>>>            Entry_Item EmpleadoTable.Codigo
77891>>>            Set piWidth to 168
77892>>>            Set psCaption to "Empleado Codigo"
77893>>>        End_Object
77894>>>
77894>>>        Object oMarcajeTable_FechaMarcaje is a cDbCJGridColumn
77896>>>            Entry_Item MarcajeTable.FechaMarcaje
77897>>>            Set piWidth to 168
77898>>>            Set psCaption to "Fecha Marcaje"
77899>>>        End_Object
77900>>>
77900>>>        Object oMarcajeTable_HoraMarcaje is a cDbCJGridColumn
77902>>>            Entry_Item MarcajeTable.HoraMarcaje
77903>>>            Set piWidth to 247
77904>>>            Set psCaption to "HoraMarcaje"
77905>>>        End_Object
77906>>>
77906>>>        Object oMarcajeTable_TipoMarcaje is a cDbCJGridColumn
77908>>>            Entry_Item TipoMarcajeTable.Codigo
77909>>>            Set piWidth to 169
77910>>>            Set psCaption to "Tipo Marcaje"
77911>>>        End_Object
77912>>>    End_Object
77913>>>
77913>>>
77913>>>End_Object 
77914>        Use R_Marcaje.rv
Including file: R_Marcaje.rv    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\R_Marcaje.rv)
77914>>>Use Windows.pkg
77914>>>Use DFRptVw.pkg
77914>>>Use DFRpt.pkg
77914>>>Use File_Dlg.Pkg
77914>>>Use dfEntry.pkg
77914>>>Use lista_empleado_sl.sl
Including file: lista_empleado_sl.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\lista_empleado_sl.sl)
77914>>>>>//**************************************************************
77914>>>>>// TableLookup.tpl for Windows application for Spanish 
77914>>>>>// translated by Moose Software (www.moose-software.com) 
77914>>>>>// 13/07/2010 Revised for VDF 16.0 by Moose Software
77914>>>>>// 05/02/2012 Revised for VDF 17.0 by Moose Software
77914>>>>>// 13/06/2013 Revised for VDF 17.1 by Moose Software
77914>>>>>// 02/05/2014 Revised for VDF 18.0 by Moose Software
77914>>>>>//*************************************************************
77914>>>>>
77914>>>>>Use Windows.pkg
77914>>>>>Use DFClient.pkg
77914>>>>>use DFSellst.pkg
77914>>>>>Use cNacionalidadDataDictionary.dd
77914>>>>>Use cEmpleadoTableDataDictionary.dd
77914>>>>>Use cTipoMarcajeTableDataDictionary.dd
77914>>>>>Use cMarcajeTableDataDictionary.dd
77914>>>>>
77914>>>>>Object oLista_empleado_sl is a dbModalPanel
77916>>>>>    Object oTipoMarcajeTable_DD is a cTipoMarcajeTableDataDictionary
77918>>>>>    End_Object
77919>>>>>
77919>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77921>>>>>    End_Object
77922>>>>>
77922>>>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
77924>>>>>        Set DDO_Server to oNacionalidad_DD
77925>>>>>    End_Object
77926>>>>>
77926>>>>>    Object oMarcajeTable_DD is a cMarcajeTableDataDictionary
77928>>>>>        Set DDO_Server to oTipoMarcajeTable_DD
77929>>>>>        Set DDO_Server to oEmpleadoTable_DD
77930>>>>>    End_Object
77931>>>>>
77931>>>>>    Set Main_DD to oMarcajeTable_DD
77932>>>>>    Set Server to oMarcajeTable_DD
77933>>>>>
77933>>>>>    Set Size to 133 292
77934>>>>>    Set Location     to 4 5
77935>>>>>    Set Border_Style to Border_Thick
77936>>>>>    Set Label to "lista_empleado_sl"
77937>>>>>
77937>>>>>    Object oSelList is a dbList
77939>>>>>        Set peAnchors to anAll
77940>>>>>        Set Size      to 105 280
77941>>>>>        Set Location  to 6 6
77942>>>>>
77942>>>>>        Begin_Row
77945>>>>>            Entry_Item MarcajeTable.Codigo
77946>>>>>            Entry_Item MarcajeTable.FechaMarcaje
77947>>>>>            Entry_Item MarcajeTable.HoraMarcaje
77948>>>>>            Entry_Item TipoMarcajeTable.Codigo
77949>>>>>        End_Row
77954>>>>>
77954>>>>>        Set Main_File to MarcajeTable.File_Number
77955>>>>>
77955>>>>>        Set Form_Width 0 to 60
77956>>>>>        Set Header_Label 0 to "Codigo"
77957>>>>>        Set Form_Width 1 to 60
77958>>>>>        Set Header_Label 1 to "FechaMarcaje"
77959>>>>>        Set Form_Width 2 to 88
77960>>>>>        Set Header_Label 2 to "HoraMarcaje"
77961>>>>>        Set Form_Width 3 to 60
77962>>>>>        Set Header_Label 3 to "TipoMarcaje"
77963>>>>>    End_Object
77964>>>>>
77964>>>>>    Object oOK_bn is a Button
77966>>>>>        Set Label     to "&Aceptar"
77967>>>>>        Set Location  to 115 128
77968>>>>>        Set peAnchors to anBottomRight
77969>>>>>
77969>>>>>        Procedure OnClick
77972>>>>>            Send Ok of oSelList
77973>>>>>        End_Procedure
77974>>>>>
77974>>>>>    End_Object
77975>>>>>
77975>>>>>    Object oCancel_bn is a Button
77977>>>>>        Set Label     to "&Cancelar"
77978>>>>>        Set Location  to 115 182
77979>>>>>        Set peAnchors to anBottomRight
77980>>>>>
77980>>>>>        Procedure OnClick
77983>>>>>            Send Cancel of oSelList
77984>>>>>        End_Procedure
77985>>>>>
77985>>>>>    End_Object
77986>>>>>
77986>>>>>    Object oSearch_bn is a Button
77988>>>>>        Set Label     to "&Buscar..."
77989>>>>>        Set Location  to 115 236
77990>>>>>        Set peAnchors to anBottomRight
77991>>>>>
77991>>>>>        Procedure OnClick
77994>>>>>            Send Search of oSelList
77995>>>>>        End_Procedure
77996>>>>>
77996>>>>>    End_Object
77997>>>>>
77997>>>>>    On_Key Key_Alt+Key_A Send KeyAction of oOk_bn
77998>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77999>>>>>    On_Key Key_Alt+Key_B Send KeyAction of oSearch_bn
78000>>>>>
78000>>>>>End_Object
78001>>>>>
78001>>>>>//*********************************************** end of TableLookup.tpl for Spanish ****************
78001>>>>>
78001>>>Use ListaNacionalidadesPromp.sl
Including file: ListaNacionalidadesPromp.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\ListaNacionalidadesPromp.sl)
78001>>>>>//**************************************************************
78001>>>>>// TableLookup.tpl for Windows application for Spanish 
78001>>>>>// translated by Moose Software (www.moose-software.com) 
78001>>>>>// 13/07/2010 Revised for VDF 16.0 by Moose Software
78001>>>>>// 05/02/2012 Revised for VDF 17.0 by Moose Software
78001>>>>>// 13/06/2013 Revised for VDF 17.1 by Moose Software
78001>>>>>// 02/05/2014 Revised for VDF 18.0 by Moose Software
78001>>>>>//*************************************************************
78001>>>>>
78001>>>>>Use Windows.pkg
78001>>>>>Use DFClient.pkg
78001>>>>>use DFSellst.pkg
78001>>>>>Use cNacionalidadDataDictionary.dd
78001>>>>>
78001>>>>>Object ListaNacionalidadesPromp is a dbModalPanel
78003>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
78005>>>>>    End_Object
78006>>>>>
78006>>>>>    Set Main_DD to oNacionalidad_DD
78007>>>>>    Set Server to oNacionalidad_DD
78008>>>>>
78008>>>>>    Set Size to 178 395
78009>>>>>    Set Location     to 4 5
78010>>>>>    Set Border_Style to Border_Thick
78011>>>>>    Set Label to "ListaNacionalidadesPromp"
78012>>>>>
78012>>>>>    Object oSelList is a dbList
78014>>>>>        Set peAnchors to anAll
78015>>>>>        Set Size to 150 383
78016>>>>>        Set Location  to 6 6
78017>>>>>
78017>>>>>        Begin_Row
78020>>>>>            Entry_Item Nacionalidad.CodigoNacionalidad
78021>>>>>            Entry_Item Nacionalidad.Pais
78022>>>>>        End_Row
78027>>>>>
78027>>>>>        Set Main_File to Nacionalidad.File_Number
78028>>>>>
78028>>>>>        Set Form_Width 0 to 76
78029>>>>>        Set Header_Label 0 to "Codigo"
78030>>>>>        Set Form_Width 1 to 400
78031>>>>>        Set Header_Label 1 to "Pais"
78032>>>>>    End_Object
78033>>>>>
78033>>>>>    Object oOK_bn is a Button
78035>>>>>        Set Label     to "&Aceptar"
78036>>>>>        Set Location to 160 231
78037>>>>>        Set peAnchors to anBottomRight
78038>>>>>
78038>>>>>        Procedure OnClick
78041>>>>>            Send Ok of oSelList
78042>>>>>        End_Procedure
78043>>>>>
78043>>>>>    End_Object
78044>>>>>
78044>>>>>    Object oCancel_bn is a Button
78046>>>>>        Set Label     to "&Cancelar"
78047>>>>>        Set Location to 160 285
78048>>>>>        Set peAnchors to anBottomRight
78049>>>>>
78049>>>>>        Procedure OnClick
78052>>>>>            Send Cancel of oSelList
78053>>>>>        End_Procedure
78054>>>>>
78054>>>>>    End_Object
78055>>>>>
78055>>>>>    Object oSearch_bn is a Button
78057>>>>>        Set Label     to "&Buscar..."
78058>>>>>        Set Location to 160 339
78059>>>>>        Set peAnchors to anBottomRight
78060>>>>>
78060>>>>>        Procedure OnClick
78063>>>>>            Send Search of oSelList
78064>>>>>        End_Procedure
78065>>>>>
78065>>>>>    End_Object
78066>>>>>
78066>>>>>    On_Key Key_Alt+Key_A Send KeyAction of oOk_bn
78067>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
78068>>>>>    On_Key Key_Alt+Key_B Send KeyAction of oSearch_bn
78069>>>>>
78069>>>>>End_Object
78070>>>>>
78070>>>>>//*********************************************** end of TableLookup.tpl for Spanish ****************
78070>>>>>
78070>>>Use EmpleadoLookUp.sl
Including file: EmpleadoLookUp.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\EmpleadoLookUp.sl)
78070>>>>>//**************************************************************
78070>>>>>// TableLookup.tpl for Windows application for Spanish 
78070>>>>>// translated by Moose Software (www.moose-software.com) 
78070>>>>>// 13/07/2010 Revised for VDF 16.0 by Moose Software
78070>>>>>// 05/02/2012 Revised for VDF 17.0 by Moose Software
78070>>>>>// 13/06/2013 Revised for VDF 17.1 by Moose Software
78070>>>>>// 02/05/2014 Revised for VDF 18.0 by Moose Software
78070>>>>>//*************************************************************
78070>>>>>
78070>>>>>Use Windows.pkg
78070>>>>>Use DFClient.pkg
78070>>>>>use DFSellst.pkg
78070>>>>>Use cNacionalidadDataDictionary.dd
78070>>>>>Use cEmpleadoTableDataDictionary.dd
78070>>>>>
78070>>>>>Object EmpleadoLookUp is a dbModalPanel
78072>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
78074>>>>>    End_Object
78075>>>>>
78075>>>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
78077>>>>>        Set DDO_Server to oNacionalidad_DD
78078>>>>>    End_Object
78079>>>>>
78079>>>>>    Set Main_DD to oEmpleadoTable_DD
78080>>>>>    Set Server to oEmpleadoTable_DD
78081>>>>>
78081>>>>>    Set Size to 177 513
78082>>>>>    Set Location     to 4 5
78083>>>>>    Set Border_Style to Border_Thick
78084>>>>>    Set Label to "EmpleadoLookUp"
78085>>>>>
78085>>>>>    Object oSelList is a dbList
78087>>>>>        Set peAnchors to anAll
78088>>>>>        Set Size to 149 501
78089>>>>>        Set Location  to 6 6
78090>>>>>
78090>>>>>        Begin_Row
78093>>>>>            Entry_Item EmpleadoTable.Codigo
78094>>>>>            Entry_Item EmpleadoTable.PrimerNombre
78095>>>>>            Entry_Item EmpleadoTable.SegundoNombre
78096>>>>>            Entry_Item EmpleadoTable.PrimerApellido
78097>>>>>            Entry_Item EmpleadoTable.SegundoApellido
78098>>>>>            Entry_Item Nacionalidad.CodigoNacionalidad
78099>>>>>        End_Row
78104>>>>>
78104>>>>>        Set Main_File to EmpleadoTable.File_Number
78105>>>>>
78105>>>>>        Set Form_Width 0 to 58
78106>>>>>        Set Header_Label 0 to "Codigo"
78107>>>>>        Set Form_Width 1 to 106
78108>>>>>        Set Header_Label 1 to "PrimerNombre"
78109>>>>>        Set Form_Width 2 to 150
78110>>>>>        Set Header_Label 2 to "SegundoNombre"
78111>>>>>        Set Form_Width 3 to 121
78112>>>>>        Set Header_Label 3 to "PrimerApellido"
78113>>>>>        Set Form_Width 4 to 163
78114>>>>>        Set Header_Label 4 to "SegundoApellido"
78115>>>>>        Set Form_Width 5 to 60
78116>>>>>        Set Header_Label 5 to "Nacionalidad"
78117>>>>>    End_Object
78118>>>>>
78118>>>>>    Object oOK_bn is a Button
78120>>>>>        Set Label     to "&Aceptar"
78121>>>>>        Set Location to 159 349
78122>>>>>        Set peAnchors to anBottomRight
78123>>>>>
78123>>>>>        Procedure OnClick
78126>>>>>            Send Ok of oSelList
78127>>>>>        End_Procedure
78128>>>>>
78128>>>>>    End_Object
78129>>>>>
78129>>>>>    Object oCancel_bn is a Button
78131>>>>>        Set Label     to "&Cancelar"
78132>>>>>        Set Location to 159 403
78133>>>>>        Set peAnchors to anBottomRight
78134>>>>>
78134>>>>>        Procedure OnClick
78137>>>>>            Send Cancel of oSelList
78138>>>>>        End_Procedure
78139>>>>>
78139>>>>>    End_Object
78140>>>>>
78140>>>>>    Object oSearch_bn is a Button
78142>>>>>        Set Label     to "&Buscar..."
78143>>>>>        Set Location to 159 457
78144>>>>>        Set peAnchors to anBottomRight
78145>>>>>
78145>>>>>        Procedure OnClick
78148>>>>>            Send Search of oSelList
78149>>>>>        End_Procedure
78150>>>>>
78150>>>>>    End_Object
78151>>>>>
78151>>>>>    On_Key Key_Alt+Key_A Send KeyAction of oOk_bn
78152>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
78153>>>>>    On_Key Key_Alt+Key_B Send KeyAction of oSearch_bn
78154>>>>>
78154>>>>>End_Object
78155>>>>>
78155>>>>>//*********************************************** end of TableLookup.tpl for Spanish ****************
78155>>>>>
78155>>>
78155>>>//**** consulta de marcajes por rango de fechas y nacionalidad
78155>>>// {MarcajeTable.FechaMarcaje} in "2022-05-03" to "2022-05-04" and {Nacionalidad.CodigoNacionalidad} = 1
78155>>>
78155>>>
78155>>>
78155>>>Activate_View Activate_MarcajesEmpleado for MarcajesEmpleado
78165>>>>
78165>>>Object MarcajesEmpleado is a ReportView
78167>>>    Set Location to 22 18
78168>>>    Set Size to 194 364
78169>>>    Set Label to "REPORTE DE MARCAJES DE EMPLEADOS"
78170>>>
78170>>>    Object TxtReporteX is a Form
78172>>>        Set Size to 15 118
78173>>>        Set Location to 75 122
78174>>>        Set Prompt_Button_Mode to PB_PromptOn
78175>>>    
78175>>>        // OnChange is called on every changed character
78175>>>    //    Procedure OnChange
78175>>>    //        String sValue
78175>>>    //    
78175>>>    //        Get Value to sValue
78175>>>    //    End_Procedure
78175>>>   // Set Prompt_Object to (oLista_empleado_sl(Current_Object))
78175>>>        Set Label_Col_Offset to 40
78176>>>        Set Color to clInactiveBorder
78177>>>        Set Label_Justification_Mode to JMode_Top
78178>>>   Set Prompt_Object to (LISTAMARCAJESLS(Current_Object))
78179>>>    
78179>>>        Procedure Prompt_Callback Integer hSL
78182>>>            Set initial_column of hSL to 0
78183>>>            Set export_column of hSL to 0
78184>>>            
78184>>>
78184>>>        End_Procedure
78185>>>    
78185>>>    End_Object
78186>>>    
78186>>>    //***** CONDIGIONES PARA GENERAR
78186>>>    Procedure CodicionesOpciones
78189>>>        If (Checked_State(OpRegistroUnico) = True) Begin  
78191>>>            
78191>>>                Send GenerarRerporte
78192>>>          
78192>>>        End
78192>>>>
78192>>>        
78192>>>        If (Checked_State(OpNacionalidad) = True) Begin
78194>>>            
78194>>>           
78194>>>               Send GenerarRerporteNacionalidad 
78195>>>             
78195>>>        End
78195>>>>
78195>>>        
78195>>>        If (Checked_State(OpCodigoEmpleado) = True) Begin  
78197>>>            
78197>>>             
78197>>>               Send GenerarRerporteEmpleado 
78198>>>                
78198>>>        End
78198>>>>
78198>>>        
78198>>>         If (Checked_State(OpFechas) = True) Begin            
78200>>>                      
78200>>>                Send  GenerarRerporteRangoFechas
78201>>>                      
78201>>>         End
78201>>>>
78201>>>         
78201>>>           If (Checked_State(OpFechasEmp) = True) Begin            
78203>>>                      
78203>>>                Send  RerporteEmpleadoFechas
78204>>>               
78204>>>                      
78204>>>           End
78204>>>>
78204>>>           
78204>>>            If (Checked_State(OpFechasNac) = True) Begin            
78206>>>                      
78206>>>                Send  MarcajesFechaPais
78207>>>               
78207>>>                      
78207>>>           End
78207>>>>
78207>>>           
78207>>>           
78207>>>        
78207>>>        
78207>>>        
78207>>>        
78207>>>    End_Procedure
78208>>>    Object BtnGenerarReporte is a Button
78210>>>        Set Size to 14 100
78211>>>        Set Location to 167 18
78212>>>        Set Label to "Generar Reporte"
78213>>>    
78213>>>        // fires when the button is clicked
78213>>>        Procedure OnClick
78216>>>            Send CodicionesOpciones
78217>>>        End_Procedure
78218>>>    
78218>>>    End_Object
78219>>>    
78219>>>     // Procedimiento para dar inicio a la generacion del reporte
78219>>>    Procedure GenerarRerporte
78222>>>        Integer sDatoGenerador
78222>>>        
78222>>>        Move 0 to sDatoGenerador  // asignamos valor vacio a nuestra variable
78223>>>        Get Value of (TxtReporteX(Current_Object)) item 0 to sDatoGenerador// TxtReporte es la caja de texto en nuestro form. traemos us valor y lo asignamos a nuestro sDatoGenerador
78224>>>        
78224>>>        //Creamos una condicion para verificar que sDatoGenerador no este vacio        
78224>>>            If (Trim(sDatoGenerador)) ne 0 Begin
78226>>>                Clear MarcajeTable  //tabla
78227>>>                Move (Trim(sDatoGenerador)) to MarcajeTable.Codigo  //atributo codiog de la tabla Marcajestable
78228>>>                Find eq MarcajeTable by Index.1   // busca segun el indice
78229>>>>
78229>>>                If [not Found] Begin
78231>>>                    //Send Info_Box 'Ingrese un Marcaje Valido'
78231>>>                    Error 200 'Ingrese un Marcaje Valido' // si no se encuentra que retorne el mensaje
78232>>>>
78232>>>                    Procedure_Return // retorna el procedimienot para hacer uso del sisema
78233>>>                End
78233>>>>
78233>>>            End
78233>>>>
78233>>>       
78233>>>   
78233>>>        Set Report_Name of (ReporteMarcajesObject(Current_Object)) to "ReporteMarcajes.rpt"
78234>>>        Send Run_Report to (ReporteMarcajesObject(Current_Object))
78235>>>    End_Procedure
78236>>>    
78236>>>   Object ReporteMarcajesObject is a WinQLReport  //Creamos el objeto WinQLReport
78238>>>        Set Output_Destination to WQL_PRINT_TO_WINDOW   // enviar la impresion de pantalla
78239>>>        
78239>>>        Procedure OnInitializeReport
78242>>>             Local String var_Parametros
78242>>>             Local Integer var_MarcajesTable        // declaracion de variable
78242>>>             Local String var_Seleccion
78242>>>            
78242>>>            Forward Send OnInitializeReport  // lanzamos el iniciador del reporte
78244>>>            
78244>>>            Move 0 to var_MarcajesTable  // asignamos un valor vacio
78245>>>            
78245>>>          //  Get Value of (TxtReporteX(Current_Object)) item 0 to var_MarcajesTable  // obtenes el valor de la caja de texto y lo asignamos a la variable
78245>>>            Get Value of TxtReporteX to var_MarcajesTable
78246>>>            Move '' to var_Parametros // asignamos vacio a parametros
78247>>>            
78247>>>            // Validamos que el lo que se le asigno a var_Marcajes no haya sido un dato vacio
78247>>>            If (var_MarcajesTable ne 0) Begin
78249>>>                //Move 0 to var_Seleccion // asignamos vacio
78249>>>                Append var_Seleccion '{MarcajeTable.Codigo} = ' ('"'+var_MarcajesTable+'"')  // adjuntamos la seleccion con el valor asignado
78251>>>                //Append var_Seleccion '{MarcajeTable.Codigo} = ' (var_MarcajesTable)
78251>>>            End
78251>>>>
78251>>>            
78251>>>            Append var_Parametros '"'
78252>>>            Append var_Parametros 'LISTA DE MARCAJES DE TRABAJADORES"'
78253>>>            
78253>>>     
78253>>>            Set SelectionFormula to var_Seleccion
78254>>>            Set Formula "Titulo" to var_Parametros
78255>>>                
78255>>>            
78255>>>        End_Procedure
78256>>>       
78256>>>    
78256>>>   End_Object
78257>>>
78257>>>    Object GrupoFechas is a Group
78259>>>        Set Size to 55 142
78260>>>        Set Location to 106 118
78261>>>        Set Label to "Seleccione un rango de fecha"
78262>>>        Set Color to clWhite
78263>>>        Set Bitmap_Style to Bitmap_Tile
78264>>>        Set Visible_State to False
78265>>>
78265>>>        Object oTextBox1 is a TextBox
78267>>>            Set Size to 10 41
78268>>>            Set Location to 37 23
78269>>>            Set Label to "dd/mm/aaaa"
78270>>>            Set Color to clWhite
78271>>>            Set TextColor to clGrayText
78272>>>        End_Object
78273>>>
78273>>>        Object TxtFechaDe is a Form
78275>>>            Set Size to 13 46
78276>>>            Set Location to 23 23
78277>>>            Set Label to "De"
78278>>>            Set Label_Col_Offset to 10
78279>>>            Set Form_Datatype item 0 to Mask_Date_Window   // con esto convertimos el campo en campo fecha
78280>>>        
78280>>>            // OnChange is called on every changed character
78280>>>        //    Procedure OnChange
78280>>>        //        String sValue
78280>>>        //    
78280>>>        //        Get Value to sValue
78280>>>        //    End_Procedure
78280>>>        
78280>>>        End_Object
78281>>>
78281>>>        Object TxtFechaA is a Form
78283>>>            Set Size to 13 46
78284>>>            Set Location to 23 82
78285>>>            Set Label to "A"
78286>>>            Set Label_Col_Offset to 10
78287>>>            Set Form_Datatype item 0 to Mask_Date_Window   // con esto convertimos el campo en campo fecha
78288>>>        
78288>>>            // OnChange is called on every changed character
78288>>>        //    Procedure OnChange
78288>>>        //        String sValue
78288>>>        //    
78288>>>        //        Get Value to sValue
78288>>>        //    End_Procedure
78288>>>        
78288>>>        End_Object
78289>>>
78289>>>        Object oTextBox1 is a TextBox
78291>>>            Set Size to 10 41
78292>>>            Set Location to 37 85
78293>>>            Set Label to "dd/mm/aaaa"
78294>>>            Set Color to clWhite
78295>>>            Set TextColor to clGrayText
78296>>>        End_Object
78297>>>    End_Object
78298>>>
78298>>>    Object oRadioGroup1 is a RadioGroup
78300>>>        Set Location to 46 16
78301>>>        Set Size to 114 101
78302>>>        Set Label to "GENERAR REPORTE POR"
78303>>>        Set Color to clWhite
78304>>>    
78304>>>        Object OpRegistroUnico is a Radio
78306>>>            Set Label to "Codigo de Registro"
78307>>>            Set Size to 10 71
78308>>>            Set Location to 20 13
78309>>>            Set Color to clWhite
78310>>>
78310>>>            Procedure OnChange
78313>>>                Forward Send OnChange
78315>>>                If (Checked_State(OpRegistroUnico) = True) Begin
78317>>>                   Set Prompt_Object of TxtReporteX to (oLista_empleado_sl(Current_Object)) 
78318>>>                   Set Value of TxtReporteX to ""
78319>>>                   //Set Prompt_Object to (oLista_empleado_sl(Current_Object))
78319>>>                  //Set Type_Value of TxtFechaA to Date_Window
78319>>>                End
78319>>>>
78319>>>                
78319>>>                If (Checked_State(OpRegistroUnico) = True) Begin
78321>>>              //Set Value of TxtFechaA to "activo"
78321>>>                   Set Visible_State of GrupoFechas to False
78322>>>                   Set Visible_State of TxtFechaDe to  False
78323>>>                   Set Visible_State of TxtFechaA to False
78324>>>                   Set Visible_State of TxtReporteX to True
78325>>>                  End
78325>>>>
78325>>>                  
78325>>>                
78325>>>            End_Procedure
78326>>>
78326>>>            
78326>>>        End_Object
78327>>>    
78327>>>        Object OpCodigoEmpleado is a Radio
78329>>>            Set Label to "Codigo Empleado"
78330>>>            Set Size to 10 73
78331>>>            Set Location to 35 13
78332>>>            Set Color to clWhite
78333>>>
78333>>>            Procedure OnChange
78336>>>                Forward Send OnChange
78338>>>                If (Checked_State(OpCodigoEmpleado) = True) Begin
78340>>>                   Set Prompt_Object of TxtReporteX to (EmpleadoLookUp(Current_Object))
78341>>>                   Set Value of TxtReporteX to ""
78342>>>                  
78342>>>                End
78342>>>>
78342>>>                
78342>>>                If (Checked_State(OpCodigoEmpleado) = True) Begin
78344>>>              //Set Value of TxtFechaA to "activo"
78344>>>                   Set Visible_State of GrupoFechas to False
78345>>>                   Set Visible_State of TxtFechaDe to  False
78346>>>                   Set Visible_State of TxtFechaA to False
78347>>>                   Set Visible_State of TxtReporteX to True
78348>>>                  End
78348>>>>
78348>>>                
78348>>>            End_Procedure
78349>>>        End_Object
78350>>>    
78350>>>        Object OpNacionalidad is a Radio
78352>>>            Set Label to "Nacionalidad"
78353>>>            Set Size to 10 61
78354>>>            Set Location to 51 13
78355>>>            Set Color to clWhite
78356>>>
78356>>>            Procedure OnChange
78359>>>                Forward Send OnChange
78361>>>                //Send CodicionesOpciones
78361>>>                If (Checked_State(OpNacionalidad) = True) Begin
78363>>>                   Set Prompt_Object of TxtReporteX to (ListaNacionalidadesPromp(Current_Object))
78364>>>                   Set Value of TxtReporteX to ""
78365>>>                End
78365>>>>
78365>>>                 If (Checked_State(OpNacionalidad) = True) Begin
78367>>>              //Set Value of TxtFechaA to "activo"
78367>>>                   Set Visible_State of GrupoFechas to False
78368>>>                   Set Visible_State of TxtFechaDe to  False
78369>>>                   Set Visible_State of TxtFechaA to False
78370>>>                   Set Visible_State of TxtReporteX to True
78371>>>                  End
78371>>>>
78371>>>                 
78371>>>                // Set Prompt_Object to (oLista_empleado_sl(Current_Object))
78371>>>                 
78371>>>            End_Procedure
78372>>>
78372>>>            
78372>>>        End_Object
78373>>>    
78373>>>        Procedure Notify_Select_State Integer iToItem Integer iFromItem
78376>>>            Forward Send Notify_Select_State iToItem iFromItem
78378>>>            // for augmentation
78378>>>        End_Procedure
78379>>>
78379>>>        Object OpFechas is a Radio
78381>>>            Set Label to "Fechas"
78382>>>            Set Size to 10 61
78383>>>            Set Location to 66 13
78384>>>            Set Color to clWhite
78385>>>
78385>>>            Procedure OnChange
78388>>>                Forward Send OnChange
78390>>>               If (Checked_State(OpFechas) = True) Begin
78392>>>              //Set Value of TxtFechaA to "activo"
78392>>>               Set Visible_State of GrupoFechas to True
78393>>>               Set Visible_State of TxtFechaDe to  True
78394>>>               Set Visible_State of TxtFechaA to True
78395>>>               Set Visible_State of TxtReporteX to False
78396>>>              End
78396>>>>
78396>>>             
78396>>>              
78396>>>               Set Value of TxtFechaDe to ""
78397>>>               Set Value of TxtFechaA to ""
78398>>>                
78398>>>                
78398>>>            End_Procedure
78399>>>
78399>>>
78399>>>        End_Object
78400>>>
78400>>>        Object OpFechasEmp is a Radio
78402>>>            Set Size to 10 50
78403>>>            Set Location to 81 13
78404>>>            Set Label to "Fechas y Empleado"
78405>>>            Set Color to clWhite
78406>>>
78406>>>            Procedure OnChange
78409>>>                Forward Send OnChange
78411>>>                
78411>>>               If (Checked_State(OpFechasEmp) = True) Begin              
78413>>>                   Set Prompt_Object of TxtReporteX to (EmpleadoLookUp(Current_Object))
78414>>>                   Set Value of TxtReporteX to ""
78415>>>                   Set Visible_State of GrupoFechas to True
78416>>>                   Set Visible_State of TxtFechaDe to  True
78417>>>                   Set Visible_State of TxtFechaA to True
78418>>>                   Set Visible_State of TxtReporteX to True
78419>>>              End
78419>>>>
78419>>>              
78419>>>              
78419>>>                   Set Value of TxtFechaDe to ""
78420>>>                   Set Value of TxtFechaA to ""
78421>>>                   Set Value of TxtReporteX to ""
78422>>>            End_Procedure
78423>>>        End_Object
78424>>>
78424>>>        Object OpFechasNac is a Radio
78426>>>            Set Size to 10 50
78427>>>            Set Location to 95 13
78428>>>            Set Label to "Fechas y Nacionalidad"
78429>>>            Set Color to clWhite
78430>>>
78430>>>            Procedure OnChange
78433>>>                Forward Send OnChange
78435>>>                
78435>>>                 If (Checked_State(OpFechasNac) = True) Begin                   
78437>>>                   Set Prompt_Object of TxtReporteX to (ListaNacionalidadesPromp(Current_Object))
78438>>>                   Set Visible_State of GrupoFechas to True
78439>>>                   Set Visible_State of TxtFechaDe to  True
78440>>>                   Set Visible_State of TxtFechaA to True
78441>>>                   Set Visible_State of TxtReporteX to True
78442>>>              End
78442>>>>
78442>>>              
78442>>>              
78442>>>                   Set Value of TxtFechaDe to ""
78443>>>                   Set Value of TxtFechaA to ""
78444>>>                   Set Value of TxtReporteX to ""
78445>>>            End_Procedure
78446>>>        End_Object
78447>>>    
78447>>>        // If you set Current_Radio, you must set it AFTER the
78447>>>        // radio objects have been created AND AFTER Notify_Select_State has been
78447>>>        // created. i.e. Set in bottom-code of object at the end!!
78447>>>    //    Set Current_Radio to 0
78447>>>    
78447>>>    End_Object
78448>>>    
78448>>>    
78448>>>    
78448>>>   
78448>>>    //*********************----------------
78448>>>    
78448>>>      // Procedimiento para dar inicio a la generacion del reporte por NACIONALIDAD
78448>>>    Procedure GenerarRerporteNacionalidad
78451>>>        Integer sDatoGenerador
78451>>>        
78451>>>        Move 0 to sDatoGenerador  // asignamos valor vacio a nuestra variable
78452>>>        Get Value of (TxtReporteX(Current_Object)) item 0 to sDatoGenerador// TxtReporte es la caja de texto en nuestro form. traemos us valor y lo asignamos a nuestro sDatoGenerador
78453>>>        //Creamos una condicion para verificar que sDatoGenerador no este vacio
78453>>>        If (Trim(sDatoGenerador)) ne 0 Begin
78455>>>            Clear Nacionalidad  //tabla
78456>>>            Move (Trim(sDatoGenerador)) to Nacionalidad.CodigoNacionalidad  //atributo codiog de la tabla Marcajestable
78457>>>            Find eq Nacionalidad by Index.1   // busca segun el indice
78458>>>>
78458>>>            If [not Found] Begin
78460>>>                Error 200 'Ingrese una Nacionalidad Valida' // si no se encuentra que retorne el mensaje
78461>>>>
78461>>>                Procedure_Return // retorna el procedimienot para hacer uso del sisema
78462>>>            End
78462>>>>
78462>>>        End
78462>>>>
78462>>>        
78462>>>    
78462>>>   
78462>>>   
78462>>>        Set Report_Name of (ReporteMarcajesObjectNacionalidad(Current_Object)) to "ReporteMarcajes.rpt"
78463>>>        Send Run_Report to (ReporteMarcajesObjectNacionalidad(Current_Object))
78464>>>    End_Procedure
78465>>>    
78465>>>    
78465>>>    
78465>>>     Object ReporteMarcajesObjectNacionalidad is a WinQLReport  //Creamos el objeto WinQLReport
78467>>>        Set Output_Destination to WQL_PRINT_TO_WINDOW   // enviar la impresion de pantalla
78468>>>        
78468>>>        Procedure OnInitializeReport
78471>>>             Local String var_Parametros
78471>>>             Local Integer var_MarcajesTable        // declaracion de variable
78471>>>             Local String var_Seleccion
78471>>>            
78471>>>            Forward Send OnInitializeReport  // lanzamos el iniciador del reporte
78473>>>            
78473>>>            Move 0 to var_MarcajesTable  // asignamos un valor vacio
78474>>>            
78474>>>          //  Get Value of (TxtReporteX(Current_Object)) item 0 to var_MarcajesTable  // obtenes el valor de la caja de texto y lo asignamos a la variable
78474>>>            Get Value of TxtReporteX to var_MarcajesTable
78475>>>            Move '' to var_Parametros // asignamos vacio a parametros
78476>>>            
78476>>>            // Validamos que el lo que se le asigno a var_Marcajes no haya sido un dato vacio
78476>>>            If (var_MarcajesTable ne 0) Begin
78478>>>                //Move 0 to var_Seleccion // asignamos vacio
78478>>>                Append var_Seleccion '{Nacionalidad.CodigoNacionalidad} = ' ('"'+var_MarcajesTable+'"')  // adjuntamos la seleccion con el valor asignado
78480>>>                //Append var_Seleccion '{MarcajeTable.Codigo} = ' (var_MarcajesTable)
78480>>>            End
78480>>>>
78480>>>            
78480>>>            Append var_Parametros '"'
78481>>>            Append var_Parametros 'LISTA DE MARCAJES DE TRABAJADORES POR NACIONALIDAD"'
78482>>>            
78482>>>     
78482>>>            Set SelectionFormula to var_Seleccion
78483>>>            Set Formula "Titulo" to var_Parametros
78484>>>                
78484>>>            
78484>>>        End_Procedure
78485>>>       
78485>>>    
78485>>>   End_Object
78486>>>    
78486>>>    //-----------*************************
78486>>>    
78486>>>        
78486>>>    //*********************----------------    GENERAR REPORTE POR EMPLEADO
78486>>>    
78486>>>      // Procedimiento para dar inicio a la generacion del reporte por NACIONALIDAD
78486>>>    Procedure GenerarRerporteEmpleado
78489>>>        Integer sDatoGenerador
78489>>>        
78489>>>        Move 0 to sDatoGenerador  // asignamos valor vacio a nuestra variable
78490>>>        Get Value of (TxtReporteX(Current_Object)) item 0 to sDatoGenerador// TxtReporte es la caja de texto en nuestro form. traemos us valor y lo asignamos a nuestro sDatoGenerador
78491>>>        //Creamos una condicion para verificar que sDatoGenerador no este vacio
78491>>>        If (Trim(sDatoGenerador)) ne 0 Begin
78493>>>            Clear EmpleadoTable  //tabla
78494>>>            Move (Trim(sDatoGenerador)) to EmpleadoTable.Codigo  //atributo codiog de la tabla Marcajestable
78495>>>            Find eq EmpleadoTable by Index.1   // busca segun el indice
78496>>>>
78496>>>            If [not Found] Begin
78498>>>                Error 200 'Ingrese un codigo de empleado Valido' // si no se encuentra que retorne el mensaje
78499>>>>
78499>>>                Procedure_Return // retorna el procedimienot para hacer uso del sisema
78500>>>            End
78500>>>>
78500>>>        End
78500>>>>
78500>>>   
78500>>>   
78500>>>        Set Report_Name of (ReporteMarcajesObjectEmpleado(Current_Object)) to "ReporteMarcajes.rpt"
78501>>>        Send Run_Report to (ReporteMarcajesObjectEmpleado(Current_Object))
78502>>>    End_Procedure
78503>>>    
78503>>>    
78503>>>    
78503>>>     Object ReporteMarcajesObjectEmpleado is a WinQLReport  //Creamos el objeto WinQLReport
78505>>>        Set Output_Destination to WQL_PRINT_TO_WINDOW   // enviar la impresion de pantalla
78506>>>        
78506>>>        Procedure OnInitializeReport
78509>>>             Local String var_Parametros
78509>>>             Local Integer var_MarcajesTable        // declaracion de variable
78509>>>             Local String var_Seleccion
78509>>>            
78509>>>            Forward Send OnInitializeReport  // lanzamos el iniciador del reporte
78511>>>            
78511>>>            Move 0 to var_MarcajesTable  // asignamos un valor vacio
78512>>>            
78512>>>          //  Get Value of (TxtReporteX(Current_Object)) item 0 to var_MarcajesTable  // obtenes el valor de la caja de texto y lo asignamos a la variable
78512>>>            Get Value of TxtReporteX to var_MarcajesTable
78513>>>            Move '' to var_Parametros // asignamos vacio a parametros
78514>>>            
78514>>>            // Validamos que el lo que se le asigno a var_Marcajes no haya sido un dato vacio
78514>>>            If (var_MarcajesTable ne 0) Begin
78516>>>                //Move 0 to var_Seleccion // asignamos vacio
78516>>>                Append var_Seleccion '{EmpleadoTable.Codigo} = ' ('"'+var_MarcajesTable+'"')  // adjuntamos la seleccion con el valor asignado
78518>>>                //Append var_Seleccion '{MarcajeTable.Codigo} = ' (var_MarcajesTable)
78518>>>            End
78518>>>>
78518>>>            //{MarcajeTable.FechaMarcaje} in "2022-05-02" to "2022-05-04" 
78518>>>            Append var_Parametros '"'
78519>>>            Append var_Parametros 'LISTA DE MARCAJES DE TRABAJADORES POR EMPLEADO"'
78520>>>            
78520>>>     
78520>>>            Set SelectionFormula to var_Seleccion
78521>>>            Set Formula "Titulo" to var_Parametros
78522>>>                
78522>>>            
78522>>>        End_Procedure
78523>>>       
78523>>>    
78523>>>   End_Object
78524>>>    
78524>>>    //-----------*************************
78524>>>    
78524>>>    
78524>>>    
78524>>>    
78524>>>    //*********************----------------    REPORTE POR RANGO DE FECHAS 
78524>>>    
78524>>>      
78524>>>    Procedure GenerarRerporteRangoFechas
78527>>>        
78527>>>       Global_Variable Date @FechaInicial
78527>>>       Global_Variable Date @FechaFinal
78527>>>       Global_Variable Date @FechaConteo
78527>>>        
78527>>>        Indicate AceptarFecha True
78528>>>        
78528>>>        Move ("01/01/1900") to @FechaConteo
78529>>>        //Move ("1900/01/01") to @FechaConteo
78529>>>        
78529>>>        Get Value of TxtFechaDe to @FechaInicial
78530>>>        Get Value of TxtFechaA to @FechaFinal
78531>>>        
78531>>>         If (@FechaInicial <> '' or @FechaFinal <> '') Begin
78533>>>            If ( (@FechaInicial < @FechaConteo) or (@FechaFinal < @FechaConteo)) Begin 
78535>>>            Error 200 'Ingrese Fechas V lidas'
78536>>>>
78536>>>            Indicate AceptarFecha False
78537>>>        End
78537>>>>
78537>>>        Else If (@FechaInicial > @FechaFinal ) Begin
78540>>>             Error 200 'FECHA INICIAL NO PUEDE SER MAYOR A FECHA FINAL'
78541>>>>
78541>>>            Indicate AceptarFecha False            
78542>>>        End
78542>>>>
78542>>>        Else If (@FechaFinal >= @FechaInicial ) Begin
78545>>>            [ AceptarFecha ] Send Run_Report to (ReporteFiltroFechas(Current_Object))
78546>>>        End
78546>>>>
78546>>>         //*****--++++++++++
78546>>>         End
78546>>>>
78546>>>         Else Begin
78547>>>            Send Info_Box 'Las Fechas son Requeridas'
78548>>>         End
78548>>>>
78548>>>        
78548>>>        
78548>>>        If (@FechaInicial <> '' or @FechaFinal <> '') Begin
78550>>>            Set Report_Name of (ReporteFiltroFechas(Current_Object)) to "ReporteMarcajes.rpt"
78551>>>            Send Run_Report to (ReporteFiltroFechas(Current_Object))
78552>>>        End
78552>>>>
78552>>>     
78552>>>        
78552>>>    End_Procedure
78553>>>    
78553>>>    Object ReporteFiltroFechas is a WinQLReport
78555>>>        
78555>>>        Set Output_Destination to WQL_PRINT_TO_WINDOW
78556>>>        
78556>>>        Procedure OnInitializeReport
78559>>>            
78559>>>            Date FechaInicialX
78559>>>            Date FechaFinalX
78559>>>            Date FechaConteoX
78559>>>            String var_Parametros
78559>>>            String SeleccionX
78559>>>            String SubFechaInicial
78559>>>            String SubFechaFinal            
78559>>>            
78559>>>            
78559>>>            Get Value of TxtFechaDe to FechaInicialX
78560>>>            Get Value of TxtFechaA to FechaFinalX
78561>>>           
78561>>>            Append SubFechaInicial (Mid(FechaInicialX,4,7))
78562>>>            Append SubFechaInicial '-'
78563>>>            Append SubFechaInicial (Mid(FechaInicialX,2,4))
78564>>>            Append SubFechaInicial '-'
78565>>>            Append SubFechaInicial (Mid(FechaInicialX,2,1))
78566>>>            
78566>>>            Append SubFEchaFinal (Mid(FechaFinalX,4,7))
78567>>>            Append SubFEchaFinal '-'
78568>>>            Append SubFEchaFinal (Mid(FechaFinalX,2,4))
78569>>>            Append SubFEchaFinal '-'
78570>>>            Append SubFEchaFinal (Mid(FechaFinalX,2,1))
78571>>>            
78571>>>            Forward Send OninitializeReport
78573>>>            
78573>>>            Clear MarcajeTable
78574>>>            If (AceptarFecha = True) Begin
78576>>>                
78576>>>               // Append @Seleccion '{MarcajeTable.FechaMarcaje} >= Date'  ('"'+@FechaInicial+'"') // ' And {MarcajeTable.FechaMarcaje} <= Date' ('"'+@FechaFinal+'"')
78576>>>                Append SeleccionX '{MarcajeTable.FechaMarcaje} in "'
78577>>>                Append SeleccionX SubFechaInicial
78578>>>                Append SeleccionX '" to "'
78579>>>                Append SeleccionX SubFechaFinal
78580>>>                Append SeleccionX '"'
78581>>>                
78581>>>            End
78581>>>>
78581>>>            
78581>>>           Append var_Parametros '"'
78582>>>            Append var_Parametros 'LISTA DE MARCAJES POR FECHA"'
78583>>>            
78583>>>     
78583>>>            Set SelectionFormula to SeleccionX
78584>>>            Set Formula "Titulo" to var_Parametros
78585>>>            
78585>>>            
78585>>>        End_Procedure
78586>>>    End_Object
78587>>>        
78587>>>        // ********************* REPORTE POR FECHA Y POR EMPLEADO
78587>>>      Procedure RerporteEmpleadoFechas
78590>>>        
78590>>>        // ** Empleado
78590>>>        Integer sDatoGenerador
78590>>>        
78590>>>        Move 0 to sDatoGenerador  // asignamos valor vacio a nuestra variable
78591>>>        Get Value of (TxtReporteX(Current_Object)) item 0 to sDatoGenerador// TxtReporte es la caja de texto en nuestro form. traemos us valor y lo asignamos a nuestro sDatoGenerador
78592>>>        //Creamos una condicion para verificar que sDatoGenerador no este vacio
78592>>>        If (Trim(sDatoGenerador)) ne 0 Begin
78594>>>            Clear EmpleadoTable  //tabla
78595>>>            Move (Trim(sDatoGenerador)) to EmpleadoTable.Codigo  //atributo codiog de la tabla Marcajestable
78596>>>            Find eq EmpleadoTable by Index.1   // busca segun el indice
78597>>>>
78597>>>            If [not Found] Begin
78599>>>                Error 200 'Ingrese un codigo de empleado Valido' // si no se encuentra que retorne el mensaje
78600>>>>
78600>>>                Procedure_Return // retorna el procedimienot para hacer uso del sisema
78601>>>            End
78601>>>>
78601>>>        End
78601>>>>
78601>>>        
78601>>>        // ** Fecha
78601>>>        Indicate AceptarFecha True
78602>>>        
78602>>>        Move ("01/01/1900") to @FechaConteo
78603>>>        //Move ("1900/01/01") to @FechaConteo
78603>>>        
78603>>>        Get Value of TxtFechaDe to @FechaInicial
78604>>>        Get Value of TxtFechaA to @FechaFinal
78605>>>        
78605>>>         If (@FechaInicial <> '' or @FechaFinal <> '') Begin
78607>>>            If ( (@FechaInicial < @FechaConteo) or (@FechaFinal < @FechaConteo)) Begin 
78609>>>            Error 200 'Ingrese Fechas V lidas'
78610>>>>
78610>>>            Indicate AceptarFecha False
78611>>>        End
78611>>>>
78611>>>        Else If (@FechaInicial > @FechaFinal ) Begin
78614>>>             Error 200 'FECHA INICIAL NO PUEDE SER MAYOR A FECHA FINAL'
78615>>>>
78615>>>            Indicate AceptarFecha False            
78616>>>        End
78616>>>>
78616>>>        Else If (@FechaFinal >= @FechaInicial ) Begin
78619>>>            [ AceptarFecha ] Send Run_Report to (ReporteFiltroFechas(Current_Object))
78620>>>        End
78620>>>>
78620>>>         //*****--++++++++++
78620>>>         End
78620>>>>
78620>>>         Else Begin
78621>>>            Send Info_Box 'Las Fechas son Requeridas'
78622>>>         End
78622>>>>
78622>>>         
78622>>>         
78622>>>          If (@FechaInicial <> '' or @FechaFinal <> '') Begin
78624>>>            Set Report_Name of (FiltroFechasEmpleado(Current_Object)) to "ReporteMarcajes.rpt"
78625>>>            Send Run_Report to (FiltroFechasEmpleado(Current_Object))
78626>>>        End
78626>>>>
78626>>>        
78626>>>      End_Procedure
78627>>>      
78627>>>      
78627>>>      // --------------- Crecion del Objeto
78627>>>   Object FiltroFechasEmpleado is a WinQLReport
78629>>>        
78629>>>        Set Output_Destination to WQL_PRINT_TO_WINDOW   // enviar la impresion de pantalla
78630>>>        
78630>>>        Procedure OnInitializeReport
78633>>>              String var_Parametros
78633>>>              Integer var_MarcajesTable        // declaracion de variable
78633>>>              String var_Seleccion
78633>>>                Date FechaInicialX
78633>>>                Date FechaFinalX
78633>>>                Date FechaConteoX
78633>>>                String FullQuery
78633>>>                String SeleccionX
78633>>>                String SubFechaInicial
78633>>>                String SubFechaFinal
78633>>>                
78633>>>                Forward Send OnInitializeReport  // lanzamos el iniciador del reporte                
78635>>>                Move 0 to var_MarcajesTable  // asignamos un valor vacio
78636>>>                
78636>>>              //  Get Value of (TxtReporteX(Current_Object)) item 0 to var_MarcajesTable  // obtenes el valor de la caja de texto y lo asignamos a la variable
78636>>>                Get Value of TxtReporteX to var_MarcajesTable
78637>>>                Move '' to var_Parametros // asignamos vacio a parametros
78638>>>                
78638>>>                // Validamos que el lo que se le asigno a var_Marcajes no haya sido un dato vacio
78638>>>                If (var_MarcajesTable ne 0) Begin
78640>>>                    //Move 0 to var_Seleccion // asignamos vacio
78640>>>                    Append var_Seleccion '{EmpleadoTable.Codigo} = '
78641>>>                    Append var_Seleccion  var_MarcajesTable                    
78642>>>                End
78642>>>>
78642>>>                
78642>>>               
78642>>>                // ***** incian Fechas
78642>>>                Get Value of TxtFechaDe to FechaInicialX
78643>>>                Get Value of TxtFechaA to FechaFinalX
78644>>>               
78644>>>                Append SubFechaInicial (Mid(FechaInicialX,4,7))
78645>>>                Append SubFechaInicial '-'
78646>>>                Append SubFechaInicial (Mid(FechaInicialX,2,4))
78647>>>                Append SubFechaInicial '-'
78648>>>                Append SubFechaInicial (Mid(FechaInicialX,2,1))
78649>>>                
78649>>>                Append SubFEchaFinal (Mid(FechaFinalX,4,7))
78650>>>                Append SubFEchaFinal '-'
78651>>>                Append SubFEchaFinal (Mid(FechaFinalX,2,4))
78652>>>                Append SubFEchaFinal '-'
78653>>>                Append SubFEchaFinal (Mid(FechaFinalX,2,1)) 
78654>>>            
78654>>>                Clear MarcajeTable
78655>>>                If (AceptarFecha = True) Begin
78657>>>                    
78657>>>                   // Append @Seleccion '{MarcajeTable.FechaMarcaje} >= Date'  ('"'+@FechaInicial+'"') // ' And {MarcajeTable.FechaMarcaje} <= Date' ('"'+@FechaFinal+'"')
78657>>>                    Append SeleccionX '{MarcajeTable.FechaMarcaje} in "'
78658>>>                    Append SeleccionX SubFechaInicial
78659>>>                    Append SeleccionX '" to "'
78660>>>                    Append SeleccionX SubFechaFinal
78661>>>                    Append SeleccionX '"'                    
78662>>>                End
78662>>>>
78662>>>            
78662>>>                Append var_Parametros '"'
78663>>>                Append var_Parametros 'LISTA DE MARCAJES POR FECHA Y EMPLEADO"'
78664>>>                
78664>>>                // se crea la cadena completa
78664>>>                Append FullQuery var_Seleccion  
78665>>>                Append FullQuery ' and '              
78666>>>                Append FullQuery SeleccionX
78667>>>         
78667>>>                Set SelectionFormula to FullQuery
78668>>>                Set Formula "Titulo" to var_Parametros
78669>>>                
78669>>>        End_Procedure
78670>>>          
78670>>>   End_Object
78671>>>   
78671>>>   
78671>>>   // ******** GENERAR REPORTE DE UN PAIS DELIMITADO POR RANGO DE FECHAS
78671>>>   
78671>>>   
78671>>>   Procedure MarcajesFechaPais
78674>>>    
78674>>>         Integer sDatoGenerador
78674>>>        
78674>>>        Move 0 to sDatoGenerador  // asignamos valor vacio a nuestra variable
78675>>>        Get Value of (TxtReporteX(Current_Object)) item 0 to sDatoGenerador// TxtReporte es la caja de texto en nuestro form. traemos us valor y lo asignamos a nuestro sDatoGenerador
78676>>>        //Creamos una condicion para verificar que sDatoGenerador no este vacio
78676>>>        If (Trim(sDatoGenerador)) ne 0 Begin
78678>>>            Clear Nacionalidad  //tabla
78679>>>            Move (Trim(sDatoGenerador)) to Nacionalidad.CodigoNacionalidad  //atributo codiog de la tabla Marcajestable
78680>>>            Find eq Nacionalidad by Index.1   // busca segun el indice
78681>>>>
78681>>>            If [not Found] Begin
78683>>>                Error 200 'Ingrese una Nacionalidad Valida' // si no se encuentra que retorne el mensaje
78684>>>>
78684>>>                Procedure_Return // retorna el procedimienot para hacer uso del sisema
78685>>>            End
78685>>>>
78685>>>        End
78685>>>>
78685>>>    
78685>>>    
78685>>>    // ** Fecha
78685>>>        Indicate AceptarFecha True
78686>>>        
78686>>>        Move ("01/01/1900") to @FechaConteo
78687>>>        //Move ("1900/01/01") to @FechaConteo
78687>>>        
78687>>>        Get Value of TxtFechaDe to @FechaInicial
78688>>>        Get Value of TxtFechaA to @FechaFinal
78689>>>        
78689>>>         If (@FechaInicial <> '' or @FechaFinal <> '') Begin
78691>>>            If ( (@FechaInicial < @FechaConteo) or (@FechaFinal < @FechaConteo)) Begin 
78693>>>            Error 200 'Ingrese Fechas V lidas'
78694>>>>
78694>>>            Indicate AceptarFecha False
78695>>>        End
78695>>>>
78695>>>        Else If (@FechaInicial > @FechaFinal ) Begin
78698>>>             Error 200 'FECHA INICIAL NO PUEDE SER MAYOR A FECHA FINAL'
78699>>>>
78699>>>            Indicate AceptarFecha False            
78700>>>        End
78700>>>>
78700>>>        Else If (@FechaFinal >= @FechaInicial ) Begin
78703>>>            [ AceptarFecha ] Send Run_Report to (ReporteFiltroFechas(Current_Object))
78704>>>        End
78704>>>>
78704>>>         //*****--++++++++++
78704>>>         End
78704>>>>
78704>>>         Else Begin
78705>>>            Send Info_Box 'Las Fechas son Requeridas'
78706>>>         End
78706>>>>
78706>>>         
78706>>>         
78706>>>          If (@FechaInicial <> '' or @FechaFinal <> '') Begin
78708>>>            Set Report_Name of (FiltroFechasPais(Current_Object)) to "ReporteMarcajes.rpt"
78709>>>            Send Run_Report to (FiltroFechasPais(Current_Object))
78710>>>        End
78710>>>>
78710>>>   End_Procedure
78711>>>   
78711>>>   // creacion del objeo FechasNacionalidad
78711>>>   Object FiltroFechasPais is a WinQLReport
78713>>>        
78713>>>        Set Output_Destination to WQL_PRINT_TO_WINDOW   // enviar la impresion de pantalla
78714>>>        
78714>>>        Procedure OnInitializeReport
78717>>>              String var_Parametros
78717>>>              Integer var_MarcajesTable        // declaracion de variable
78717>>>              String var_Seleccion
78717>>>                Date FechaInicialX
78717>>>                Date FechaFinalX
78717>>>                Date FechaConteoX
78717>>>                String FullQuery
78717>>>                String SeleccionX
78717>>>                String SubFechaInicial
78717>>>                String SubFechaFinal
78717>>>                
78717>>>                Forward Send OnInitializeReport  // lanzamos el iniciador del reporte                
78719>>>               
78719>>>               
78719>>>            Move 0 to var_MarcajesTable  // asignamos un valor vacio
78720>>>            
78720>>>          //  Get Value of (TxtReporteX(Current_Object)) item 0 to var_MarcajesTable  // obtenes el valor de la caja de texto y lo asignamos a la variable
78720>>>            Get Value of TxtReporteX to var_MarcajesTable
78721>>>            Move '' to var_Parametros // asignamos vacio a parametros
78722>>>            
78722>>>            // Validamos que el lo que se le asigno a var_Marcajes no haya sido un dato vacio
78722>>>            If (var_MarcajesTable ne 0) Begin
78724>>>                //Move 0 to var_Seleccion // asignamos vacio
78724>>>                Append var_Seleccion '{Nacionalidad.CodigoNacionalidad} = '
78725>>>                Append var_Seleccion var_MarcajesTable
78726>>>                
78726>>>            End
78726>>>>
78726>>>               
78726>>>               
78726>>>                // ***** incian Fechas
78726>>>                Get Value of TxtFechaDe to FechaInicialX
78727>>>                Get Value of TxtFechaA to FechaFinalX
78728>>>               
78728>>>                Append SubFechaInicial (Mid(FechaInicialX,4,7))
78729>>>                Append SubFechaInicial '-'
78730>>>                Append SubFechaInicial (Mid(FechaInicialX,2,4))
78731>>>                Append SubFechaInicial '-'
78732>>>                Append SubFechaInicial (Mid(FechaInicialX,2,1))
78733>>>                
78733>>>                Append SubFEchaFinal (Mid(FechaFinalX,4,7))
78734>>>                Append SubFEchaFinal '-'
78735>>>                Append SubFEchaFinal (Mid(FechaFinalX,2,4))
78736>>>                Append SubFEchaFinal '-'
78737>>>                Append SubFEchaFinal (Mid(FechaFinalX,2,1)) 
78738>>>            
78738>>>                Clear MarcajeTable
78739>>>                If (AceptarFecha = True) Begin
78741>>>                    
78741>>>                   // Append @Seleccion '{MarcajeTable.FechaMarcaje} >= Date'  ('"'+@FechaInicial+'"') // ' And {MarcajeTable.FechaMarcaje} <= Date' ('"'+@FechaFinal+'"')
78741>>>                    Append SeleccionX '{MarcajeTable.FechaMarcaje} in "'
78742>>>                    Append SeleccionX SubFechaInicial
78743>>>                    Append SeleccionX '" to "'
78744>>>                    Append SeleccionX SubFechaFinal
78745>>>                    Append SeleccionX '"'                    
78746>>>                End
78746>>>>
78746>>>            
78746>>>                Append var_Parametros '"'
78747>>>                Append var_Parametros 'LISTA DE MARCAJES POR FECHA Y EMPLEADO"'
78748>>>                
78748>>>                // se crea la cadena completa
78748>>>                Append FullQuery var_Seleccion  
78749>>>                Append FullQuery ' and '              
78750>>>                Append FullQuery SeleccionX
78751>>>         
78751>>>                Set SelectionFormula to FullQuery
78752>>>                Set Formula "Titulo" to var_Parametros
78753>>>                
78753>>>        End_Procedure
78754>>>          
78754>>>   End_Object
78755>>>   
78755>>>   
78755>>>   
78755>>>       
78755>>>  
78755>>>End_Object
78756>>>
78756>>>  
78756>
78756>        Procedure Activate_About
78759>            Send DoAbout "" "" "" "" ""
78760>        End_Procedure
78761>
78761>    End_Object
78762>
78762>End_Object
78763>
78763>Start_UI
78764>
78764>//************************** end of WindowsProject.tpl for Spanish **************
78764>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 44723
Total Resources: 0
Total Commands : 78763
Total Windows  : 1
Total Pages    : 1
Static Data    : 484760
Message area   : 548259
Total Blocks   : 28306
