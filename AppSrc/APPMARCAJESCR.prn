Compiling Program: C:\DataFlex Projects\MARCAJESAPP\AppSrc\APPMARCAJESCR.src
Memory Available: 2147483646
1>//**************************************************************
1>// WindowsProject.tpl for Spanish translated by Moose Software (www.moose-software.com) 
1>// 28/10/2008 revised for VDF 14.1 by Moose Software  
1>// 13/07/2010 Revised for VDF 16.0 by Moose Software
1>// 05/02/2012 Revised for VDF 17.0 by Moose Software
1>// 13/06/2013 Revised for VDF 17.1 by Moose Software
1>// 02/05/2014 Revised for VDF 18.0 by Moose Software
1>//*************************************************************************************
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 18.2\Pkg\dfallent.pkd)
75339>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardCommandBarSystem.pkg)
75339>>>// these are all the packages used in a standard MDI menubar/toolbar system
75339>>>
75339>>>Use cCJCommandBarSystem.pkg
75339>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardMenuItemClasses.pkg)
75339>>>>>Use Dfpanel.pkg
75339>>>>>Use cCJCommandBarSystem.pkg
75339>>>>>Use LanguageText.pkg
75339>>>>>
75339>>>>>
75339>>>>>Class cCJUndoMenuItem is a cCJMenuItem
75340>>>>>    
75340>>>>>    Procedure Construct_Object
75342>>>>>        Forward Send Construct_Object
75344>>>>>        Set psCaption   to C_$CaptionUndo
75345>>>>>        Set psToolTip to C_$ToolTipUndo
75346>>>>>        Set psDescription to C_$DescUndo
75347>>>>>        Set psImage to "ActionUndo.ico"
75348>>>>>        Set pbActiveUpdate to True
75349>>>>>        Set psCategory to C_$CategoryEdit
75350>>>>>        Set psShortcut to C_$Key_Ctrl_Z
75351>>>>>    End_Procedure
75352>>>>>
75352>>>>>    Procedure OnExecute Variant vCommandBarControl
75354>>>>>        Send Undo of (focus(Self))
75355>>>>>    End_Procedure
75356>>>>>    
75356>>>>>    Function IsEnabled Returns Boolean
75358>>>>>        Boolean bEnabled
75358>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
75359>>>>>        Function_Return bEnabled
75360>>>>>    End_Function
75361>>>>>         
75361>>>>>End_Class
75362>>>>>
75362>>>>>
75362>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
75363>>>>>    
75363>>>>>    Procedure Construct_Object
75365>>>>>        Forward Send Construct_Object
75367>>>>>        Set psCaption   to C_$CaptionDelete
75368>>>>>        Set psToolTip to C_$ToolTipDelete
75369>>>>>        Set psDescription to C_$DescDelete
75370>>>>>        Set psImage to "actionDelete.ico"
75371>>>>>        Set psShortcut to C_$Key_Delete
75372>>>>>        Set pbActiveUpdate to True
75373>>>>>        Set psCategory to C_$CategoryEdit
75374>>>>>    End_Procedure
75375>>>>>
75375>>>>>
75375>>>>>    Procedure OnExecute Variant vCommandBarControl
75377>>>>>        Send Delete of (focus(Self))
75378>>>>>    End_Procedure
75379>>>>>    
75379>>>>>    Function IsEnabled Returns Boolean
75381>>>>>        Boolean bEnabled
75381>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
75382>>>>>        Function_Return bEnabled
75383>>>>>    End_Function
75384>>>>>         
75384>>>>>End_Class
75385>>>>>
75385>>>>>
75385>>>>>Class cCJCutMenuItem is a cCJMenuItem
75386>>>>>    
75386>>>>>    Procedure Construct_Object
75388>>>>>        Forward Send Construct_Object
75390>>>>>        Set psCaption   to C_$CaptionCut
75391>>>>>        Set psToolTip to C_$TooltipCut
75392>>>>>        Set psDescription to C_$DescCut
75393>>>>>        Set psImage to "actionCut.ico"
75394>>>>>        Set psShortcut to C_$Key_Ctrl_X
75395>>>>>        Set pbActiveUpdate to True
75396>>>>>        Set psCategory to C_$CategoryEdit
75397>>>>>    End_Procedure
75398>>>>>
75398>>>>>
75398>>>>>    Procedure OnExecute Variant vCommandBarControl
75400>>>>>        Send Cut of (focus(Self))
75401>>>>>    End_Procedure
75402>>>>>    
75402>>>>>    Function IsEnabled Returns Boolean
75404>>>>>        Boolean bEnabled
75404>>>>>        Get CanCut of (Focus(Self)) to bEnabled
75405>>>>>        Function_Return bEnabled
75406>>>>>    End_Function
75407>>>>>         
75407>>>>>End_Class
75408>>>>>
75408>>>>>
75408>>>>>Class cCJCopyMenuItem is a cCJMenuItem
75409>>>>>    
75409>>>>>    Procedure Construct_Object
75411>>>>>        Forward Send Construct_Object
75413>>>>>        Set psCaption   to C_$CaptionCopy
75414>>>>>        Set psToolTip to C_$ToolTipCopy
75415>>>>>        Set psDescription to C_$DescCopy
75416>>>>>        Set psImage to "actionCopy.ico"
75417>>>>>        Set psShortcut to C_$Key_Ctrl_C
75418>>>>>        Set pbActiveUpdate to True
75419>>>>>        Set psCategory to C_$CategoryEdit
75420>>>>>    End_Procedure
75421>>>>>
75421>>>>>
75421>>>>>    Procedure OnExecute Variant vCommandBarControl
75423>>>>>        Send Copy of (focus(Self))
75424>>>>>    End_Procedure
75425>>>>>    
75425>>>>>    Function IsEnabled Returns Boolean
75427>>>>>        Boolean bEnabled
75427>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
75428>>>>>        Function_Return bEnabled
75429>>>>>    End_Function
75430>>>>>         
75430>>>>>End_Class
75431>>>>>
75431>>>>>
75431>>>>>Class cCJPasteMenuItem is a cCJMenuItem
75432>>>>>    
75432>>>>>    Procedure Construct_Object
75434>>>>>        Forward Send Construct_Object
75436>>>>>        Set psCaption   to C_$CaptionPaste
75437>>>>>        Set psToolTip to C_$ToolTipPaste
75438>>>>>        Set psDescription to C_$DescPaste
75439>>>>>        Set psImage to "actionPaste.ico"
75440>>>>>        Set pbActiveUpdate to True
75441>>>>>        Set psShortcut to C_$Key_Ctrl_V
75442>>>>>        Set psCategory to C_$CategoryEdit
75443>>>>>    End_Procedure
75444>>>>>
75444>>>>>
75444>>>>>    Procedure OnExecute Variant vCommandBarControl
75446>>>>>        Send Paste of (focus(Self))
75447>>>>>    End_Procedure
75448>>>>>    
75448>>>>>    Function IsEnabled Returns Boolean
75450>>>>>        Boolean bEnabled
75450>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
75451>>>>>        Function_Return bEnabled
75452>>>>>    End_Function
75453>>>>>         
75453>>>>>End_Class
75454>>>>>
75454>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
75455>>>>>    
75455>>>>>    Procedure Construct_Object
75457>>>>>        Forward Send Construct_Object
75459>>>>>        Set psCaption   to C_$CaptionSelectAll
75460>>>>>        Set psToolTip to C_$ToolTipSelectAll
75461>>>>>        Set psDescription to C_$DescSelectAll
75462>>>>>        Set pbActiveUpdate to True
75463>>>>>        Set psShortcut to C_$Key_Ctrl_A
75464>>>>>        Set psCategory to C_$CategoryEdit
75465>>>>>    End_Procedure
75466>>>>>
75466>>>>>
75466>>>>>    Procedure OnExecute Variant vCommandBarControl
75468>>>>>        Send Select_All of (focus(Self))
75469>>>>>    End_Procedure
75470>>>>>    
75470>>>>>    Function IsEnabled Returns Boolean
75472>>>>>        Boolean bEnabled
75472>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
75473>>>>>        Function_Return bEnabled
75474>>>>>    End_Function
75475>>>>>         
75475>>>>>End_Class
75476>>>>>
75476>>>>> 
75476>>>>>Class cCJExitMenuItem is a cCJMenuItem
75477>>>>>
75477>>>>>    Procedure Construct_Object
75479>>>>>        Forward Send Construct_Object
75481>>>>>        Set psCaption to C_$CaptionExit
75482>>>>>        Set psToolTip to C_$ToolTipExit
75483>>>>>        Set psDescription to C_$ToolTipExit
75484>>>>>        Set psShortcut to C_$Key_Alt_F4
75485>>>>>        Set psCategory to C_$CategoryFile
75486>>>>>    End_Procedure
75487>>>>>
75487>>>>>    Procedure OnExecute Variant vCommandBarControl
75489>>>>>        Send Exit_Application of Desktop
75490>>>>>    End_Procedure
75491>>>>>
75491>>>>>End_Class           
75492>>>>>
75492>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
75493>>>>>
75493>>>>>    Procedure Construct_Object
75495>>>>>        Forward Send Construct_Object
75497>>>>>        Set psCaption to C_$CaptionHelp
75498>>>>>        Set psDescription to C_$ToolTipHelp
75499>>>>>        Set psToolTip to C_$DescHelp
75500>>>>>        Set psImage to "ActionHelp.ico"
75501>>>>>        Set psShortcut to "F1"
75502>>>>>        Set psCategory to C_$CategoryHelp
75503>>>>>    End_Procedure
75504>>>>>    
75504>>>>>    Procedure OnExecute Variant vCommandBarControl
75506>>>>>        Send Help of (Focus(Self))
75507>>>>>    End_Procedure
75508>>>>>
75508>>>>>End_Class
75509>>>>>
75509>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
75510>>>>>
75510>>>>>    Procedure Construct_Object
75512>>>>>        Forward Send Construct_Object
75514>>>>>        Set psCaption to C_$CaptionAddStatusbar
75515>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
75516>>>>>        Set psDescription to  C_$DescAddStatusbar
75517>>>>>        Set psCategory to C_$CategoryWindow
75518>>>>>    End_Procedure
75519>>>>>
75519>>>>>    Procedure OnExecute Variant vCommandBarControl
75521>>>>>        Handle hoCommandBars hoClientArea
75521>>>>>        Get CommandBarSystemObject to hoCommandBars
75522>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75523>>>>>        If hoClientArea Begin
75525>>>>>            // the clientarea's parent panel has message
75525>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
75526>>>>>        End
75526>>>>>>
75526>>>>>    End_Procedure
75527>>>>>
75527>>>>>     Function IsChecked Returns Boolean
75529>>>>>        Boolean bOn
75529>>>>>        Handle hoCommandBars hoClientArea
75529>>>>>        Get CommandBarSystemObject to hoCommandBars
75530>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75531>>>>>        If hoClientArea Begin
75533>>>>>            // the clientarea's parent panel has message
75533>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
75534>>>>>        End
75534>>>>>>
75534>>>>>        Function_Return bOn
75535>>>>>     End_Function
75536>>>>>End_Class
75537>>>>>
75537>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
75538>>>>>
75538>>>>>    Procedure Construct_Object
75540>>>>>        Forward Send Construct_Object
75542>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
75543>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
75544>>>>>        Set psDescription to C_$DescAutoArrangeIcons
75545>>>>>        Set psCategory to C_$CategoryWindow
75546>>>>>    End_Procedure
75547>>>>>
75547>>>>>    Procedure OnExecute Variant vCommandBarControl
75549>>>>>        Handle hoCommandBars hoClientArea
75549>>>>>        Get CommandBarSystemObject to hoCommandBars
75550>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75551>>>>>        If hoClientArea Begin
75553>>>>>            // the clientarea's parent panel has message
75553>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
75554>>>>>        End
75554>>>>>>
75554>>>>>    End_Procedure
75555>>>>>    
75555>>>>>     Function IsChecked Returns Boolean
75557>>>>>        Boolean bOn
75557>>>>>        Handle hoCommandBars hoClientArea
75557>>>>>        Get CommandBarSystemObject to hoCommandBars
75558>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75559>>>>>        If hoClientArea Begin
75561>>>>>            // the clientarea's parent panel has message
75561>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
75562>>>>>        End
75562>>>>>>
75562>>>>>        Function_Return bOn
75563>>>>>     End_Function
75564>>>>>End_Class
75565>>>>>
75565>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
75566>>>>>
75566>>>>>    Procedure Construct_Object
75568>>>>>        Forward Send Construct_Object
75570>>>>>        Set psCaption to C_$CaptionRestoreMenus
75571>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
75572>>>>>        Set psDescription to C_$DescRestoreMenus
75573>>>>>        Set psCategory to C_$CategoryWindow
75574>>>>>    End_Procedure
75575>>>>>
75575>>>>>    Procedure OnExecute Variant vCommandBarControl
75577>>>>>        Handle hoCommandBars
75577>>>>>        Get CommandBarSystemObject to hoCommandBars
75578>>>>>        Send RestoreLayout of hoCommandBars
75579>>>>>    End_Procedure
75580>>>>>    
75580>>>>>End_Class
75581>>>>>
75581>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
75582>>>>>
75582>>>>>    Procedure Construct_Object
75584>>>>>        Forward Send Construct_Object
75586>>>>>        Set psCaption to C_$CaptionCascade
75587>>>>>        Set psToolTip to C_$ToolTipCascade
75588>>>>>        Set psDescription to  C_$DescCascade
75589>>>>>        Set psImage to "ActionCascade.ico"
75590>>>>>        Set psCategory to C_$CategoryWindow
75591>>>>>    End_Procedure
75592>>>>>    
75592>>>>>    Procedure OnExecute Variant vCommandBarControl
75594>>>>>        Handle hoCommandBars hoClientArea
75594>>>>>        Get CommandBarSystemObject to hoCommandBars
75595>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75596>>>>>        If hoClientArea Begin
75598>>>>>            Send Cascade_Windows of hoClientArea
75599>>>>>        End
75599>>>>>>
75599>>>>>    End_Procedure
75600>>>>>End_Class
75601>>>>>
75601>>>>>Class cCJTileHorizontally is a cCJMenuItem
75602>>>>>
75602>>>>>    Procedure Construct_Object
75604>>>>>        Forward Send Construct_Object
75606>>>>>        Set psCaption to C_$CaptionTileHorizontally 
75607>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
75608>>>>>        Set psDescription to  C_$DescTileHorizontally
75609>>>>>        Set psImage to "ActionTileHorizontally.ico"
75610>>>>>        Set psCategory to C_$CategoryWindow
75611>>>>>    End_Procedure
75612>>>>>
75612>>>>>    Procedure OnExecute Variant vCommandBarControl
75614>>>>>        Handle hoCommandBars hoClientArea
75614>>>>>        Get CommandBarSystemObject to hoCommandBars
75615>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75616>>>>>        If hoClientArea Begin
75618>>>>>            Send Tile_Windows_Horizontal of hoClientArea
75619>>>>>        End
75619>>>>>>
75619>>>>>    End_Procedure
75620>>>>>End_Class
75621>>>>>
75621>>>>>Class cCJTileVertically is a cCJMenuItem
75622>>>>>
75622>>>>>    Procedure Construct_Object
75624>>>>>        Forward Send Construct_Object
75626>>>>>        Set psCaption to C_$CaptionTileVertically  
75627>>>>>        Set psToolTip to C_$ToolTipTileVertically
75628>>>>>        Set psDescription to  C_$DescTileVertically
75629>>>>>        Set psImage to "ActionTileVertically.ico"
75630>>>>>        Set psCategory to C_$CategoryWindow
75631>>>>>    End_Procedure
75632>>>>>
75632>>>>>    Procedure OnExecute Variant vCommandBarControl
75634>>>>>        Handle hoCommandBars hoClientArea
75634>>>>>        Get CommandBarSystemObject to hoCommandBars
75635>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75636>>>>>        If hoClientArea Begin
75638>>>>>            Send Tile_Windows_Vertical of hoClientArea
75639>>>>>        End
75639>>>>>>
75639>>>>>    End_Procedure
75640>>>>>End_Class
75641>>>>>
75641>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
75642>>>>>
75642>>>>>    Procedure Construct_Object
75644>>>>>        Forward Send Construct_Object
75646>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
75647>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
75648>>>>>        Set psDescription to  C_$DescMinimizeWindows
75649>>>>>        Set psCategory to C_$CategoryWindow
75650>>>>>    End_Procedure
75651>>>>>
75651>>>>>    Procedure OnExecute Variant vCommandBarControl
75653>>>>>        Handle hoCommandBars hoClientArea
75653>>>>>        Get CommandBarSystemObject to hoCommandBars
75654>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75655>>>>>        If hoClientArea Begin
75657>>>>>            // the clientarea's parent panel has message
75657>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
75658>>>>>        End
75658>>>>>>
75658>>>>>    End_Procedure
75659>>>>>End_Class
75660>>>>>
75660>>>>>
75660>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
75661>>>>>
75661>>>>>    Procedure Construct_Object
75663>>>>>        Forward Send Construct_Object
75665>>>>>        Set psCaption to C_$CaptionRestoreWindows
75666>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
75667>>>>>        Set psDescription to  C_$DescRestoreWindows
75668>>>>>        Set psCategory to C_$CategoryWindow
75669>>>>>    End_Procedure
75670>>>>>
75670>>>>>    Procedure OnExecute Variant vCommandBarControl
75672>>>>>        Handle hoCommandBars hoClientArea
75672>>>>>        Get CommandBarSystemObject to hoCommandBars
75673>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75674>>>>>        If hoClientArea Begin
75676>>>>>            // the clientarea's parent panel has message
75676>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
75677>>>>>        End
75677>>>>>>
75677>>>>>    End_Procedure
75678>>>>>End_Class
75679>>>>>
75679>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
75680>>>>>
75680>>>>>    Procedure Construct_Object
75682>>>>>        Forward Send Construct_Object
75684>>>>>        Set psCaption to C_$CaptionArrangeIcons  
75685>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
75686>>>>>        Set psDescription to  C_$DescArrangeIcons
75687>>>>>        Set psCategory to C_$CategoryWindow
75688>>>>>    End_Procedure
75689>>>>>
75689>>>>>    Procedure OnExecute Variant vCommandBarControl
75691>>>>>        Handle hoCommandBars hoClientArea
75691>>>>>        Get CommandBarSystemObject to hoCommandBars
75692>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75693>>>>>        If hoClientArea Begin
75695>>>>>            Send Arrange_Icons of hoClientArea
75696>>>>>        End
75696>>>>>>
75696>>>>>    End_Procedure
75697>>>>>
75697>>>>>End_Class
75698>>>>>    
75698>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJAboutMenuItem.pkg)
75698>>>>>Use cCJCommandBarSystem.pkg
75698>>>>>Use LanguageText.pkg
75698>>>>>
75698>>>>>// It is expected that if you use this class that you provide an about object that is
75698>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
75698>>>>>// because you may wish to create your own custom about package.
75698>>>>>
75698>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
75699>>>>>
75699>>>>>    Procedure Construct_Object
75701>>>>>        Forward Send Construct_Object
75703>>>>>        Set psCaption to C_$CaptionAbout
75704>>>>>        Set psDescription to C_$ToolTipAbout
75705>>>>>        Set psToolTip to C_$DescAbout
75706>>>>>        Set psImage to "ActionAbout.ico"
75707>>>>>        Set psCategory to C_$CategoryHelp
75708>>>>>    End_Procedure
75709>>>>>    
75709>>>>>    Procedure OnExecute Variant vCommandBarControl
75711>>>>>        Handle hoCommandBars hoClientArea
75711>>>>>        Get CommandBarSystemObject to hoCommandBars
75712>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75713>>>>>        If hoClientArea Begin
75715>>>>>            Send Activate_About of hoClientArea
75716>>>>>        End
75716>>>>>>
75716>>>>>    End_Procedure
75717>>>>>
75717>>>>>End_Class
75718>>>>>
75718>>>>>
75718>>>Use cCJDeoMenuItemClasses.pkg
75718>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJMDIWindowsMenuItem.pkg)
75718>>>>>Use cCJCommandBarSystem.pkg
75718>>>>>
75718>>>>>Register_Function Client_ID Returns Integer
75718>>>>>
75718>>>>>// only used by cCJMDIWIndowsMenuItem
75718>>>>>Class cCJMDIWindowItem is a cCJMenuItem
75719>>>>>
75719>>>>>    Procedure Construct_Object
75721>>>>>        Forward Send Construct_Object
75723>>>>>        Property Handle phWindow 0 // object id of view
75724>>>>>        Set pbControlFlagNoMovable to True
75725>>>>>        Set pbActiveUpdate to True
75726>>>>>    End_Procedure
75727>>>>>    
75727>>>>>    Procedure OnExecute Variant vCommandBarControl
75729>>>>>        Handle hWindow
75729>>>>>        Get phWindow to hWindow
75730>>>>>        Send Activate_View of hWindow
75731>>>>>    End_Procedure
75732>>>>>    
75732>>>>>End_Class                
75733>>>>>
75733>>>>>
75733>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
75734>>>>>    
75734>>>>>    Procedure Construct_Object
75736>>>>>        Forward Send Construct_Object
75738>>>>>        Property Handle[] phArrayOfWindows
75739>>>>>        Set peControlType to xtpControlPopup
75740>>>>>        Set psCategory to C_$CategoryWindow
75741>>>>>    End_Procedure
75742>>>>>    
75742>>>>>     // This adds MDI windows to the existing menu items.
75742>>>>>     // This removes any existing windows menus and always adds a new set to the end
75742>>>>>
75742>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
75744>>>>>        Handle  hClientArea hView
75744>>>>>        String  sLabel
75744>>>>>        Integer i iWindows
75744>>>>>        Handle[] hArrayOfWindows
75745>>>>>        Variant vItem
75745>>>>>        
75745>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
75745>>>>>        // also assume that destroying an action removes all menu instances of that action
75745>>>>>        Get phArrayOfWindows to hArrayOfWindows
75746>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
75747>>>>>        For i from 0 to (iWindows-1)
75753>>>>>>
75753>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
75754>>>>>        Loop
75755>>>>>>
75755>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
75756>>>>>
75756>>>>>        // Add all views to this menu. Create the action and add the item
75756>>>>>        Move 0 to i
75757>>>>>        Get Client_Id to hClientArea // object id of client area
75758>>>>>        If (hClientArea > 0) Begin
75760>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
75761>>>>>            While (hView <> 0)
75765>>>>>                If (Active_State(hView)) Begin
75767>>>>>                    // create the action
75767>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
75768>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
75769>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
75770>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
75771>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
75773>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
75774>>>>>                    End
75774>>>>>>
75774>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
75775>>>>>                    If (i=0) Begin
75777>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
75778>>>>>                    End
75778>>>>>>
75778>>>>>                    // Create a menu item for this action
75778>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
75779>>>>>                    Increment i
75780>>>>>                End
75780>>>>>>
75780>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
75781>>>>>            Loop
75782>>>>>>
75782>>>>>        End
75782>>>>>>
75782>>>>>
75782>>>>>        Set phArrayOfWindows to hArrayOfWindows
75783>>>>>
75783>>>>>     End_Procedure
75784>>>>>     
75784>>>>>End_Class
75785>>>>>
75785>
75785>Object oHtmlHelp is a cHtmlHelp
75787>End_Object
75788>
75788>Object oApplication is a cApplication
75790>    Set peHelpType to htHtmlHelp
75791>End_Object
75792>
75792>Object oToolTipController is a cToolTipController
75794>    Move Self to ghoToolTipController
75795>End_Object
75796>
75796>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oEditContextMenu.pkg)
75796>>>Use cCJStandardMenuItemClasses.pkg
75796>>>
75796>>>Object oEditContextMenu is a cCJContextMenu
75798>>>    
75798>>>    Move Self to Default_Form_Floating_Menu_ID
75799>>>    
75799>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75801>>>    End_Object
75802>>>    
75802>>>    Object oCutMenuItem is a cCJCutMenuItem
75804>>>        Set pbControlBeginGroup to True
75805>>>    End_Object
75806>>>    
75806>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75808>>>    End_Object
75809>>>
75809>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75811>>>    End_Object
75812>>>
75812>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75814>>>    End_Object
75815>>>
75815>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75817>>>        Set pbControlBeginGroup to True
75818>>>    End_Object
75819>>>
75819>>>End_Object
75820>>>
75820>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oDEOEditContextMenu17.pkg)
75820>>>Use Windows.pkg
75820>>>Use cCJStandardMenuItemClasses.pkg
75820>>>Use cCJDeoMenuItemClasses.pkg
75820>>>
75820>>>
75820>>>Object oDEOEditContextMenu17 is a cCJContextMenu
75822>>>    
75822>>>    Move Self to Default_dbFloating_Menu_ID
75823>>>    
75823>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75825>>>    End_Object
75826>>>    
75826>>>    Object oCutMenuItem is a cCJCutMenuItem
75828>>>        Set pbControlBeginGroup to True
75829>>>    End_Object
75830>>>    
75830>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75832>>>    End_Object
75833>>>
75833>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75835>>>    End_Object
75836>>>
75836>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75838>>>    End_Object
75839>>>
75839>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75841>>>        Set pbControlBeginGroup to True
75842>>>    End_Object
75843>>>
75843>>>    Object oPromptMenuItem is a cCJPromptMenuItem
75845>>>        Set pbControlBeginGroup to True
75846>>>    End_Object
75847>>>
75847>>>    Object oFindNextMenu is a cCJFindNextMenuItem
75849>>>        Set pbControlBeginGroup to True
75850>>>    End_Object
75851>>>
75851>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75853>>>    End_Object
75854>>>
75854>>>    Object oClearMenuItem is a cCJClearMenuItem
75856>>>        Set pbControlBeginGroup to True
75857>>>    End_Object
75858>>>
75858>>>    Object oClearAllMenu is a cCJClearAllMenuItem
75860>>>    End_Object
75861>>>
75861>>>    Object oSaveMenu is a cCJSaveMenuItem
75863>>>    End_Object
75864>>>    
75864>>>    Object oDeleteMenu is a cCJDeleteMenuItem
75866>>>    End_Object
75867>>>
75867>>>    Object oRememberitem is a cCJRememberFieldMenuItem
75869>>>        Set pbControlBeginGroup to True
75870>>>    End_Object
75871>>>
75871>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
75873>>>    End_Object
75874>>>
75874>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
75876>>>    End_Object
75877>>>
75877>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
75879>>>    End_Object
75880>>>
75880>>>End_Object
75881>
75881>Object oMain is a Panel
75883>    Set Label to "Mi Proyecto"
75884>    Set Location to 4 3
75885>    Set Size to 300 589
75886>
75886>    Object oCommandBarSystem is a cCJCommandBarSystem
75888>        Set pbTimerUpdate to True
75889>
75889>        Procedure OnCreateCommandBars
75892>            Handle hoOptions
75892>            Get OptionsObject to hoOptions
75893>            Forward Send OnCreateCommandBars
75895>        End_Procedure
75896>
75896>        Object oMenuBar is a cCJMenuBar
75898>
75898>            Object oFileMenu is a cCJMenuItem
75900>                Set peControlType to xtpControlPopup          
75901>                Set psCaption   to "Archivo"    // &F   <--------------------------
75902>                Set psDescription to "Buscar, Grabar, Borrar, limpiar informaci¢n o salir de esta aplicaci¢n."
75903>                Set psCategory to "Men£s"
75904>
75904>                Object oClearMenuItem is a cCJClearMenuItem
75906>                    Set pbAddToDesignerMenu to True
75907>                End_Object
75908>
75908>                Object oClearAllMenu is a cCJClearAllMenuItem
75910>                    Set pbAddToDesignerMenu to True
75911>                End_Object
75912>
75912>                Object oPromptMenuItem is a cCJPromptMenuItem
75914>                    Set pbAddToDesignerMenu to True
75915>                    Set pbControlBeginGroup to True
75916>                End_Object
75917>
75917>                Object oFindMenuItem is a cCJFindMenuItem
75919>                    Set pbAddToDesignerMenu to True
75920>                    Set pbControlBeginGroup to True
75921>                End_Object
75922>
75922>                Object oFindNextMenu is a cCJFindNextMenuItem
75924>                    Set pbAddToDesignerMenu to True
75925>                End_Object
75926>
75926>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75928>                    Set pbAddToDesignerMenu to True
75929>                End_Object
75930>
75930>                Object oFindFirstMenu is a cCJFindFirstMenuItem
75932>                    Set pbAddToDesignerMenu to True
75933>                End_Object
75934>
75934>                Object oFindLastMenu is a cCJFindLastMenuItem
75936>                    Set pbAddToDesignerMenu to True
75937>                End_Object
75938>
75938>                Object oSaveMenuItem is a cCJSaveMenuItem
75940>                    Set pbAddToDesignerMenu to True
75941>                    Set pbControlBeginGroup to True
75942>                End_Object
75943>
75943>                Object oDeleteMenuItem is a cCJDeleteMenuItem
75945>                    Set pbAddToDesignerMenu to True
75946>                End_Object
75947>
75947>                Object oExitMenu is a cCJExitMenuItem
75949>                    Set pbControlBeginGroup to True
75950>                End_Object
75951>
75951>            End_Object
75952>
75952>            Object oViewMenu is a cCJMenuItem
75954>                Set peControlType to xtpControlPopup
75955>                Set psCaption to "&Vistas"
75956>                Set psToolTip to "Vistas"
75957>               Set psDescription to "Vistas disponibles"
75958>
75958>               Object oEMPLEADOSMenuItem is a cCJMenuItem
75960>                   Set psCaption to "EMPLEADOS"
75961>                   Set psTooltip to "EMPLEADOS"
75962>               
75962>                   Procedure OnExecute Variant vCommandBarControl
75965>                       Handle hoClient
75965>                       Get Client_Id to hoClient
75966>                       Send Activate_EMPLEADOS of hoClient
75967>                   End_Procedure
75968>               End_Object
75969>
75969>               Object oMARCAJESMenuItem is a cCJMenuItem
75971>                   Set psCaption to "MARCAJES"
75972>                   Set psTooltip to "MARCAJES"
75973>               
75973>                   Procedure OnExecute Variant vCommandBarControl
75976>                       Handle hoClient
75976>                       Get Client_Id to hoClient
75977>                       Send Activate_MARCAJES of hoClient
75978>                   End_Procedure
75979>               End_Object
75980>            End_Object
75981>            
75981>            Object oReportMenu is a cCJMenuItem
75983>                Set peControlType to xtpControlPopup
75984>                Set psCaption to "&Informes"
75985>                Set psToolTip to "Informes"
75986>                Set psDescription to "Informes disponibles"
75987>
75987>                Object oMARCAJESMenuItem is a cCJMenuItem
75989>                    Set psCaption to "MARCAJES"
75990>                    Set psTooltip to "MARCAJES"
75991>                
75991>                    Procedure OnExecute Variant vCommandBarControl
75994>                        Handle hoClient
75994>                        Get Client_Id to hoClient
75995>                        Send Activate_MARCAJES of hoClient
75996>                    End_Procedure
75997>                End_Object
75998>
75998>                Object oPruebaMenuItem is a cCJMenuItem
76000>                    Set psCaption to "Prueba"
76001>                    Set psTooltip to "Prueba"
76002>                
76002>                    Procedure OnExecute Variant vCommandBarControl
76005>                        Handle hoClient
76005>                        Get Client_Id to hoClient
76006>                        Send Activate_Prueba of hoClient
76007>                    End_Procedure
76008>                End_Object
76009>
76009>                Object oRMarcajeMenuItem is a cCJMenuItem
76011>                    Set psCaption to "R_Marcaje"
76012>                    Set psTooltip to "R_Marcaje"
76013>                
76013>                    Procedure OnExecute Variant vCommandBarControl
76016>                        Handle hoClient
76016>                        Get Client_Id to hoClient
76017>                        Send Activate_R_Marcaje of hoClient
76018>                    End_Procedure
76019>                End_Object
76020>            End_Object
76021>
76021>            Object oNavigateMenu is a cCJMenuItem
76023>                Set peControlType to xtpControlPopup      
76024>                Set psCaption to "&Navegar"    
76025>                Set psTooltip to "Navegar"    
76026>                Set psDescription to "Desplazarse a diferentes areas de la aplicaci¢n"
76027>
76027>                Object oNextAreaMenu is a cCJNextAreaMenu
76029>                End_Object
76030>
76030>                Object oPriorAreaMenu is a cCJPriorAreaMenu
76032>                End_Object
76033>
76033>                Object oNextViewMenu is a cCJNextViewMenu
76035>                End_Object
76036>
76036>                Object oPriorViewMenu is a cCJPriorViewMenu
76038>                End_Object
76039>
76039>                Object oPromptMenu is a cCJPromptMenuItem
76041>                    Set pbControlBeginGroup to True
76042>                End_Object
76043>
76043>                Object oZoomMenu is a cCJZoomMenuItem
76045>                End_Object
76046>
76046>            End_Object
76047>
76047>            Object oWindowMenu is a cCJMDIWindowsMenuItem
76049>                Set peControlType to xtpControlPopup
76050>                Set psCaption to "Ventana"      // &W <---------------
76051>                Set psToolTip to "Ventana"
76052>                Set psDescription to "Muestre vistas actuales y fije otras opciones de visualizaci¢n."
76053>
76053>                // These are the static windows items. More will be created in onInitPopup 
76053>                Object oDisplayOptionsMenu is a cCJMenuItem
76055>                    Set peControlType to xtpControlPopup          
76056>                    Set psCaption to "Opciones de visualizaci¢n"  // &D <--------------
76057>                    Set psToolTip to "Opciones de visualizaci¢n"
76058>                    Set psDescription to "Fije opciones de visualizaci¢n"
76059>
76059>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
76061>                    End_Object
76062>
76062>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
76064>                    End_Object
76065>
76065>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
76067>                        Set pbControlBeginGroup to True
76068>                    End_Object
76069>
76069>                End_Object
76070>
76070>                Object oCascadeMenu is a cCJCascadeMenuItem
76072>                    Set pbControlBeginGroup to True
76073>                End_Object
76074>
76074>                Object oHorizTile is a cCJTileHorizontally
76076>                End_Object
76077>
76077>                Object oVertTile is a cCJTileVertically
76079>                End_Object
76080>
76080>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
76082>                    Set pbControlBeginGroup to True
76083>                End_Object
76084>
76084>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
76086>                End_Object
76087>
76087>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
76089>                    Set pbControlBeginGroup to True
76090>                End_Object
76091>
76091>            End_Object
76092>
76092>            Object oHelpMenu is a cCJMenuItem
76094>                Set peControlType to xtpControlPopup    
76095>                Set psCaption to "&Ayuda"   // &H    <----------------------
76096>                Set psDescription to "Informaci¢n para aprender y para usar esta aplicaci¢n VDF"
76097>                Set psToolTip to "Ayuda"
76098>
76098>                Object oHelpMenuItem is a cCJHelpMenuItem 
76100>                End_Object
76101>
76101>                Object oAboutMenuItem is a cCJAboutMenuItem
76103>                End_Object
76104>
76104>            End_Object
76105>
76105>        End_Object
76106>
76106>        Object oFindToolBar is a cCJToolbar
76108>            Set psTitle to "Barra de herramientas de b£squeda"
76109>
76109>            Object oFindFirstTool is a cCJFindFirstMenuItem
76111>            End_Object
76112>
76112>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
76114>            End_Object
76115>
76115>            Object oFindMenuTool is a cCJFindMenuItem
76117>            End_Object
76118>
76118>            Object oFindNextTool is a cCJFindNextMenuItem
76120>            End_Object
76121>
76121>            Object oFindLastTool is a cCJFindLastMenuItem
76123>            End_Object
76124>
76124>            Object oPromptToolItem is a cCJPromptMenuItem
76126>                Set pbControlBeginGroup to True
76127>            End_Object
76128>
76128>        End_Object
76129>
76129>        Object oFileToolBar is a cCJToolbar
76131>            Set psTitle to "Barra de herramientas de introducci¢n de datos"
76132>
76132>            Object oClearToolItem is a cCJClearMenuItem
76134>                Set peControlStyle to xtpButtonIconAndCaption
76135>            End_Object
76136>
76136>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
76138>                Set peControlStyle to xtpButtonIconAndCaption
76139>            End_Object
76140>
76140>            Object oSaveToolItem is a cCJSaveMenuItem
76142>                Set peControlStyle to xtpButtonIconAndCaption
76143>                Set pbControlBeginGroup to True
76144>            End_Object
76145>
76145>            Object oDeleteToolItem is a cCJDeleteMenuItem
76147>                Set peControlStyle to xtpButtonIconAndCaption
76148>            End_Object
76149>
76149>        End_Object
76150>
76150>        Object oEditToolBar is a cCJToolbar
76152>            Set psTitle to "Barra de herramientas de edici¢n"
76153>
76153>            Object oCutToolbarItem is a cCJCutMenuItem
76155>            End_Object
76156>
76156>            Object oCopyToolbarItem is a cCJCopyMenuItem
76158>            End_Object
76159>
76159>            Object oPasteToolbarItem is a cCJPasteMenuItem
76161>            End_Object
76162>
76162>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
76164>                Set pbControlBeginGroup to True
76165>            End_Object
76166>
76166>        End_Object
76167>
76167>        Object oRememberToolbar is a cCJToolbar
76169>            Set psTitle to C_$Remember
76170>
76170>            Object oRememberItems is a cCJMenuItem
76172>
76172>                Set peControlType to xtpControlPopup
76173>                Set peControlStyle to xtpButtonCaption
76174>                Set psCaption to C_$Remember
76175>                
76175>                Object oMenuItem is a cCJRememberFieldMenuItem
76177>                    Set peControlStyle to xtpButtonIconAndCaption
76178>                End_Object
76179>                
76179>                Object oMenuItem is a cCJRememberLastFieldMenuItem
76181>                    Set peControlStyle to xtpButtonIconAndCaption
76182>                End_Object
76183>                
76183>                Object oMenuItem is a cCJUnRememberFieldMenuItem
76185>                    Set peControlStyle to xtpButtonIconAndCaption
76186>                End_Object
76187>                
76187>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
76189>                    Set peControlStyle to xtpButtonIconAndCaption
76190>                End_Object
76191>
76191>            End_Object
76192>            
76192>        End_Object
76193>        
76193>        Object oStatusBar is a cCJStatusBar
76195>
76195>            Object oStatusPane1 is a cCJStatusBarPane
76197>                Set piID to sbpIDIdlePane
76198>                Set pbStyleStretch to True
76199>            End_Object
76200>
76200>            Object oStatusPane2 is a cCJStatusBarPane
76202>                Set phoViewPane to Self
76203>                Set pbStyleStretch to True
76204>            End_Object
76205>
76205>        End_Object
76206>
76206>    End_Object
76207>
76207>    Object oClientArea is a ClientArea
76209>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\StdAbout.pkg)
76209>>>//************************************************************************
76209>>>// Confidential Trade Secret.
76209>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76209>>>// as an unpublished work.  All rights reserved.
76209>>>// DataFlex is a registered trademark of Data Access Corporation.
76209>>>//
76209>>>//************************************************************************
76209>>>//************************************************************************
76209>>>//
76209>>>// $File name  : StdAbout.pkg
76209>>>// $File title : Standard about object package for VDF
76209>>>// Notice      :
76209>>>// $Author(s)  : John Tuohy
76209>>>//
76209>>>// $Rev History
76209>>>//
76209>>>// JT 06/27/97   File created
76209>>>//************************************************************************
76209>>>
76209>>>// This provides a quick and simple way to create an about package for a program.
76209>>>// You need to create a message inside you client area called Activate_About.
76209>>>// Within this message you should send the message DoAbout passing needed
76209>>>// string information.
76209>>>//
76209>>>//       Procedure Activate_About
76209>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
76209>>>//       End_Procedure
76209>>>//    where: sTitle =     Name of application. If none provided, uses caption
76209>>>//                        bar title
76209>>>//           sVersion   = Version Line. If none provided, will be blank
76209>>>//           sCopyRight = Copyright Line. If none provided, will be blank
76209>>>//           sAuthor    = Author name, blank if none provided
76209>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
76209>>>//                        is used.
76209>>>// It is expected that you will place this in your own object package. For
76209>>>// example an order about package may look like this:
76209>>>//
76209>>>//   // OrderAbout.pkg
76209>>>//   Use StdAbout.pkg
76209>>>//   Procedure Activate_About
76209>>>//      String sTitle sCopyright sVersion sAuthor
76209>>>//      Move "My Order Entry System" to sTitle
76209>>>//      Move "Version 2.1" to sVersion
76209>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
76209>>>//      Move "John Smith"  to sAuthor
76209>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
76209>>>//   end_procedure
76209>>>//   // end of file.
76209>>>
76209>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\Dfabout.pkg)
76209>>>>>//************************************************************************
76209>>>>>// Confidential Trade Secret.
76209>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76209>>>>>// as an unpublished work.  All rights reserved.
76209>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
76209>>>>>//
76209>>>>>//************************************************************************
76209>>>>>//************************************************************************
76209>>>>>//
76209>>>>>// $File name  : DfAbout.pkg
76209>>>>>// $File title : About class support
76209>>>>>// Notice      :
76209>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
76209>>>>>//
76209>>>>>// $Rev History
76209>>>>>//
76209>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
76209>>>>>//                Windows for the size first. 
76209>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
76209>>>>>//                with anchor technique. Removed unnessary property in the
76209>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
76209>>>>>//                object To better look in Windows XP. Repositioned the close
76209>>>>>//                button in the sysinfo dialog To line up with the display area
76209>>>>>//                Replaced obsolete code and techniques. Removed dead code.
76209>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
76209>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
76209>>>>>//                the global Workspace object, if it is present
76209>>>>>// JJT 11/05/98   Added version information
76209>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
76209>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
76209>>>>>//                workspace package.
76209>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
76209>>>>>//                class can create this object.
76209>>>>>//                Cleaned up the interface (used correct classes and messages)
76209>>>>>//                Added workspace reporting support To sys-info.
76209>>>>>//                Turned off wrapping in the sys-info editor.
76209>>>>>// KR  ??/??/96   File created
76209>>>>>//************************************************************************
76209>>>>>Use LanguageText.pkg
76209>>>>>Use Windows.pkg
76209>>>>>Use DFbitmap.pkg
76209>>>>>Use GlobalFunctionsProcedures.pkg
76209>>>>>Use cTextEdit.pkg
76209>>>>>
76209>>>>>Use cli.pkg
Including file: cli.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cli.pkg)
76209>>>>>>>//*****************************************************************************
76209>>>>>>>//*** CLI.PKG                                                               ***
76209>>>>>>>//***                                                                       ***
76209>>>>>>>//*** Author: Ben Weijers                                                   ***
76209>>>>>>>//***         Data Access Nederland                                         ***
76209>>>>>>>//***         10 September 1998                                             ***
76209>>>>>>>//***                                                                       ***
76209>>>>>>>//*** Purpose:                                                              ***
76209>>>>>>>//***   CLI specific functionality. There are several connectivity kits     ***
76209>>>>>>>//***   based on  SQL/92 CLI. Those are:                                    ***
76209>>>>>>>//***    - ODBC_DRV  The Data Access CK for ODBC                            ***
76209>>>>>>>//***    - DB2_DRV   The Data Access CK for DB2                             ***
76209>>>>>>>//***    - MSSQLDRV  The Data Access CK for Microsoft SQL Server            ***
76209>>>>>>>//***                                                                       ***
76209>>>>>>>//***   This package defines the common functionality for all CLI based     ***
76209>>>>>>>//***   drivers.                                                            ***
76209>>>>>>>//***                                                                       ***
76209>>>>>>>//***   Updated:  May 23rd 2008 (Current CK build: 5.0.0.53 )               ***
76209>>>>>>>//***             Added NULLABLE and DEFAULT attributes for DATETIME type   ***
76209>>>>>>>//***   Updated:  Apr  6th 2009 (Current CK build: 5.0.0.61 )               ***
76209>>>>>>>//***             Added DF_DRIVER_MATCH_CLIENT_SERVER_VERSION attribute     ***
76209>>>>>>>//***                   DF_DRIVER_SQLSERVER_CLIENT_VERSION    attribute     ***
76209>>>>>>>//***   Updated:  Mar 30th 2012 (Current CK build: 5.1.0.93 )               ***
76209>>>>>>>//***             Added SQLSERVER2012CLIENT return value for                ***
76209>>>>>>>//***             DF_DRIVER_SQLSERVER_CLIENT_VERSION attribute              ***
76209>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
76209>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
76209>>>>>>>//***             mssqldrv.pkg                                              ***
76209>>>>>>>//***   Updated:  april 23, 2013 (Current CK build: 6.0.0.4)                ***
76209>>>>>>>//***             Added type mappings attributes                            ***
76209>>>>>>>//***   Updated:  october 11, 2013 (Current CK build: 6.0.0.18)             ***
76209>>>>>>>//***             Added DF_FILE_SQL_FILTER_EQ attribute                     ***
76209>>>>>>>//*****************************************************************************
76209>>>>>>>
76209>>>>>>>//*** We are not using ifndef below because that is not supported in Character Mode
76209>>>>>>>//*** Driver attributes
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>//------------------------------------------------------------
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>//-------------------------------------
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>//*** Replacement for logical column number that indicates all columns
76209>>>>>>>
76209>>>>>>>//*** Possible DF_FILE_GENERATE_RECORD_ID_METHOD values
76209>>>>>>>
76209>>>>>>>//*** Possible DF_FIELD_READ_ONLY values
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>//*** Possible DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA values
76209>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK5        1       
76209>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK6        2   
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>// Moved to Mssqldrv.pkg
76209>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
76209>>>>>>>//#REPLACE SQLSERVERUNKNOWNCLIENT  0
76209>>>>>>>//#REPLACE SQLSERVER2000CLIENT     8          //   "SQL Server"
76209>>>>>>>//#REPLACE SQLSERVER2005CLIENT     9          //   "SQL Native Client"
76209>>>>>>>//#REPLACE SQLSERVER2008CLIENT    10          //   "SQL Server Native Client 10.0"
76209>>>>>>>//#Replace SQLSERVER2012CLIENT    11          //   "SQL Server Native Client 11.0"
76209>>>>>>>
76209>>>>>>>//*** Possible SQL Column type values
76209>>>>>>>Define SQL_UNKNOWN_TYPE   For    0
76209>>>>>>>Define SQL_CHAR           For    1
76209>>>>>>>Define SQL_NUMERIC        For    2
76209>>>>>>>Define SQL_DECIMAL        For    3
76209>>>>>>>Define SQL_INTEGER        For    4
76209>>>>>>>Define SQL_SMALLINT       For    5
76209>>>>>>>Define SQL_FLOAT          For    6
76209>>>>>>>Define SQL_REAL           For    7
76209>>>>>>>Define SQL_DOUBLE         For    8
76209>>>>>>>Define SQL_DATETIME       For    9
76209>>>>>>>Define SQL_VARCHAR        For   12
76209>>>>>>>Define SQL_TYPE_DATE      For   91
76209>>>>>>>Define SQL_TYPE_TIME      For   92
76209>>>>>>>Define SQL_TYPE_TIMESTAMP for   93
76209>>>>>>>// Moved to mssqldrv.pkg
76209>>>>>>>//Define SQL_TYPE_TIMESTAMP2 for   (-200) //SQL server datetime2 type */
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>Define SQL_DATE           For    9
76209>>>>>>>Define SQL_INTERVAL       For   10
76209>>>>>>>Define SQL_TIME           For   10
76209>>>>>>>Define SQL_TIMESTAMP      For   11
76209>>>>>>>Define SQL_LONGVARCHAR    For  (-1)
76209>>>>>>>Define SQL_BINARY         For  (-2)
76209>>>>>>>Define SQL_VARBINARY      For  (-3)
76209>>>>>>>Define SQL_LONGVARBINARY  For  (-4)
76209>>>>>>>Define SQL_BIGINT         For  (-5)
76209>>>>>>>Define SQL_TINYINT        For  (-6)
76209>>>>>>>Define SQL_BIT            For  (-7)
76209>>>>>>>Define SQL_WCHAR          For  (-8)
76209>>>>>>>Define SQL_WVARCHAR       For  (-9)
76209>>>>>>>Define SQL_WLONGVARCHAR   For (-10)
76209>>>>>>>Define SQL_GUID           For (-11)
76209>>>>>>>
76209>>>>>>>//*** Driver level attributes
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>//*** Error number constants
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>//*** Call driver function identifiers
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>//*** Init data source types
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>//*** Dummy strings used in the commands
76209>>>>>>>    String  CLI$StrDummy 255
76209>>>>>>>    Integer CLI$IntDummy
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>//*****************************************************************************
76209>>>>>>>//*** CLI_SetConstraint <FileNum> <NewState>                                ***
76209>>>>>>>//***                                                                       ***
76209>>>>>>>//***   Setup a constraint for a file.                                      ***
76209>>>>>>>//*****************************************************************************
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>//*****************************************************************************
76209>>>>>>>//*** CLI_Set_Driver_Atrtribute / CLI_Get_Driver_Attribute                  ***
76209>>>>>>>//***                                                                       ***
76209>>>>>>>//*** Set or get an attribute at driver level. These attributes, when set,  ***
76209>>>>>>>//*** will be set for the remainder of the session or until set again. To   ***
76209>>>>>>>//*** permanently set driver level attributes change the driver             ***
76209>>>>>>>//*** configuration file.                                                   ***
76209>>>>>>>//*****************************************************************************
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>//*****************************************************************************
76209>>>>>>>//*** Class  : cCLIHandler                                                  ***
76209>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76209>>>>>>>//***          call several CLI releated methods.                           ***
76209>>>>>>>//*****************************************************************************
76209>>>>>>>
76209>>>>>>>Class cCLIHandler Is An Array
76210>>>>>>>
76210>>>>>>>    Procedure Construct_Object Integer iImage
76212>>>>>>>        Forward Send Construct_object iImage
76214>>>>>>>
76214>>>>>>>        Property String  psDriverID       Public ""
76215>>>>>>>    End_Procedure // Construct_Object
76216>>>>>>>
76216>>>>>>>
76216>>>>>>>
76216>>>>>>>    //***
76216>>>>>>>    //*** Fucntion: CKRevsion
76216>>>>>>>    //*** Purpose : The revsion of a CLI Connectivity Kit
76216>>>>>>>    //***
76216>>>>>>>
76216>>>>>>>    Function CKRevision Returns String
76218>>>>>>>        Local String  sDriverID
76218>>>>>>>        Local String  sRevision
76218>>>>>>>        Local String  sVoid
76218>>>>>>>        Local Integer iRetval
76218>>>>>>>
76218>>>>>>>        Get psDriverID To sDriverID
76219>>>>>>>        If (sDRiverID <> "") Begin
76221>>>>>>>            Move (Repeat(" ", 255)) To sRevision
76222>>>>>>>            Call_Driver 0 sDRiverID Function CLI_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76227>>>>>>>        End
76227>>>>>>>>
76227>>>>>>>
76227>>>>>>>        Function_Return sRevision
76228>>>>>>>    End_Function // CKRevision
76229>>>>>>>
76229>>>>>>>
76229>>>>>>>
76229>>>>>>>    //***
76229>>>>>>>    //*** Function: ExtractPartFromRevision
76229>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76229>>>>>>>    //***
76229>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76229>>>>>>>    //***
76229>>>>>>>
76229>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76231>>>>>>>        Local Integer iPartRev
76231>>>>>>>        Local Integer iCurrentPart
76231>>>>>>>        Local Integer iSeparatorPos
76231>>>>>>>
76231>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76234>>>>>>>
76234>>>>>>>        Move 0 To iCurrentPart
76235>>>>>>>        Repeat
76235>>>>>>>>
76235>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76236>>>>>>>            If (iSeparatorPos > 0) Begin
76238>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76239>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76240>>>>>>>                Increment iCurrentPart
76241>>>>>>>            End
76241>>>>>>>>
76241>>>>>>>            Else If (sRevision <> "") Begin
76244>>>>>>>                Move sRevision To iPartRev
76245>>>>>>>                Move "" To sRevision
76246>>>>>>>                Increment iCurrentPart
76247>>>>>>>            End
76247>>>>>>>>
76247>>>>>>>            Else ;                Move -1 To iPartRev
76249>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76251>>>>>>>
76251>>>>>>>        Function_Return iPartRev
76252>>>>>>>    End_Function // EcxtractPartFromRevision
76253>>>>>>>
76253>>>>>>>
76253>>>>>>>
76253>>>>>>>    //***
76253>>>>>>>    //*** Function: CKMajorRevision
76253>>>>>>>    //*** Purpose : Returns the major revision of the CK
76253>>>>>>>    //***
76253>>>>>>>
76253>>>>>>>    Function CKMajorRevision Returns Integer
76255>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76256>>>>>>>    End_Function // CKMajorRevision
76257>>>>>>>
76257>>>>>>>
76257>>>>>>>
76257>>>>>>>    //***
76257>>>>>>>    //*** Function: CKMinorRevision
76257>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76257>>>>>>>    //***
76257>>>>>>>
76257>>>>>>>    Function CKMinorRevision Returns Integer
76259>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76260>>>>>>>    End_Function // CKMinorRevision
76261>>>>>>>
76261>>>>>>>
76261>>>>>>>
76261>>>>>>>    //***
76261>>>>>>>    //*** Function: CKReleaseRevision
76261>>>>>>>    //*** Purpose : Returns the release revision of the CK
76261>>>>>>>    //***
76261>>>>>>>
76261>>>>>>>    Function CKReleaseRevision Returns Integer
76263>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76264>>>>>>>    End_Function // CKReleaseRevision
76265>>>>>>>
76265>>>>>>>
76265>>>>>>>
76265>>>>>>>    //***
76265>>>>>>>    //*** Function: CKBuildRevision
76265>>>>>>>    //*** Purpose : Returns the major revision of the CK
76265>>>>>>>    //***
76265>>>>>>>
76265>>>>>>>    Function CKBuildRevision Returns Integer
76267>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76268>>>>>>>    End_Function // CKBuildRevision
76269>>>>>>>
76269>>>>>>>
76269>>>>>>>
76269>>>>>>>    //***
76269>>>>>>>    //*** Function: IsMinimalRevision
76269>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76269>>>>>>>    //***
76269>>>>>>>
76269>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76271>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76274>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76277>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76280>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76283>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76286>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76290>>>>>>>            End
76290>>>>>>>>
76290>>>>>>>        End
76290>>>>>>>>
76290>>>>>>>
76290>>>>>>>        Function_Return (FALSE)
76291>>>>>>>    End_Function // IsMinimalRevision
76292>>>>>>>
76292>>>>>>>
76292>>>>>>>
76292>>>>>>>    //***
76292>>>>>>>    //*** Function: RegistrationName
76292>>>>>>>    //*** Purpose : Returns the Connectiivty Kit registration name.
76292>>>>>>>    //***
76292>>>>>>>
76292>>>>>>>    Function RegistrationName Returns String
76294>>>>>>>        Local String  sRegistration
76294>>>>>>>        Local String  sDRiverId
76294>>>>>>>        Local String  sVoid
76294>>>>>>>        Local Integer iRetval
76294>>>>>>>
76294>>>>>>>        Get psDriverID To sDriverID
76295>>>>>>>        If (sDRiverID <> "") Begin
76297>>>>>>>            Move (Repeat(" ", 255)) To sRegistration
76298>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETREGNAME Callback 0 Passing sRegistration sVoid 0 Result iRetval
76303>>>>>>>        End
76303>>>>>>>>
76303>>>>>>>
76303>>>>>>>        Function_Return sRegistration
76304>>>>>>>    End_Function // RegistrationName
76305>>>>>>>
76305>>>>>>>
76305>>>>>>>
76305>>>>>>>    //***
76305>>>>>>>    //*** Function: SerialNumber
76305>>>>>>>    //*** Purpose : Returns the Connectiivty Kit serial number.
76305>>>>>>>    //***
76305>>>>>>>
76305>>>>>>>    Function SerialNumber Returns Integer
76307>>>>>>>        Local String  sDRiverId
76307>>>>>>>        Local String  sVoid
76307>>>>>>>        Local Integer iRetval
76307>>>>>>>
76307>>>>>>>        Get psDriverID To sDriverID
76308>>>>>>>        If (sDRiverID <> "") Begin
76310>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETSERIALNUM Callback 0 Passing sVoid sVoid 0 Result iRetval
76315>>>>>>>        End
76315>>>>>>>>
76315>>>>>>>
76315>>>>>>>        Function_Return iRetval
76316>>>>>>>    End_Function // SerialNumber
76317>>>>>>>
76317>>>>>>>
76317>>>>>>>
76317>>>>>>>    //***
76317>>>>>>>    //*** Function: MaxUsers
76317>>>>>>>    //*** Purpose : Returns the Connectiivty Kit maximum number of users.
76317>>>>>>>    //***
76317>>>>>>>
76317>>>>>>>    Function MaxUsers Returns Integer
76319>>>>>>>        Local String  sDRiverId
76319>>>>>>>        Local String  sVoid
76319>>>>>>>        Local Integer iRetval
76319>>>>>>>
76319>>>>>>>        Get psDriverID To sDriverID
76320>>>>>>>        If (sDRiverID <> "") Begin
76322>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETMAXUSERS Callback 0 Passing sVoid sVoid 0 Result iRetval
76327>>>>>>>        End
76327>>>>>>>>
76327>>>>>>>
76327>>>>>>>        Function_Return iRetval
76328>>>>>>>    End_Function // MaxUsers
76329>>>>>>>
76329>>>>>>>
76329>>>>>>>
76329>>>>>>>    //***
76329>>>>>>>    //*** Procedure: DumpStatus
76329>>>>>>>    //*** Purpose  : Dump the current status of the drver in the passed disk file.
76329>>>>>>>    //***
76329>>>>>>>
76329>>>>>>>    Procedure DumpStatus String sFileName
76331>>>>>>>        Local String  sVoid
76331>>>>>>>        Local String  sDriverID
76331>>>>>>>        Local Integer iVoid
76331>>>>>>>
76331>>>>>>>        Get psDriverID To sDriverID
76332>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_DUMPSTATUS Callback 0 Passing sFileName sVoid iVoid Result iVoid
76339>>>>>>>    End_Procedure // DumpStatus
76340>>>>>>>
76340>>>>>>>
76340>>>>>>>
76340>>>>>>>    //***
76340>>>>>>>    //*** Procedure: ReadConfiguration
76340>>>>>>>    //*** Purpose  : Reset all driver level configurable attributes to the
76340>>>>>>>    //***            default value and then reread the configuration.
76340>>>>>>>    //***
76340>>>>>>>
76340>>>>>>>    Procedure ReadConfiguration
76342>>>>>>>        Local String  sVoid
76342>>>>>>>        Local String  sDriverID
76342>>>>>>>        Local Integer iVoid
76342>>>>>>>
76342>>>>>>>        Get psDriverID To sDriverID
76343>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_READCONFIGURATION Callback 0 Passing sVoid sVoid iVoid Result iVoid
76350>>>>>>>    End_Procedure // ReadConfiguration
76351>>>>>>>
76351>>>>>>>
76351>>>>>>>
76351>>>>>>>    //***
76351>>>>>>>    //*** Function: TextToRIMValue
76351>>>>>>>    //*** Purpose : Convert a text to the corresponding
76351>>>>>>>    //***           Generate_Record_ID_Method attribute value
76351>>>>>>>    //***
76351>>>>>>>
76351>>>>>>>    Function TextToRIMValue String sText Returns Integer
76353>>>>>>>        If (sText = "None") ;            Function_return RIM_NONE
76356>>>>>>>        Else If (sText = "Identity Column") ;            Function_return RIM_IDENTITY_COLUMN
76360>>>>>>>        Else If (sText = "Dispenser Table") ;            Function_return RIM_DISPENSER_TABLE
76364>>>>>>>        Else If (sText = "External") ;            Function_return RIM_EXTERNAL
76368>>>>>>>    End_Function // TextToRIMValue
76369>>>>>>>
76369>>>>>>>
76369>>>>>>>
76369>>>>>>>    //***
76369>>>>>>>    //*** Function: RIMValueTotext
76369>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76369>>>>>>>    //***           corresponding text.
76369>>>>>>>    //***
76369>>>>>>>
76369>>>>>>>    Function RIMValueToText Integer iAttrValue Returns String
76371>>>>>>>        If (iAttrValue = RIM_NONE) ;            Function_return "None"
76374>>>>>>>        Else If (iAttrValue = RIM_IDENTITY_COLUMN) ;            Function_return "Identity Column"
76378>>>>>>>        Else If (iAttrValue = RIM_DISPENSER_TABLE) ;            Function_return "Dispenser Table"
76382>>>>>>>        Else If (iAttrValue = RIM_EXTERNAL) ;            Function_return "External"
76386>>>>>>>    End_Function // RIMValueToText
76387>>>>>>>
76387>>>>>>>
76387>>>>>>>
76387>>>>>>>    //***
76387>>>>>>>    //*** Function: TextToROValue
76387>>>>>>>    //*** Purpose : Convert a text to the corresponding
76387>>>>>>>    //***           Generate_Record_ID_Method attribute value
76387>>>>>>>    //***
76387>>>>>>>
76387>>>>>>>    Function TextToROValue String sText Returns Integer
76389>>>>>>>        If (sText = "No") ;            Function_return RO_NO
76392>>>>>>>        Else If (sText = "Ignore Change") ;            Function_return RO_IGNORECHANGE
76396>>>>>>>        Else If (sText = "Accept Change") ;            Function_return RO_ACCEPTCHANGE
76400>>>>>>>        Else If (sText = "Error On Change") ;            Function_return RO_ERRORONCHANGE
76404>>>>>>>    End_Function // TextToRIMValue
76405>>>>>>>
76405>>>>>>>
76405>>>>>>>
76405>>>>>>>    //***
76405>>>>>>>    //*** Function: ROValueTotext
76405>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76405>>>>>>>    //***           corresponding text.
76405>>>>>>>    //***
76405>>>>>>>
76405>>>>>>>    Function ROValueToText Integer iAttrValue Returns String
76407>>>>>>>        If (iAttrValue = RO_NO) ;            Function_return "No"
76410>>>>>>>        Else If (iAttrValue = RO_IGNORECHANGE) ;            Function_return "Ignore Change"
76414>>>>>>>        Else If (iAttrValue = RO_ACCEPTCHANGE) ;            Function_return "Accept Change"
76418>>>>>>>        Else If (iAttrValue = RO_ERRORONCHANGE) ;            Function_return "Error On Change"
76422>>>>>>>    End_Function // RIMValueToText
76423>>>>>>>
76423>>>>>>>
76423>>>>>>>
76423>>>>>>>    //***
76423>>>>>>>    //*** Function: LastDriverError
76423>>>>>>>    //*** Purpose : Return the text f the last error geneated by the driver.
76423>>>>>>>    //***
76423>>>>>>>
76423>>>>>>>    Function LastDriverError Returns String
76425>>>>>>>        Local String  sDriverID
76425>>>>>>>        Local String  sLastError
76425>>>>>>>        Local String  sLastErrorLength
76425>>>>>>>        Local Integer iLastErrorLength
76425>>>>>>>        Local Integer iVoid
76425>>>>>>>
76425>>>>>>>        //*** Initialize
76425>>>>>>>        Move "" To sLastError
76426>>>>>>>
76426>>>>>>>        Get psDriverID To sDriverID
76427>>>>>>>        If (sDriverID <> "") Begin
76429>>>>>>>            //*** Get the text of the last error
76429>>>>>>>            Move (Repeat(Character(" "), 14)) To sLastErrorlength
76430>>>>>>>            Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastErrorLength iVoid DRVR_LASTERRORTEXTLENGTH Result iVoid
76435>>>>>>>            Move (Left(sLastErrorLength, Pos(Character(0), sLastErrorLength) - 1)) To iLastErrorLength
76436>>>>>>>
76436>>>>>>>            If (iLastErrorLength > 0) Begin
76438>>>>>>>                Move (Repeat(Character(" "), iLastErrorLength + 1)) To sLastError
76439>>>>>>>                Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastError iVoid DRVR_LASTERRORTEXT Result iVoid
76444>>>>>>>                Move (Left(sLastError, Pos(Character(0), sLastError) - 1)) To sLastError
76445>>>>>>>            End
76445>>>>>>>>
76445>>>>>>>        End
76445>>>>>>>>
76445>>>>>>>
76445>>>>>>>        Function_Return sLastError
76446>>>>>>>    End_Function // LastDriverError
76447>>>>>>>
76447>>>>>>>
76447>>>>>>>
76447>>>>>>>    //***
76447>>>>>>>    //*** Function: EnumerateTables
76447>>>>>>>    //*** Purpose : Enumerate the tables in a database
76447>>>>>>>    //***
76447>>>>>>>
76447>>>>>>>    Function EnumerateTables String sLogin Returns Integer
76449>>>>>>>        Local String  sDriver
76449>>>>>>>        Local String  sVoid
76449>>>>>>>        Local Integer iNumTables
76449>>>>>>>        Local Integer iVoid
76449>>>>>>>
76449>>>>>>>        Get psDriverID To sDriver
76450>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_TABLES Callback 0 Passing sLogin sVoid iVoid Result iNumTables
76457>>>>>>>
76457>>>>>>>        Function_Return iNumTables
76458>>>>>>>    End_Function // EnumerateTables
76459>>>>>>>
76459>>>>>>>
76459>>>>>>>
76459>>>>>>>    //***
76459>>>>>>>    //*** Function: TableName
76459>>>>>>>    //*** Purpose : Returns the name of the table enumerated at the given position
76459>>>>>>>    //***
76459>>>>>>>
76459>>>>>>>    Function TableName Integer iIndex Returns String
76461>>>>>>>        Local String  sDriver
76461>>>>>>>        Local String  sTableName
76461>>>>>>>        Local String  sVoid
76461>>>>>>>        Local Integer iVoid
76461>>>>>>>
76461>>>>>>>        Get psDriverID To sDriver
76462>>>>>>>        If (sDriver <> "") Begin
76464>>>>>>>            Move (Repeat(" ", 255)) To sTableName
76465>>>>>>>            Call_driver 0 sDriver Function CLI_TABLENAME Callback 0 Passing sTableName sVoid iIndex Result iVoid
76470>>>>>>>        End
76470>>>>>>>>
76470>>>>>>>
76470>>>>>>>        Function_Return sTableName
76471>>>>>>>    End_Function // TableName
76472>>>>>>>
76472>>>>>>>
76472>>>>>>>
76472>>>>>>>    //***
76472>>>>>>>    //*** Function: SchemaName
76472>>>>>>>    //*** Purpose : Returns the name of the schema of the table enumerated at the given position
76472>>>>>>>    //***
76472>>>>>>>
76472>>>>>>>    Function SchemaName Integer iIndex Returns String
76474>>>>>>>        Local String  sDriver
76474>>>>>>>        Local String  sSchemaName
76474>>>>>>>        Local String  sVoid
76474>>>>>>>        Local Integer iVoid
76474>>>>>>>
76474>>>>>>>        Get psDriverID To sDriver
76475>>>>>>>        If (sDriver <> "") Begin
76477>>>>>>>            Move (Repeat(" ", 255)) To sSchemaName
76478>>>>>>>            Call_driver 0 sDriver Function CLI_TABLESCHEMA Callback 0 Passing sSchemaName sVoid iIndex Result iVoid
76483>>>>>>>        End
76483>>>>>>>>
76483>>>>>>>
76483>>>>>>>        Function_Return sSchemaName
76484>>>>>>>    End_Function // SchemaName
76485>>>>>>>
76485>>>>>>>
76485>>>>>>>
76485>>>>>>>    //***
76485>>>>>>>    //*** Function: TableType
76485>>>>>>>    //*** Purpose : Returns the type of the table enumerated at the given position.
76485>>>>>>>    //***           Types can be "TABLE", "VIEW", "SYSTEM TABLE", "GLOBAL TEMPORARY",
76485>>>>>>>    //***           "LOCAL TEMPORARY", "ALIAS", "SYNONYM"
76485>>>>>>>    //***
76485>>>>>>>
76485>>>>>>>    Function TableType Integer iIndex Returns String
76487>>>>>>>        Local String  sDriver
76487>>>>>>>        Local String  sTableType
76487>>>>>>>        Local String  sVoid
76487>>>>>>>        Local Integer iVoid
76487>>>>>>>
76487>>>>>>>        Get psDriverID To sDriver
76488>>>>>>>        If (sDriver <> "") Begin
76490>>>>>>>            Move (Repeat(" ", 25)) To sTableType
76491>>>>>>>            Call_driver 0 sDriver Function CLI_TABLETYPE Callback 0 Passing sTableType sVoid iIndex Result iVoid
76496>>>>>>>        End
76496>>>>>>>>
76496>>>>>>>
76496>>>>>>>        Function_Return sTableType
76497>>>>>>>    End_Function // TableType
76498>>>>>>>
76498>>>>>>>
76498>>>>>>>
76498>>>>>>>    //***
76498>>>>>>>    //*** Function: TableComment
76498>>>>>>>    //*** Purpose : Returns the comment of the table enumerated at the given position
76498>>>>>>>    //***
76498>>>>>>>
76498>>>>>>>    Function TableComment Integer iIndex Returns String
76500>>>>>>>        Local String  sDriver
76500>>>>>>>        Local String  sTableComment
76500>>>>>>>        Local String  sVoid
76500>>>>>>>        Local Integer iVoid
76500>>>>>>>
76500>>>>>>>        Get psDriverID To sDriver
76501>>>>>>>        If (sDriver <> "") Begin
76503>>>>>>>            Move (Repeat(" ", 255)) To sTableComment
76504>>>>>>>            Call_driver 0 sDriver Function CLI_TABLECOMMENT Callback 0 Passing sTableComment sVoid iIndex Result iVoid
76509>>>>>>>        End
76509>>>>>>>>
76509>>>>>>>
76509>>>>>>>        Function_Return sTableComment
76510>>>>>>>    End_Function // TableComment
76511>>>>>>>
76511>>>>>>>
76511>>>>>>>
76511>>>>>>>    //***
76511>>>>>>>    //*** Function: EnumerateColumns
76511>>>>>>>    //*** Purpose : Enumerate the columns in a table
76511>>>>>>>    //***
76511>>>>>>>
76511>>>>>>>    Function EnumerateColumns String sLogin String sTableName Returns Integer
76513>>>>>>>        Local String  sDriver
76513>>>>>>>        Local Integer iNumColumns
76513>>>>>>>        Local Integer iVoid
76513>>>>>>>
76513>>>>>>>        Get psDriverID To sDriver
76514>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_COLUMNS Callback 0 Passing sLogin sTablename iVoid Result iNumColumns
76521>>>>>>>
76521>>>>>>>        Function_Return iNumColumns
76522>>>>>>>    End_Function // EnumerateColumns
76523>>>>>>>
76523>>>>>>>
76523>>>>>>>
76523>>>>>>>    //***
76523>>>>>>>    //*** Function: ColumnName
76523>>>>>>>    //*** Purpose : Returns the name of the column enumerated at the given position
76523>>>>>>>    //***
76523>>>>>>>
76523>>>>>>>    Function ColumnName Integer iIndex Returns String
76525>>>>>>>        Local String  sDriver
76525>>>>>>>        Local String  sColumnName
76525>>>>>>>        Local String  sVoid
76525>>>>>>>        Local Integer iVoid
76525>>>>>>>
76525>>>>>>>        Get psDriverID To sDriver
76526>>>>>>>        If (sDriver <> "") Begin
76528>>>>>>>            Move (Repeat(" ", 255)) To sColumnName
76529>>>>>>>            Call_driver 0 sDriver Function CLI_COLUMNNAME Callback 0 Passing sColumnName sVoid iIndex Result iVoid
76534>>>>>>>        End
76534>>>>>>>>
76534>>>>>>>
76534>>>>>>>        Function_Return sColumnName
76535>>>>>>>    End_Function // ColumnName
76536>>>>>>>
76536>>>>>>>
76536>>>>>>>
76536>>>>>>>    //***
76536>>>>>>>    //*** Function: CLIDFDateToSQLDate
76536>>>>>>>    //*** Purpose : Convert a DataFlex date to a SQL date using the dummy zero date value.
76536>>>>>>>    //***
76536>>>>>>>
76536>>>>>>>    Function CLIDFDateToSQLDate String sDRiver Date dDFDate Returns String
76538>>>>>>>        Local String sSQLDate
76538>>>>>>>        Local Integer iOrgDateFmt
76538>>>>>>>        Local Integer iOrgDateSep
76538>>>>>>>
76538>>>>>>>        //*** Change date format to military, SQL dates are military dates
76538>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76541>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76544>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76547>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76550>>>>>>>
76550>>>>>>>        //*** We only need to convert if the date is 0
76550>>>>>>>        If (Integer(dDFDate = 0)) ;            CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sSQLDate
76559>>>>>>>        Else ;            Move dDFDate To sSQLDate
76561>>>>>>>
76561>>>>>>>        //*** Change date format back to original
76561>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76564>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76567>>>>>>>
76567>>>>>>>        Function_Return sSQLDate
76568>>>>>>>    End_Function // CLIDFDateToSQLDate
76569>>>>>>>
76569>>>>>>>
76569>>>>>>>
76569>>>>>>>    //***
76569>>>>>>>    //*** Function: CLISQLDateToDFDate
76569>>>>>>>    //*** Purpose : Convert a SQL date to a DataFlex date using the dummy zero date value.
76569>>>>>>>    //***
76569>>>>>>>
76569>>>>>>>    Function CLISQLDateToDFDate String sDRiver String sSQLDate Returns Date
76571>>>>>>>        Local Date dDFDate
76571>>>>>>>        Local String sDummyDateValue
76571>>>>>>>        Local Integer iOrgDateFmt
76571>>>>>>>        Local Integer iOrgDateSep
76571>>>>>>>
76571>>>>>>>        //*** Change date format to military, SQL dates are military dates
76571>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76574>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76577>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76580>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76583>>>>>>>
76583>>>>>>>        //*** We only need to convert if the date is the dummy zero date value
76583>>>>>>>        CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sDummyDateValue
76590>>>>>>>        If (sDummyDateValue = sSQLDate) ;            Move 0 To dDFDate
76593>>>>>>>        Else ;            Move sSQLDate To dDFDate
76595>>>>>>>
76595>>>>>>>        //*** Change date format back to original
76595>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76598>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76601>>>>>>>
76601>>>>>>>        Function_Return dDFDate
76602>>>>>>>    End_Function // CLISQLDateToDFDate
76603>>>>>>>
76603>>>>>>>
76603>>>>>>>
76603>>>>>>>    //***
76603>>>>>>>    //*** Function: RedirectConnection
76603>>>>>>>    //*** Purpose : Redirect an exisitng connection. The existing connection
76603>>>>>>>    //***           will point to another database but all tables will stay
76603>>>>>>>    //***           open!
76603>>>>>>>    //***
76603>>>>>>>
76603>>>>>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
76605>>>>>>>        Local String  sDriver
76605>>>>>>>        Local String  sVoid
76605>>>>>>>        Local Integer iResult
76605>>>>>>>        Local Integer iVoid
76605>>>>>>>
76605>>>>>>>        Get psDriverID To sDriver
76606>>>>>>>        If (sDriver <> "") Begin
76608>>>>>>>            Call_driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sOldConnection sNewConnection iVoid Result iResult
76613>>>>>>>        End
76613>>>>>>>>
76613>>>>>>>        Function_Return iResult
76614>>>>>>>    End_Function // RedirectConnect
76615>>>>>>>
76615>>>>>>>
76615>>>>>>>
76615>>>>>>>    //***
76615>>>>>>>    //*** Function: CreateConnectionID
76615>>>>>>>    //*** Purpose : Create a DataFlex side connection id that can be used later on.
76615>>>>>>>    //***
76615>>>>>>>
76615>>>>>>>    Function CreateConnectionID String sID String sConnStr Integer iOpt Returns Integer
76617>>>>>>>        Local String  sDriver
76617>>>>>>>        Local Integer iResult
76617>>>>>>>        Local Integer iOptions
76617>>>>>>>
76617>>>>>>>        Get psDriverID to sDriver
76618>>>>>>>        If (Num_Arguments = 2) ;            Move 0 to iOptions
76621>>>>>>>        Else ;            Move iOpt to iOptions
76623>>>>>>>        If (sDriver <> "") Begin
76625>>>>>>>            Call_Driver 0 sDriver Function CLI_CREATECONNECTIONID Callback 0 Passing sID sConnStr iOptions Result iResult
76630>>>>>>>        End
76630>>>>>>>>
76630>>>>>>>        Function_Return iResult
76631>>>>>>>    End_Function // CreateConnectionID
76632>>>>>>>
76632>>>>>>>
76632>>>>>>>
76632>>>>>>>    //***
76632>>>>>>>    //*** Function: DeleteConnectionID
76632>>>>>>>    //*** Purpose : Delete a DataFlex side connection id.
76632>>>>>>>    //***
76632>>>>>>>
76632>>>>>>>    Function DeleteConnectionID String sID Integer iIndex Returns Integer
76634>>>>>>>        Local String  sDriver
76634>>>>>>>        Local Integer iResult
76634>>>>>>>        Local String sVoid
76634>>>>>>>
76634>>>>>>>        Get psDriverID To sDriver
76635>>>>>>>        If (sDriver <> "") Begin
76637>>>>>>>            Call_Driver 0 sDriver Function CLI_DELETECONNECTIONID Callback 0 Passing sID sVoid iIndex Result iResult
76642>>>>>>>        End
76642>>>>>>>>
76642>>>>>>>        Function_Return iResult
76643>>>>>>>    End_Function // DeleteConnectionID
76644>>>>>>>
76644>>>>>>>End_Class // cCLIHandler
76645>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 18.2\Pkg\DFBTRDRV.PKG)
76645>>>>>>>//****************************************************************************
76645>>>>>>>//
76645>>>>>>>// $File name  : DFBTRDRV.PKG
76645>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
76645>>>>>>>// Notice      : This package contains constants and commands, used to call
76645>>>>>>>//               specific functions in the DFBTRDRV.
76645>>>>>>>// $Author(s)  : Eddy Kleinjan
76645>>>>>>>//
76645>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
76645>>>>>>>// Created     : 01-07-97 @ 12:00:00
76645>>>>>>>//
76645>>>>>>>// Changed     : 04-04-2001.
76645>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
76645>>>>>>>//
76645>>>>>>>// Changed     : June 6, 2001
76645>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
76645>>>>>>>//
76645>>>>>>>//               Added DFBTR_DDF_OWNER command.
76645>>>>>>>//
76645>>>>>>>// Changed     : June 12, 2001
76645>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
76645>>>>>>>//
76645>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
76645>>>>>>>//
76645>>>>>>>// Changed     : August 4, 2004
76645>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
76645>>>>>>>//
76645>>>>>>>//               Added cDfbtrdrvHandler class.
76645>>>>>>>//               New functions in this class:
76645>>>>>>>//                  Function CKRevision Returns String
76645>>>>>>>//                  Function CkUsesUri Returns Integer
76645>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76645>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76645>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76645>>>>>>>//
76645>>>>>>>// Changed     : September 30, 2005
76645>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
76645>>>>>>>//
76645>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
76645>>>>>>>//****************************************************************************
76645>>>>>>>Use Ui
76645>>>>>>>//
76645>>>>>>>// Driver Indentification
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>//*** Driver attributes
76645>>>>>>>//
76645>>>>>>>// Call_Driver functions ID's
76645>>>>>>>//
76645>>>>>>>//
76645>>>>>>>// DFBTRFN_CONVERT_FILE options
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// DFBTRFN_SET_OWNER options
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to create all vars which may be needed
76645>>>>>>>// in other commands.
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to set the owner of a Btrieve file.
76645>>>>>>>// File must have been opened.
76645>>>>>>>// Filenumber needs to be passed.
76645>>>>>>>// To clear set the owner to "".
76645>>>>>>>// Examples:
76645>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
76645>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
76645>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
76645>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
76645>>>>>>>// To clear:
76645>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to parse DFBTR_SET_OWNVER
76645>>>>>>>// options.
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to parse for Callback
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to clear the owner of a Btrieve file.
76645>>>>>>>// File must have been opened.
76645>>>>>>>// Filenumber needs to be passed.
76645>>>>>>>// Examples:
76645>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to add a owner name to the internal list of ownernames
76645>>>>>>>// which will be tries when opening files.
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to remove all owners from the internal list of ownernames
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to set the owner name to be used when opening the DDF files.
76645>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
76645>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
76645>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to change the transaction type.
76645>>>>>>>// Valid types are:
76645>>>>>>>//     DFBTRTT_NONE
76645>>>>>>>//     DFBTRTT_EXCLUSIVE
76645>>>>>>>//     DFBTRTT_CONCURRENT
76645>>>>>>>//
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to get the current transaction type.
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to set explicit_locking
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to get explicit locking
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>//
76645>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
76645>>>>>>>//
76645>>>>>>>
76645>>>>>>>//*****************************************************************************
76645>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
76645>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76645>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
76645>>>>>>>//*****************************************************************************
76645>>>>>>>
76645>>>>>>>Class cDFBtrDrvHandler Is An Array
76646>>>>>>>
76646>>>>>>>    Procedure Construct_Object Integer iImage
76648>>>>>>>        Forward Send Construct_object iImage
76650>>>>>>>
76650>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
76651>>>>>>>    End_Procedure // Construct_Object
76652>>>>>>>
76652>>>>>>>
76652>>>>>>>
76652>>>>>>>    //***
76652>>>>>>>    //*** Function: CKRevsion
76652>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
76652>>>>>>>    //***
76652>>>>>>>
76652>>>>>>>    Function CKRevision Returns String
76654>>>>>>>        Local String  sDriverID
76654>>>>>>>        Local String  sRevision
76654>>>>>>>        Local String  sVoid
76654>>>>>>>        Local Integer iRetval
76654>>>>>>>
76654>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76654>>>>>>>        // This error would otherwise be raised when we have an older
76654>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76654>>>>>>>        Send Ignore_error To Error_object_Id 20491
76655>>>>>>>        Get psDriverID To sDriverID
76656>>>>>>>        Move (Repeat(" ", 255)) To sRevision
76657>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76662>>>>>>>        Send Trap_Error To Error_object_Id 20491
76663>>>>>>>        If (Trim(sRevision) = "") Begin
76665>>>>>>>            // Unable to get the revision. return all zeroes.
76665>>>>>>>            Move "0.0.0.0" To sRevision
76666>>>>>>>        End
76666>>>>>>>>
76666>>>>>>>        Function_Return sRevision
76667>>>>>>>    End_Function // CKRevision
76668>>>>>>>
76668>>>>>>>    Function CkUsesUri Returns Integer
76670>>>>>>>        Local String  sDriverID
76670>>>>>>>        Local String  sVoid1
76670>>>>>>>        Local String  sVoid2
76670>>>>>>>        Local Integer iRetval
76670>>>>>>>
76670>>>>>>>        Get psDriverID To sDriverID
76671>>>>>>>
76671>>>>>>>        Move 0 To iRetval
76672>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76672>>>>>>>        // This error would otherwise be raised when we have an older
76672>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
76672>>>>>>>        Send Ignore_error To Error_object_Id 20491
76673>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
76678>>>>>>>        Send Trap_Error To Error_object_Id 20491
76679>>>>>>>
76679>>>>>>>        Function_Return iRetval
76680>>>>>>>    End_Function // CKUsesUri
76681>>>>>>>
76681>>>>>>>
76681>>>>>>>
76681>>>>>>>    //***
76681>>>>>>>    //*** Function: ExtractPartFromRevsion
76681>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76681>>>>>>>    //***
76681>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76681>>>>>>>    //***
76681>>>>>>>
76681>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76683>>>>>>>        Local Integer iPartRev
76683>>>>>>>        Local Integer iCurrentPart
76683>>>>>>>        Local Integer iSeparatorPos
76683>>>>>>>
76683>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76686>>>>>>>
76686>>>>>>>        Move 0 To iCurrentPart
76687>>>>>>>        Repeat
76687>>>>>>>>
76687>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76688>>>>>>>            If (iSeparatorPos > 0) Begin
76690>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76691>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76692>>>>>>>                Increment iCurrentPart
76693>>>>>>>            End
76693>>>>>>>>
76693>>>>>>>            Else If (sRevision <> "") Begin
76696>>>>>>>                Move sRevision To iPartRev
76697>>>>>>>                Move "" To sRevision
76698>>>>>>>                Increment iCurrentPart
76699>>>>>>>            End
76699>>>>>>>>
76699>>>>>>>            Else ;                Move -1 To iPartRev
76701>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76703>>>>>>>
76703>>>>>>>        Function_Return iPartRev
76704>>>>>>>    End_Function // EcxtractPartFromRevision
76705>>>>>>>
76705>>>>>>>
76705>>>>>>>
76705>>>>>>>    //***
76705>>>>>>>    //*** Function: CKMajorRevision
76705>>>>>>>    //*** Purpose : Returns the major revision of the CK
76705>>>>>>>    //***
76705>>>>>>>
76705>>>>>>>    Function CKMajorRevision Returns Integer
76707>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76708>>>>>>>    End_Function // CKMajorRevision
76709>>>>>>>
76709>>>>>>>
76709>>>>>>>
76709>>>>>>>    //***
76709>>>>>>>    //*** Function: CKMinorRevision
76709>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76709>>>>>>>    //***
76709>>>>>>>
76709>>>>>>>    Function CKMinorRevision Returns Integer
76711>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76712>>>>>>>    End_Function // CKMinorRevision
76713>>>>>>>
76713>>>>>>>
76713>>>>>>>
76713>>>>>>>    //***
76713>>>>>>>    //*** Function: CKReleaseRevision
76713>>>>>>>    //*** Purpose : Returns the release revision of the CK
76713>>>>>>>    //***
76713>>>>>>>
76713>>>>>>>    Function CKReleaseRevision Returns Integer
76715>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76716>>>>>>>    End_Function // CKReleaseRevision
76717>>>>>>>
76717>>>>>>>
76717>>>>>>>
76717>>>>>>>    //***
76717>>>>>>>    //*** Function: CKBuildRevision
76717>>>>>>>    //*** Purpose : Returns the major revision of the CK
76717>>>>>>>    //***
76717>>>>>>>
76717>>>>>>>    Function CKBuildRevision Returns Integer
76719>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76720>>>>>>>    End_Function // CKBuildRevision
76721>>>>>>>
76721>>>>>>>
76721>>>>>>>
76721>>>>>>>    //***
76721>>>>>>>    //*** Function: IsMinimalRevision
76721>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76721>>>>>>>    //***
76721>>>>>>>
76721>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76723>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76726>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76729>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76732>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76735>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76738>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76742>>>>>>>            End
76742>>>>>>>>
76742>>>>>>>        End
76742>>>>>>>>
76742>>>>>>>
76742>>>>>>>        Function_Return (FALSE)
76743>>>>>>>    End_Function // IsMinimalRevision
76744>>>>>>>
76744>>>>>>>    //   Functions to query the Pervasive.SQL version:
76744>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
76744>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
76744>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
76744>>>>>>>    //
76744>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
76744>>>>>>>    //   in the following format:
76744>>>>>>>    //       <version>.<revision>.<type>
76744>>>>>>>    //   possible values for <type>:
76744>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
76744>>>>>>>    //         server using Workgroup authentication mode
76744>>>>>>>    //       C for client cache engine
76744>>>>>>>    //       D for DOS workstation
76744>>>>>>>    //       N for client Requester
76744>>>>>>>    //       S for NetWare server
76744>>>>>>>    //       T for 32-bit Windows server engine
76744>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
76744>>>>>>>    //
76744>>>>>>>    //   example:
76744>>>>>>>    //       8.50.T
76744>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
76744>>>>>>>    //   32-bits Windows server.
76744>>>>>>>    //
76744>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
76744>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
76744>>>>>>>    //
76744>>>>>>>    //   If the version information is not available or can not be obtained
76744>>>>>>>    //   the functions will return "0.0.0"
76744>>>>>>>
76744>>>>>>>
76744>>>>>>>    //***
76744>>>>>>>    //*** Function: PSQLRequesterVersionInfo
76744>>>>>>>    //*** Purpose : Returns the version information of the
76744>>>>>>>    //***           Pervasive.SQL Client requester.
76744>>>>>>>
76744>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76746>>>>>>>
76746>>>>>>>        Local String  sDriverID
76746>>>>>>>        Local String  sVersion
76746>>>>>>>        Local String  sVoid
76746>>>>>>>        Local Integer iRetval
76746>>>>>>>
76746>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76746>>>>>>>        // This error would otherwise be raised when we have an older
76746>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76746>>>>>>>        Send Ignore_error To Error_object_Id 20491
76747>>>>>>>        Get psDriverID To sDriverID
76748>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76749>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76754>>>>>>>        Send Trap_Error To Error_object_Id 20491
76755>>>>>>>        If (Trim(sVersion) = "") Begin
76757>>>>>>>            // Unable to get the revision. return all zeroes.
76757>>>>>>>            Move "0.0.0" To sVersion
76758>>>>>>>        End
76758>>>>>>>>
76758>>>>>>>        Function_Return sVersion
76759>>>>>>>    End_Function //  PSQLRequesterVersion
76760>>>>>>>
76760>>>>>>>    //***
76760>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
76760>>>>>>>    //*** Purpose : Returns the version information of the
76760>>>>>>>    //***           Pervasive.SQL Local Engine
76760>>>>>>>
76760>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76762>>>>>>>
76762>>>>>>>        Local String  sDriverID
76762>>>>>>>        Local String  sVersion
76762>>>>>>>        Local String  sVoid
76762>>>>>>>        Local Integer iRetval
76762>>>>>>>
76762>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76762>>>>>>>        // This error would otherwise be raised when we have an older
76762>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76762>>>>>>>        Send Ignore_error To Error_object_Id 20491
76763>>>>>>>        Get psDriverID To sDriverID
76764>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76765>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76770>>>>>>>        Send Trap_Error To Error_object_Id 20491
76771>>>>>>>        If (Trim(sVersion) = "") Begin
76773>>>>>>>            // Unable to get the revision. return all zeroes.
76773>>>>>>>            Move "0.0.0" To sVersion
76774>>>>>>>        End
76774>>>>>>>>
76774>>>>>>>        Function_Return sVersion
76775>>>>>>>    End_Function //  PSQLLocalEngineVersion
76776>>>>>>>
76776>>>>>>>    //***
76776>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
76776>>>>>>>    //*** Purpose : Returns the version information of the
76776>>>>>>>    //***           Pervasive.SQL Server Engine
76776>>>>>>>
76776>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76778>>>>>>>
76778>>>>>>>        Local String  sDriverID
76778>>>>>>>        Local String  sVersion
76778>>>>>>>        Local String  sVoid
76778>>>>>>>        Local Integer iRetval
76778>>>>>>>
76778>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76778>>>>>>>        // This error would otherwise be raised when we have an older
76778>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76778>>>>>>>        Send Ignore_error To Error_object_Id 20491
76779>>>>>>>        Get psDriverID To sDriverID
76780>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76781>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76786>>>>>>>        Send Trap_Error To Error_object_Id 20491
76787>>>>>>>        If (Trim(sVersion) = "") Begin
76789>>>>>>>            // Unable to get the revision. return all zeroes.
76789>>>>>>>            Move "0.0.0" To sVersion
76790>>>>>>>        End
76790>>>>>>>>
76790>>>>>>>        Function_Return sVersion
76791>>>>>>>    End_Function //  PSQLServerEngineVersion
76792>>>>>>>
76792>>>>>>>End_Class // cDfbtrdrvHandler
76793>>>>>>>
76793>>>>>
76793>>>>>
76793>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
76794>>>>>
76794>>>>>Register_Function phoWorkspace Returns Handle
76794>>>>>Register_Function Help_filename Returns String
76794>>>>>Register_Function GetHelpFile Returns String
76794>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
76794>>>>>
76794>>>>>//****************************************************************************
76794>>>>>// $Module type: FUNCTION
76794>>>>>// $Module name: Network_User_Name
76794>>>>>// $Author     : AK/VOO/KCR
76794>>>>>// Created     : 09-24-96 @ 19:17
76794>>>>>//
76794>>>>>// Description
76794>>>>>//    This function reads the current username Of windows and returns that
76794>>>>>//    name or an text unknown user
76794>>>>>//
76794>>>>>// $Rev History
76794>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
76794>>>>>//  07/25/2003  Replaced obsolete code
76794>>>>>//  09/24/1996  Module header created
76794>>>>>//****************************************************************************
76794>>>>>Function Network_User_Name for cDesktop Returns String
76796>>>>>    String sName
76796>>>>>    Integer iRetval iLength
76796>>>>>
76796>>>>>    Move 0 to iLength
76797>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
76798>>>>>    ZeroString iLength to sName
76799>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
76800>>>>>
76800>>>>>    If (iRetval = NO_ERROR) Begin
76802>>>>>        Function_Return (CString (sName))
76803>>>>>    End
76803>>>>>>
76803>>>>>    
76803>>>>>    Function_Return "User Unknown"
76804>>>>>End_Function
76805>>>>>
76805>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
76805>>>>>Type MEMORYSTATUS
76805>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
76805>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
76805>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
76805>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
76805>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
76805>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
76805>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
76805>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
76805>>>>>End_Type // MEMORYSTATUS
76805>>>>>
76805>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
76806>>>>>
76806>>>>>Struct tWinMemoryStatusEx
76806>>>>>    UInteger dwLength                
76806>>>>>    UInteger dwMemoryLoad          
76806>>>>>    UBigInt ullTotalPhys           
76806>>>>>    UBigInt ullAvailPhys           
76806>>>>>    UBigInt ullTotalPageFile       
76806>>>>>    UBigInt ullAvailPageFile       
76806>>>>>    UBigInt ullTotalVirtual        
76806>>>>>    UBigInt ullAvailVirtual        
76806>>>>>    UBigInt ullAvailExtendedVirtual
76806>>>>>End_Struct
76806>>>>>
76806>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
76807>>>>>
76807>>>>>Class SysinfoDisplay is a cTextEdit
76808>>>>>    Procedure Construct_Object
76810>>>>>        Forward Send Construct_Object
76812>>>>>
76812>>>>>        Set Location To 6 6
76813>>>>>        Set Size To 110 255
76814>>>>>        Set Read_Only_State To True
76815>>>>>        Set pbWrap to False
76816>>>>>    End_Procedure
76817>>>>>
76817>>>>>    //****************************************************************************
76817>>>>>    // $Module type: PROCEDURE
76817>>>>>    // $Module name: Show_Current_Directory
76817>>>>>    // $Author     : VOO
76817>>>>>    // Created     : 06-10-96 @ 15:24
76817>>>>>    //
76817>>>>>    // Description
76817>>>>>    //    This method will show the name Of the current directory in the system
76817>>>>>    //    information box
76817>>>>>    //
76817>>>>>    // $Rev History
76817>>>>>    //    06-10-96  Module header created
76817>>>>>    //****************************************************************************
76817>>>>>    Procedure Show_Current_Directory
76819>>>>>        String sDir
76819>>>>>
76819>>>>>        Get_Current_Directory To sDir
76820>>>>>
76820>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
76821>>>>>    End_Procedure
76822>>>>>
76822>>>>>    Procedure Show_Windows_Directory
76824>>>>>        String sWindir
76824>>>>>
76824>>>>>        Get_Windows_Directory To sWindir
76825>>>>>
76825>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
76826>>>>>    End_Procedure
76827>>>>>
76827>>>>>    Procedure Show_Current_User
76829>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
76830>>>>>    End_Procedure
76831>>>>>
76831>>>>>    Procedure Show_Number_Format
76833>>>>>        Integer iFormat
76833>>>>>        String sFormatText
76833>>>>>
76833>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
76836>>>>>        Move (Character (iFormat)) To sFormatText
76837>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
76838>>>>>
76838>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
76841>>>>>        Move (Character (iFormat)) to sFormatText
76842>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
76843>>>>>    End_Procedure
76844>>>>>
76844>>>>>    Procedure Show_Filelist_Name
76846>>>>>        String sFilename
76846>>>>>
76846>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
76849>>>>>
76849>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
76850>>>>>        Send AppendTextLn ""
76851>>>>>    End_Procedure
76852>>>>>
76852>>>>>    Procedure Show_Lock_Delay
76854>>>>>        Integer iLockdelay
76854>>>>>
76854>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
76857>>>>>
76857>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
76858>>>>>    End_Procedure
76859>>>>>
76859>>>>>    Procedure Show_Lock_Timeout
76861>>>>>        Integer iLockTimeout
76861>>>>>
76861>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
76864>>>>>
76864>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
76865>>>>>    End_Procedure
76866>>>>>
76866>>>>>    Procedure Show_Screen_Size
76868>>>>>        Integer iYscreensize iXscreensize
76868>>>>>
76868>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
76869>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
76870>>>>>
76870>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
76871>>>>>    End_Procedure
76872>>>>>
76872>>>>>    Procedure Show_Page_Size
76874>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
76875>>>>>    End_procedure
76876>>>>>
76876>>>>>    Procedure Show_Date
76878>>>>>        Date dToday
76878>>>>>
76878>>>>>        Sysdate dToday
76879>>>>>
76879>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
76880>>>>>    End_procedure
76881>>>>>
76881>>>>>    Procedure Show_Date_Format
76883>>>>>        Integer iDateFormat
76883>>>>>        String sDateFormat
76883>>>>>
76883>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
76886>>>>>        Case Begin
76886>>>>>            Case (iDateFormat = DF_DATE_USA)
76888>>>>>                Move C_$USA To sDateFormat
76889>>>>>                Case Break
76890>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
76893>>>>>                Move C_$European To sDateFormat
76894>>>>>                Case Break
76895>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
76898>>>>>                Move C_$Military To sDateFormat
76899>>>>>                Case Break
76900>>>>>            Case Else
76900>>>>>                Move C_$UnknownDateType To sDateFormat
76901>>>>>                Case Break
76902>>>>>        Case End
76902>>>>>
76902>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
76903>>>>>    End_Procedure
76904>>>>>
76904>>>>>    Procedure Show_Systemresources
76906>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76906>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76906>>>>>        Integer iRetval
76906>>>>>
76906>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
76907>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
76908>>>>>        If (iRetval = 0) Begin
76910>>>>>            Move (ShowLastError ()) to iRetval
76911>>>>>        End
76911>>>>>>
76911>>>>>
76911>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
76912>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
76913>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
76914>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
76915>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
76916>>>>>    End_Procedure
76917>>>>>
76917>>>>>    Procedure Show_Registration
76919>>>>>        String sRegName
76919>>>>>        Integer iSN iMaxUsers
76919>>>>>
76919>>>>>        Registration sRegName iSN
76920>>>>>>
76920>>>>>        
76920>>>>>        Get_Licensed_Max_Users to iMaxUsers
76921>>>>>
76921>>>>>        Send AppendTextLn ""
76922>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
76923>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
76924>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
76925>>>>>    End_Procedure
76926>>>>>
76926>>>>>    //****************************************************************************
76926>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
76926>>>>>    // To the workspace object passing the an object and message To send back
76926>>>>>    // To this object. It is expected that the workspace object will send this
76926>>>>>    // message for every line Of information it wants displayed (passing the
76926>>>>>    // information To be displayed
76926>>>>>    //****************************************************************************
76926>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
76926>>>>>
76926>>>>>    Procedure Show_ServicePack
76928>>>>>        String sKey sVersionDescription sVersion 
76928>>>>>        Handle hoRegistry
76928>>>>>        Boolean bExists bOpened
76928>>>>>        
76928>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
76929>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
76930>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
76931>>>>>
76931>>>>>        Move C_DFVersionRegistryRoot to sKey
76932>>>>>        Get KeyExists of hoRegistry sKey to bExists
76933>>>>>        If (bExists) Begin
76935>>>>>            Get OpenKey of hoRegistry sKey to bOpened
76936>>>>>            If (bOpened) Begin
76938>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
76939>>>>>                If (bExists) Begin
76941>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
76942>>>>>                End
76942>>>>>>
76942>>>>>                
76942>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
76943>>>>>                If (bExists) Begin
76945>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
76946>>>>>                End                
76946>>>>>>
76946>>>>>                Send CloseKey of hoRegistry
76947>>>>>            End
76947>>>>>>
76947>>>>>        End
76947>>>>>>
76947>>>>>        Send Destroy of hoRegistry
76948>>>>>
76948>>>>>        If (sVersionDescription <> "") Begin
76950>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
76951>>>>>           Send AppendTextLn ""
76952>>>>>        End
76952>>>>>>
76952>>>>>    End_Procedure
76953>>>>>    
76953>>>>>
76953>>>>>    Procedure Show_WorkspaceInformation
76955>>>>>        Integer hoWorkspace
76955>>>>>
76955>>>>>        If (ghoApplication <> 0) Begin
76957>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
76958>>>>>            If (hoWorkspace <> 0) Begin
76960>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
76961>>>>>                Send AppendTextLn ""
76962>>>>>            End
76962>>>>>>
76962>>>>>        End
76962>>>>>>
76962>>>>>    End_Procedure
76963>>>>>
76963>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
76965>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
76966>>>>>    End_Function
76967>>>>>
76967>>>>>    Procedure Show_Versions
76969>>>>>        Integer iVersion iRevision iBuild
76969>>>>>
76969>>>>>        Version_Information iVersion iRevision iBuild
76971>>>>>
76971>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
76972>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
76973>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
76974>>>>>    End_Procedure
76975>>>>>    
76975>>>>>    Function CKRevisionNumber String sDriverID Returns String
76977>>>>>        Handle hoCLIHandler
76977>>>>>        Handle hoDFBtrDrvHandler
76977>>>>>        String sCKRevision
76977>>>>>
76977>>>>>
76977>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
76979>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
76980>>>>>            Set psDriverID of hoCLIHandler to sDriverID
76981>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
76982>>>>>            Send Destroy of hoCLIHandler
76983>>>>>        End
76983>>>>>>
76983>>>>>        Else Begin
76984>>>>>            If (sDriverID = "DFBTRDRV") Begin
76986>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
76987>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
76988>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
76989>>>>>                Send Destroy of hoDFBtrDrvHandler
76990>>>>>            End
76990>>>>>>
76990>>>>>        End
76990>>>>>>
76990>>>>>        
76990>>>>>        Function_Return sCKRevision
76991>>>>>    End_Function
76992>>>>>    
76992>>>>>    
76992>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
76994>>>>>        
76994>>>>>        If (sDriverID = "DATAFLEX") Begin
76996>>>>>            Function_Return False
76997>>>>>        End
76997>>>>>>
76997>>>>>    
76997>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
76998>>>>>    End_Function    
76999>>>>>
76999>>>>>
76999>>>>>    //***
76999>>>>>    //*** BW
76999>>>>>    //*** Procedure: Show_Drivers
76999>>>>>    //*** Purpose  : Show loaded database drivers
76999>>>>>    //***
76999>>>>>
76999>>>>>    Procedure Show_Drivers
77001>>>>>        String sCurrentDriver sRevNumber
77001>>>>>        String sLoadedDrivers
77001>>>>>        Integer iNumberOfDrivers iCount
77001>>>>>        Boolean bOK
77001>>>>>
77001>>>>>        Move "" To sLoadedDrivers
77002>>>>>        Get_Attribute DF_NUMBER_DRIVERS To iNumberOfDrivers
77005>>>>>        For iCount From 1 To iNumberOfDrivers
77011>>>>>>
77011>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
77014>>>>>            If (sLoadedDrivers <> "") Begin
77016>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
77017>>>>>            End
77017>>>>>>
77017>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
77018>>>>>            If (bOK) Begin
77020>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
77021>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
77022>>>>>            End
77022>>>>>>
77022>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) To sLoadedDrivers
77023>>>>>        Loop
77024>>>>>>
77024>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
77025>>>>>    End_Procedure
77026>>>>>
77026>>>>>    Procedure Show_HelpFile
77028>>>>>        String sHelpFile
77028>>>>>        Integer eHelpType
77028>>>>>
77028>>>>>        If (ghoApplication <> 0) Begin
77030>>>>>            Get peHelpType Of ghoApplication To eHelpType
77031>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
77033>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
77034>>>>>            End
77034>>>>>>
77034>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
77037>>>>>                Get Help_filename Of Help_object_id To sHelpFile
77038>>>>>            End
77038>>>>>>
77038>>>>>            Else Begin
77039>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
77040>>>>>            End
77040>>>>>>
77040>>>>>
77040>>>>>            Send AppendTextLn ""
77041>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
77042>>>>>        End
77042>>>>>>
77042>>>>>    End_Procedure
77043>>>>>
77043>>>>>    Procedure Show_EnterAsTab
77045>>>>>        Boolean bEnterKeyAsTabKey
77045>>>>>        String sText
77045>>>>>
77045>>>>>        If (ghoApplication <> 0) Begin
77047>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
77048>>>>>            If (bEnterKeyAsTabKey) Begin
77050>>>>>                Move "True" To sText
77051>>>>>            End
77051>>>>>>
77051>>>>>            Else Begin
77052>>>>>                Move "False" To sText
77053>>>>>            End
77053>>>>>>
77053>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
77054>>>>>        End
77054>>>>>>
77054>>>>>    End_Procedure
77055>>>>>
77055>>>>>    //****************************************************************************
77055>>>>>    // $Module type: PROCEDURE
77055>>>>>    // $Module name: Add_Focus
77055>>>>>    // $Author     : VOO
77055>>>>>    // Created     : 24-09-96 @ 19:43
77055>>>>>    //
77055>>>>>    // Description
77055>>>>>    //    During activation we will remove the old information and add the newly
77055>>>>>    //    found systeminformation
77055>>>>>    //
77055>>>>>    // $Rev History
77055>>>>>    //    24-09-96  Module header created
77055>>>>>    //****************************************************************************
77055>>>>>    Procedure Add_Focus Integer hoRoot
77057>>>>>        Forward Send Add_Focus hoRoot
77059>>>>>
77059>>>>>        Send Delete_Data
77060>>>>>
77060>>>>>        Set Changed_State To False
77061>>>>>        Set Read_Only_State To True
77062>>>>>
77062>>>>>        Send Show_ServicePack
77063>>>>>        Send Show_Versions   
77064>>>>>        Send Show_Drivers         
77065>>>>>        Send Show_HelpFile
77066>>>>>        Send Show_Current_Directory
77067>>>>>        Send Show_Filelist_Name          
77068>>>>>        If (ghoApplication <> 0) Begin
77070>>>>>            Send Show_WorkSpaceInformation // added To show WS info
77071>>>>>        End
77071>>>>>>
77071>>>>>        Send Show_Current_User 
77072>>>>>        Send Show_Windows_Directory 
77073>>>>>        Send Show_Screen_Size
77074>>>>>        Send Show_Page_Size
77075>>>>>        Send Show_EnterAsTab        
77076>>>>>        Send Show_Number_Format
77077>>>>>        Send Show_Date_Format
77078>>>>>        Send Show_Lock_Delay
77079>>>>>        Send Show_Lock_Timeout
77080>>>>>        Send Show_Date
77081>>>>>        Send Show_Systemresources
77082>>>>>        Send Show_Registration
77083>>>>>        Send Beginning_of_Data
77084>>>>>
77084>>>>>        Set Icon to 'default.ico'
77085>>>>>    End_Procedure
77086>>>>>End_Class
77087>>>>>
77087>>>>>//****************************************************************************
77087>>>>>// $Module type: OBJECT
77087>>>>>// $Module name: Sysinfo_Dialog
77087>>>>>// $Author     : VOO
77087>>>>>// Created     : 24-09-96 @ 18:47
77087>>>>>//
77087>>>>>// Description
77087>>>>>//    This object shows the systeminformation on the screen
77087>>>>>//
77087>>>>>// $Rev History
77087>>>>>//    24-09-96  Module header created
77087>>>>>//****************************************************************************
77087>>>>>Class SysInfoDialog Is A ModalPanel
77088>>>>>    Procedure Construct_Object
77090>>>>>        Forward Send Construct_Object
77092>>>>>
77092>>>>>        Set Label to C_$SystemInformation
77093>>>>>        Set Size to 140 267
77094>>>>>        Set piMinSize to 140 267
77095>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77096>>>>>        Set Border_Style to Border_Thick
77097>>>>>
77097>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
77099>>>>>            Set peAnchors to anAll
77100>>>>>        End_Object
77101>>>>>
77101>>>>>        Object oCloseButton Is A Button
77103>>>>>            Set Label To C_$Close
77104>>>>>            Set Location To 120 210
77105>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
77106>>>>>            Set Default_State To True
77107>>>>>            Set peAnchors to anBottomRight
77108>>>>>        End_Object
77109>>>>>
77109>>>>>        On_Key kCancel Send Close_Panel
77110>>>>>    End_Procedure
77111>>>>>End_Class
77112>>>>>
77112>>>>>// Purpose:
77112>>>>>//
77112>>>>>// Ken Ross 12/17/96 5:16PM
77112>>>>>//
77112>>>>>Class AboutDialog Is A ModalPanel
77113>>>>>    Procedure Construct_Object
77115>>>>>        String sVdfRootDir
77115>>>>>
77115>>>>>        Forward Send Construct_Object
77117>>>>>
77117>>>>>        Set Label To C_$About
77118>>>>>        Set Size to 89 212
77119>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77120>>>>>
77120>>>>>        Object oSysInfoDialog Is A SysInfoDialog
77122>>>>>        End_Object
77123>>>>>
77123>>>>>        Object oBox Is A Container3d
77125>>>>>            Set Border_Style To Border_StaticEdge
77126>>>>>            Set Size to 63 202
77127>>>>>            Set Location To 4 5
77128>>>>>
77128>>>>>            Object oAboutGraphic Is A BitmapContainer
77130>>>>>                Set Border_Style To Border_None
77131>>>>>                Set Bitmap_Style To Bitmap_Center
77132>>>>>                Set Size To 48 48
77133>>>>>                Set Location To 7 2
77134>>>>>            End_Object
77135>>>>>
77135>>>>>            Object oProductName Is A TextBox
77137>>>>>                Set Label To C_$ProductName
77138>>>>>                Set Size To 10 45
77139>>>>>                Set Location To 8 53
77140>>>>>            End_Object
77141>>>>>
77141>>>>>            Object oVersion Is A TextBox
77143>>>>>                Set Label To C_$Version
77144>>>>>                Set Size To 10 25
77145>>>>>                Set Location To 21 53
77146>>>>>            End_Object
77147>>>>>
77147>>>>>            Object oCopyright Is A TextBox
77149>>>>>                Set Label To C_$Copyright
77150>>>>>                Set Size To 10 31
77151>>>>>                Set Location To 34 53
77152>>>>>            End_Object
77153>>>>>
77153>>>>>            Object oAuthor Is A TextBox
77155>>>>>                Set Label To C_$Author
77156>>>>>                Set Size To 10 22
77157>>>>>                Set Location To 46 53
77158>>>>>            End_Object
77159>>>>>        End_Object
77160>>>>>
77160>>>>>        Object oOKButton Is A Button
77162>>>>>            On_Item C_$OK Send Close_Panel
77163>>>>>            Set Size To 14 50
77164>>>>>            Set Location To 71 157
77165>>>>>        End_Object
77166>>>>>
77166>>>>>        Object oSysInfoButton Is A Button
77168>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
77169>>>>>            Set Size To 14 50
77170>>>>>            Set Location To 71 101
77171>>>>>        End_Object
77172>>>>>
77172>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
77173>>>>>
77173>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
77174>>>>>    End_Procedure
77175>>>>>
77175>>>>>    Procedure Set ProductName String sProductName
77177>>>>>        Set Label Of oProductName To sProductName
77178>>>>>    End_Procedure
77179>>>>>
77179>>>>>    Procedure Set Version String sVersion
77181>>>>>        Set Label Of oVersion To sVersion
77182>>>>>    End_Procedure
77183>>>>>
77183>>>>>    Procedure Set Copyright string sCopyright
77185>>>>>        Set Label Of oCopyright To sCopyright
77186>>>>>    End_Procedure
77187>>>>>
77187>>>>>    Procedure Set Author String sAuthor
77189>>>>>        Set Label Of oAuthor To sAuthor
77190>>>>>    End_Procedure
77191>>>>>
77191>>>>>    Procedure Set Logo string sLogo
77193>>>>>        // square bitmaps Of 42x42 work best
77193>>>>>        Set Bitmap Of oAboutGraphic To sLogo
77194>>>>>    End_Procedure
77195>>>>>
77195>>>>>    Procedure Show_Sysinfo
77197>>>>>        Send Popup_Modal Of oSysinfoDialog
77198>>>>>    End_Procedure
77199>>>>>
77199>>>>>    Procedure End_Construct_Object
77201>>>>>        Handle hoVersionInfo
77201>>>>>        Boolean bIncluded
77201>>>>>        Integer iMajor iMinor iRelease iBuild
77201>>>>>        String sLabel
77201>>>>>
77201>>>>>        Get Label Of oVersion To sLabel
77202>>>>>        If (sLabel = C_$VERSION) Begin
77204>>>>>            // set it To the version info Of the program, if available
77204>>>>>            If (ghoApplication <> 0) Begin
77206>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
77207>>>>>                If (hoVersionInfo <> 0) Begin
77209>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
77210>>>>>                    If (bIncluded) Begin
77212>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
77213>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
77214>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
77215>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
77216>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
77217>>>>>                        Set Version to sLabel
77218>>>>>                    End
77218>>>>>>
77218>>>>>                End
77218>>>>>>
77218>>>>>            End
77218>>>>>>
77218>>>>>        End
77218>>>>>>
77218>>>>>
77218>>>>>        Forward Send End_Construct_Object
77220>>>>>    End_Procedure
77221>>>>>End_Class
77222>>>
77222>>>// *************************************************************************
77222>>>//  Public message. This is the default message. It is expected that you will
77222>>>//   create your own message to override this
77222>>>// *************************************************************************
77222>>>
77222>>>Procedure Activate_About
77225>>>   Send DoAbout "" "" "" "" ""
77226>>>End_Procedure
77227>>>
77227>>>// *************************************************************************
77227>>>//  Public message. It is expected that you will send this message (most
77227>>>//  likely from Activate_About. This creates an about object, activates it
77227>>>//  and destroys it when done. It is not exepected that you will augment this.
77227>>>// *************************************************************************
77227>>>
77227>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
77230>>>        integer hoObj hoMain
77230>>>
77230>>>        // create object
77230>>>        Object About is an AboutDialog
77232>>>            // if no title passed use the label of the main panel
77232>>>            // (if a main panel exists).
77232>>>            if sTitle     eq '' Begin
77234>>>                Get Main_Window of desktop to hoMain
77235>>>                if hoMain Get Label of hoMain to sTitle
77238>>>            end
77238>>>>
77238>>>            set productname to sTitle
77239>>>            set version     to sVersion
77240>>>            set copyright   to sCopyRight
77241>>>            set author      to sAuthor
77242>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
77245>>>            Move self to hoObj // object Id
77246>>>        End_Object
77247>>>        Send Popup   of hoObj    // popup the about object
77248>>>        Send Destroy of hoObj // when done, it will be destroyed
77249>>>End_procedure
77250>        Use EMPLEADOS.vw
Including file: EMPLEADOS.vw    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\EMPLEADOS.vw)
77250>>>// C:\DataFlex Projects\JUEVESAPPMARCAJES\AppSrc\EMPLEADOS.vw
77250>>>// EMPLEADOS
77250>>>//
77250>>>
77250>>>Use DFClient.pkg
77250>>>Use DFEntry.pkg
77250>>>
77250>>>Use cNacionalidadDataDictionary.dd
Including file: cNacionalidadDataDictionary.dd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\cNacionalidadDataDictionary.dd)
77250>>>>>Use DataDict.pkg
77250>>>>>
77250>>>>>Open Nacionalidad
Including file: Nacionalidad.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\Nacionalidad.fd)
77252>>>>>Open sysemFile
Including file: sysemFile.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\sysemFile.fd)
77254>>>>>Open EmpleadoTable
Including file: EmpleadoTable.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\EmpleadoTable.fd)
77256>>>>>
77256>>>>>Register_Object Nacionalidad_sl
77256>>>>>
77256>>>>>Class cNacionalidadDataDictionary is a DataDictionary
77257>>>>>    
77257>>>>>    Procedure Construct_Object
77259>>>>>        Forward Send Construct_Object
77261>>>>>        Set Main_File to Nacionalidad.File_Number
77262>>>>>
77262>>>>>        Set Add_Client_File to EmpleadoTable.File_Number
77263>>>>>
77263>>>>>        Set Add_System_File to sysemFile.File_Number DD_Lock_On_All
77264>>>>>
77264>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77265>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77266>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77267>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77268>>>>>
77268>>>>>        Set Field_Option Field Nacionalidad.CodigoNacionalidad DD_CAPSLOCK to True
77269>>>>>        Set Key_Field_State Field Nacionalidad.CodigoNacionalidad to True
77270>>>>>        Set Field_Auto_Increment Field Nacionalidad.CodigoNacionalidad to File_Field sysemFile.CodigoNacionalidad
77271>>>>>        Set Field_Prompt_Object Field Nacionalidad.CodigoNacionalidad to Nacionalidad_sl
77272>>>>>
77272>>>>>        Set Field_Option Field Nacionalidad.Pais DD_CAPSLOCK to True
77273>>>>>
77273>>>>>    End_Procedure
77274>>>>>
77274>>>>>End_Class
77275>>>>>
77275>>>>>Use Nacionalidad.sl
Including file: Nacionalidad.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\Nacionalidad.sl)
77275>>>>>>>// Nacionalidad.sl
77275>>>>>>>// Nacionalidad Lookup List
77275>>>>>>>
77275>>>>>>>Use DFClient.pkg
77275>>>>>>>Use cDbCJGridPromptList.pkg
77275>>>>>>>Use cDbCJGridColumn.pkg
77275>>>>>>>Use Windows.pkg
77275>>>>>>>
77275>>>>>>>Use cNacionalidadDataDictionary.dd
77275>>>>>>>
77275>>>>>>>CD_Popup_Object Nacionalidad_sl is a dbModalPanel
77293>>>>>>>>
77293>>>>>>>    Set Location to 5 5
77294>>>>>>>    Set Size to 134 260
77295>>>>>>>    Set Label To "Nacionalidad Lookup List"
77296>>>>>>>    Set Border_Style to Border_Thick
77297>>>>>>>    Set Minimize_Icon to False
77298>>>>>>>
77298>>>>>>>
77298>>>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77300>>>>>>>    End_Object 
77301>>>>>>>
77301>>>>>>>    Set Main_DD To oNacionalidad_DD
77302>>>>>>>    Set Server  To oNacionalidad_DD
77303>>>>>>>
77303>>>>>>>
77303>>>>>>>
77303>>>>>>>    Object oSelList is a cDbCJGridPromptList
77305>>>>>>>        Set Size to 105 250
77306>>>>>>>        Set Location to 5 5
77307>>>>>>>        Set peAnchors to anAll
77308>>>>>>>        Set psLayoutSection to "Nacionalidad_sl_oSelList"
77309>>>>>>>        Set Ordering to 1
77310>>>>>>>        Set pbAutoServer to True
77311>>>>>>>
77311>>>>>>>        Object oNacionalidad_CodigoNacionalidad is a cDbCJGridColumn
77313>>>>>>>            Entry_Item Nacionalidad.CodigoNacionalidad
77314>>>>>>>            Set piWidth to 157
77315>>>>>>>            Set psCaption to "Codigo"
77316>>>>>>>        End_Object 
77317>>>>>>>
77317>>>>>>>        Object oNacionalidad_Pais is a cDbCJGridColumn
77319>>>>>>>            Entry_Item Nacionalidad.Pais
77320>>>>>>>            Set piWidth to 262
77321>>>>>>>            Set psCaption to "Pais"
77322>>>>>>>        End_Object 
77323>>>>>>>
77323>>>>>>>
77323>>>>>>>    End_Object 
77324>>>>>>>
77324>>>>>>>    Object oOk_bn is a Button
77326>>>>>>>        Set Label to "&Ok"
77327>>>>>>>        Set Location to 115 97
77328>>>>>>>        Set peAnchors to anBottomRight
77329>>>>>>>
77329>>>>>>>        Procedure OnClick
77332>>>>>>>            Send OK of oSelList
77333>>>>>>>        End_Procedure
77334>>>>>>>
77334>>>>>>>    End_Object 
77335>>>>>>>
77335>>>>>>>    Object oCancel_bn is a Button
77337>>>>>>>        Set Label to "&Cancel"
77338>>>>>>>        Set Location to 115 151
77339>>>>>>>        Set peAnchors to anBottomRight
77340>>>>>>>
77340>>>>>>>        Procedure OnClick
77343>>>>>>>            Send Cancel of oSelList
77344>>>>>>>        End_Procedure
77345>>>>>>>
77345>>>>>>>    End_Object 
77346>>>>>>>
77346>>>>>>>    Object oSearch_bn is a Button
77348>>>>>>>        Set Label to "&Search..."
77349>>>>>>>        Set Location to 115 205
77350>>>>>>>        Set peAnchors to anBottomRight
77351>>>>>>>
77351>>>>>>>        Procedure OnClick
77354>>>>>>>            Send Search of oSelList
77355>>>>>>>        End_Procedure
77356>>>>>>>
77356>>>>>>>    End_Object 
77357>>>>>>>
77357>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77358>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77359>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77360>>>>>>>
77360>>>>>>>
77360>>>>>>>CD_End_Object // Nacionalidad_sl
77362>>>>>>>>
77362>>>Use cEmpleadoTableDataDictionary.dd
Including file: cEmpleadoTableDataDictionary.dd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\cEmpleadoTableDataDictionary.dd)
77362>>>>>Use DataDict.pkg
77362>>>>>
77362>>>>>Open EmpleadoTable
77364>>>>>Open Nacionalidad
77366>>>>>Open sysemFile
77368>>>>>Open MarcajeTable
Including file: MarcajeTable.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\MarcajeTable.fd)
77370>>>>>
77370>>>>>Register_Object EmpleadoTable_sl
77370>>>>>Register_Object Nacionalidad_sl
77370>>>>>
77370>>>>>Class cEmpleadoTableDataDictionary is a DataDictionary
77371>>>>>    
77371>>>>>    Procedure Construct_Object
77373>>>>>        Forward Send Construct_Object
77375>>>>>        Set Main_File to EmpleadoTable.File_Number
77376>>>>>
77376>>>>>        Set Add_Client_File to MarcajeTable.File_Number
77377>>>>>
77377>>>>>        Set Add_System_File to sysemFile.File_Number DD_Lock_On_All
77378>>>>>
77378>>>>>        Set Add_Server_File to Nacionalidad.File_Number
77379>>>>>
77379>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77380>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77381>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77382>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77383>>>>>
77383>>>>>        Set Key_Field_State Field EmpleadoTable.Codigo to True
77384>>>>>        Set Field_Auto_Increment Field EmpleadoTable.Codigo to File_Field sysemFile.CodigoEmpleado
77385>>>>>        Set Field_Prompt_Object Field EmpleadoTable.Codigo to EmpleadoTable_sl
77386>>>>>
77386>>>>>        Set Field_Option Field EmpleadoTable.PrimerNombre DD_CAPSLOCK to True
77387>>>>>        Set Field_Option Field EmpleadoTable.PrimerNombre DD_REQUIRED to True
77388>>>>>
77388>>>>>        Set Field_Option Field EmpleadoTable.SegundoNombre DD_CAPSLOCK to True
77389>>>>>        Set Field_Option Field EmpleadoTable.SegundoNombre DD_REQUIRED to True
77390>>>>>
77390>>>>>        Set Field_Option Field EmpleadoTable.PrimerApellido DD_CAPSLOCK to True
77391>>>>>        Set Field_Option Field EmpleadoTable.PrimerApellido DD_REQUIRED to True
77392>>>>>
77392>>>>>        Set Field_Option Field EmpleadoTable.SegundoApellido DD_CAPSLOCK to True
77393>>>>>        Set Field_Option Field EmpleadoTable.SegundoApellido DD_REQUIRED to True
77394>>>>>        Set Field_Option Field EmpleadoTable.Nacionalidad DD_CAPSLOCK to True
77395>>>>>        Set Field_Prompt_Object Field EmpleadoTable.Nacionalidad to Nacionalidad_sl
77396>>>>>        Set Field_Option Field EmpleadoTable.Nacionalidad DD_REQUIRED to True
77397>>>>>
77397>>>>>    End_Procedure
77398>>>>>
77398>>>>>End_Class
77399>>>>>
77399>>>>>Use Nacionalidad.sl
77399>>>>>Use EmpleadoTable.sl
Including file: EmpleadoTable.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\EmpleadoTable.sl)
77399>>>>>>>// EmpleadoTable.sl
77399>>>>>>>// EmpleadoTable Lookup List
77399>>>>>>>
77399>>>>>>>Use DFClient.pkg
77399>>>>>>>Use cDbCJGridPromptList.pkg
77399>>>>>>>Use cDbCJGridColumn.pkg
77399>>>>>>>Use Windows.pkg
77399>>>>>>>
77399>>>>>>>Use cNacionalidadDataDictionary.dd
77399>>>>>>>Use cEmpleadoTableDataDictionary.dd
77399>>>>>>>
77399>>>>>>>CD_Popup_Object EmpleadoTable_sl is a dbModalPanel
77417>>>>>>>>
77417>>>>>>>    Set Location to 5 5
77418>>>>>>>    Set Size to 134 610
77419>>>>>>>    Set Label To "EmpleadoTable Lookup List"
77420>>>>>>>    Set Border_Style to Border_Thick
77421>>>>>>>    Set Minimize_Icon to False
77422>>>>>>>
77422>>>>>>>
77422>>>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77424>>>>>>>    End_Object 
77425>>>>>>>
77425>>>>>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
77427>>>>>>>        Set DDO_Server To oNacionalidad_DD
77428>>>>>>>    End_Object 
77429>>>>>>>
77429>>>>>>>    Set Main_DD To oEmpleadoTable_DD
77430>>>>>>>    Set Server  To oEmpleadoTable_DD
77431>>>>>>>
77431>>>>>>>
77431>>>>>>>
77431>>>>>>>    Object oSelList is a cDbCJGridPromptList
77433>>>>>>>        Set Size to 105 600
77434>>>>>>>        Set Location to 5 5
77435>>>>>>>        Set peAnchors to anAll
77436>>>>>>>        Set psLayoutSection to "EmpleadoTable_sl_oSelList"
77437>>>>>>>        Set Ordering to 1
77438>>>>>>>        Set pbAutoServer to True
77439>>>>>>>
77439>>>>>>>        Object oEmpleadoTable_Codigo is a cDbCJGridColumn
77441>>>>>>>            Entry_Item EmpleadoTable.Codigo
77442>>>>>>>            Set piWidth to 105
77443>>>>>>>            Set psCaption to "Codigo"
77444>>>>>>>        End_Object 
77445>>>>>>>
77445>>>>>>>        Object oEmpleadoTable_PrimerNombre is a cDbCJGridColumn
77447>>>>>>>            Entry_Item EmpleadoTable.PrimerNombre
77448>>>>>>>            Set piWidth to 262
77449>>>>>>>            Set psCaption to "Primer Nombre"
77450>>>>>>>        End_Object 
77451>>>>>>>
77451>>>>>>>        Object oEmpleadoTable_SegundoNombre is a cDbCJGridColumn
77453>>>>>>>            Entry_Item EmpleadoTable.SegundoNombre
77454>>>>>>>            Set piWidth to 262
77455>>>>>>>            Set psCaption to "Segundo Nombre"
77456>>>>>>>        End_Object 
77457>>>>>>>
77457>>>>>>>        Object oEmpleadoTable_PrimerApellido is a cDbCJGridColumn
77459>>>>>>>            Entry_Item EmpleadoTable.PrimerApellido
77460>>>>>>>            Set piWidth to 262
77461>>>>>>>            Set psCaption to "Primer Apellido"
77462>>>>>>>        End_Object 
77463>>>>>>>
77463>>>>>>>        Object oEmpleadoTable_SegundoApellido is a cDbCJGridColumn
77465>>>>>>>            Entry_Item EmpleadoTable.SegundoApellido
77466>>>>>>>            Set piWidth to 262
77467>>>>>>>            Set psCaption to "Segundo Apellido"
77468>>>>>>>        End_Object 
77469>>>>>>>
77469>>>>>>>        Object oNacionalidad_CodigoNacionalidad is a cDbCJGridColumn
77471>>>>>>>            Entry_Item Nacionalidad.CodigoNacionalidad
77472>>>>>>>            Set piWidth to 157
77473>>>>>>>            Set psCaption to "Nacionalidad"
77474>>>>>>>        End_Object 
77475>>>>>>>
77475>>>>>>>
77475>>>>>>>    End_Object 
77476>>>>>>>
77476>>>>>>>    Object oOk_bn is a Button
77478>>>>>>>        Set Label to "&Ok"
77479>>>>>>>        Set Location to 115 447
77480>>>>>>>        Set peAnchors to anBottomRight
77481>>>>>>>
77481>>>>>>>        Procedure OnClick
77484>>>>>>>            Send OK of oSelList
77485>>>>>>>        End_Procedure
77486>>>>>>>
77486>>>>>>>    End_Object 
77487>>>>>>>
77487>>>>>>>    Object oCancel_bn is a Button
77489>>>>>>>        Set Label to "&Cancel"
77490>>>>>>>        Set Location to 115 501
77491>>>>>>>        Set peAnchors to anBottomRight
77492>>>>>>>
77492>>>>>>>        Procedure OnClick
77495>>>>>>>            Send Cancel of oSelList
77496>>>>>>>        End_Procedure
77497>>>>>>>
77497>>>>>>>    End_Object 
77498>>>>>>>
77498>>>>>>>    Object oSearch_bn is a Button
77500>>>>>>>        Set Label to "&Search..."
77501>>>>>>>        Set Location to 115 555
77502>>>>>>>        Set peAnchors to anBottomRight
77503>>>>>>>
77503>>>>>>>        Procedure OnClick
77506>>>>>>>            Send Search of oSelList
77507>>>>>>>        End_Procedure
77508>>>>>>>
77508>>>>>>>    End_Object 
77509>>>>>>>
77509>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77510>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77511>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77512>>>>>>>
77512>>>>>>>
77512>>>>>>>CD_End_Object // EmpleadoTable_sl
77514>>>>>>>>
77514>>>
77514>>>ACTIVATE_VIEW Activate_EMPLEADOS FOR EMPLEADOS
77524>>>>
77524>>>Object EMPLEADOS is a dbView
77526>>>    Set Location to 5 5
77527>>>    Set Size to 168 512
77528>>>    Set Label To "EMPLEADOS"
77529>>>    Set Border_Style to Border_Thick
77530>>>
77530>>>
77530>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77532>>>    End_Object 
77533>>>
77533>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
77535>>>        Set DDO_Server To oNacionalidad_DD
77536>>>    End_Object 
77537>>>
77537>>>    Set Main_DD To oEmpleadoTable_DD
77538>>>    Set Server  To oEmpleadoTable_DD
77539>>>
77539>>>
77539>>>
77539>>>    Object oEmpleadoTableCodigo is a dbForm
77541>>>        Entry_Item EmpleadoTable.Codigo
77542>>>        Set Size to 13 262
77543>>>        Set Location to 5 61
77544>>>        Set peAnchors to anTopLeftRight
77545>>>        Set Label to "Codigo"
77546>>>        Set Label_Justification_mode to jMode_Left
77547>>>        Set Label_Col_Offset to 56
77548>>>        Set Label_row_Offset to 0
77549>>>    End_Object 
77550>>>
77550>>>    Object oEmpleadoTablePrimerNombre is a dbForm
77552>>>        Entry_Item EmpleadoTable.PrimerNombre
77553>>>        Set Size to 13 446
77554>>>        Set Location to 20 61
77555>>>        Set peAnchors to anTopLeftRight
77556>>>        Set Label to "Primer Nombre"
77557>>>        Set Label_Justification_mode to jMode_Left
77558>>>        Set Label_Col_Offset to 56
77559>>>        Set Label_row_Offset to 0
77560>>>    End_Object 
77561>>>
77561>>>    Object oEmpleadoTableSegundoNombre is a dbForm
77563>>>        Entry_Item EmpleadoTable.SegundoNombre
77564>>>        Set Size to 13 446
77565>>>        Set Location to 35 61
77566>>>        Set peAnchors to anTopLeftRight
77567>>>        Set Label to "Segundo Nombre"
77568>>>        Set Label_Justification_mode to jMode_Left
77569>>>        Set Label_Col_Offset to 56
77570>>>        Set Label_row_Offset to 0
77571>>>    End_Object 
77572>>>
77572>>>    Object oEmpleadoTablePrimerApellido is a dbForm
77574>>>        Entry_Item EmpleadoTable.PrimerApellido
77575>>>        Set Size to 13 446
77576>>>        Set Location to 50 61
77577>>>        Set peAnchors to anTopLeftRight
77578>>>        Set Label to "Primer Apellido"
77579>>>        Set Label_Justification_mode to jMode_Left
77580>>>        Set Label_Col_Offset to 56
77581>>>        Set Label_row_Offset to 0
77582>>>    End_Object 
77583>>>
77583>>>    Object oEmpleadoTableSegundoApellido is a dbForm
77585>>>        Entry_Item EmpleadoTable.SegundoApellido
77586>>>        Set Size to 13 446
77587>>>        Set Location to 65 61
77588>>>        Set peAnchors to anTopLeftRight
77589>>>        Set Label to "Segundo Apellido"
77590>>>        Set Label_Justification_mode to jMode_Left
77591>>>        Set Label_Col_Offset to 56
77592>>>        Set Label_row_Offset to 0
77593>>>    End_Object 
77594>>>
77594>>>    Object oNacionalidadCodigoNacionalidad is a dbForm
77596>>>        Entry_Item Nacionalidad.CodigoNacionalidad
77597>>>        Set Size to 13 292
77598>>>        Set Location to 80 61
77599>>>        Set peAnchors to anTopLeftRight
77600>>>        Set Label to "Nacionalidad"
77601>>>        Set Label_Justification_mode to jMode_Left
77602>>>        Set Label_Col_Offset to 56
77603>>>        Set Label_row_Offset to 0
77604>>>    End_Object 
77605>>>
77605>>>
77605>>>End_Object 
77606>        Use MARCAJES.vw
Including file: MARCAJES.vw    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\MARCAJES.vw)
77606>>>// C:\DataFlex Projects\JUEVESAPPMARCAJES\AppSrc\MARCAJES.vw
77606>>>// MARCAJES
77606>>>//
77606>>>
77606>>>Use DFClient.pkg
77606>>>Use DFEntry.pkg
77606>>>
77606>>>Use cNacionalidadDataDictionary.dd
77606>>>Use cEmpleadoTableDataDictionary.dd
77606>>>Use cTipoMarcajeTableDataDictionary.dd
Including file: cTipoMarcajeTableDataDictionary.dd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\cTipoMarcajeTableDataDictionary.dd)
77606>>>>>Use DataDict.pkg
77606>>>>>
77606>>>>>Open TipoMarcajeTable
Including file: TipoMarcajeTable.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\TipoMarcajeTable.fd)
77608>>>>>Open sysemFile
77610>>>>>Open MarcajeTable
77612>>>>>
77612>>>>>Register_Object TipoMarcajeTable_sl
77612>>>>>
77612>>>>>Class cTipoMarcajeTableDataDictionary is a DataDictionary
77613>>>>>    
77613>>>>>    Procedure Construct_Object
77615>>>>>        Forward Send Construct_Object
77617>>>>>        Set Main_File to TipoMarcajeTable.File_Number
77618>>>>>
77618>>>>>        Set Add_Client_File to MarcajeTable.File_Number
77619>>>>>
77619>>>>>        Set Add_System_File to sysemFile.File_Number DD_Lock_On_All
77620>>>>>
77620>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77621>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77622>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77623>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77624>>>>>
77624>>>>>        Set Key_Field_State Field TipoMarcajeTable.Codigo to True
77625>>>>>        Set Field_Auto_Increment Field TipoMarcajeTable.Codigo to File_Field sysemFile.CodigoTipoMarcaje
77626>>>>>        Set Field_Prompt_Object Field TipoMarcajeTable.Codigo to TipoMarcajeTable_sl
77627>>>>>
77627>>>>>    End_Procedure
77628>>>>>
77628>>>>>End_Class
77629>>>>>
77629>>>>>Use TipoMarcajeTable.sl
Including file: TipoMarcajeTable.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\TipoMarcajeTable.sl)
77629>>>>>>>// TipoMarcajeTable.sl
77629>>>>>>>// TipoMarcajeTable Lookup List
77629>>>>>>>
77629>>>>>>>Use DFClient.pkg
77629>>>>>>>Use cDbCJGridPromptList.pkg
77629>>>>>>>Use cDbCJGridColumn.pkg
77629>>>>>>>Use Windows.pkg
77629>>>>>>>
77629>>>>>>>Use cTipoMarcajeTableDataDictionary.dd
77629>>>>>>>
77629>>>>>>>CD_Popup_Object TipoMarcajeTable_sl is a dbModalPanel
77647>>>>>>>>
77647>>>>>>>    Set Location to 5 5
77648>>>>>>>    Set Size to 134 200
77649>>>>>>>    Set Label To "TipoMarcajeTable Lookup List"
77650>>>>>>>    Set Border_Style to Border_Thick
77651>>>>>>>    Set Minimize_Icon to False
77652>>>>>>>
77652>>>>>>>
77652>>>>>>>    Object oTipoMarcajeTable_DD is a cTipoMarcajeTableDataDictionary
77654>>>>>>>    End_Object 
77655>>>>>>>
77655>>>>>>>    Set Main_DD To oTipoMarcajeTable_DD
77656>>>>>>>    Set Server  To oTipoMarcajeTable_DD
77657>>>>>>>
77657>>>>>>>
77657>>>>>>>
77657>>>>>>>    Object oSelList is a cDbCJGridPromptList
77659>>>>>>>        Set Size to 105 190
77660>>>>>>>        Set Location to 5 5
77661>>>>>>>        Set peAnchors to anAll
77662>>>>>>>        Set psLayoutSection to "TipoMarcajeTable_sl_oSelList"
77663>>>>>>>        Set Ordering to 1
77664>>>>>>>        Set pbAutoServer to True
77665>>>>>>>
77665>>>>>>>        Object oTipoMarcajeTable_Codigo is a cDbCJGridColumn
77667>>>>>>>            Entry_Item TipoMarcajeTable.Codigo
77668>>>>>>>            Set piWidth to 105
77669>>>>>>>            Set psCaption to "Codigo"
77670>>>>>>>        End_Object 
77671>>>>>>>
77671>>>>>>>        Object oTipoMarcajeTable_TipoMarcaje is a cDbCJGridColumn
77673>>>>>>>            Entry_Item TipoMarcajeTable.TipoMarcaje
77674>>>>>>>            Set piWidth to 210
77675>>>>>>>            Set psCaption to "Tipo Marcaje"
77676>>>>>>>        End_Object 
77677>>>>>>>
77677>>>>>>>
77677>>>>>>>    End_Object 
77678>>>>>>>
77678>>>>>>>    Object oOk_bn is a Button
77680>>>>>>>        Set Label to "&Ok"
77681>>>>>>>        Set Location to 115 37
77682>>>>>>>        Set peAnchors to anBottomRight
77683>>>>>>>
77683>>>>>>>        Procedure OnClick
77686>>>>>>>            Send OK of oSelList
77687>>>>>>>        End_Procedure
77688>>>>>>>
77688>>>>>>>    End_Object 
77689>>>>>>>
77689>>>>>>>    Object oCancel_bn is a Button
77691>>>>>>>        Set Label to "&Cancel"
77692>>>>>>>        Set Location to 115 91
77693>>>>>>>        Set peAnchors to anBottomRight
77694>>>>>>>
77694>>>>>>>        Procedure OnClick
77697>>>>>>>            Send Cancel of oSelList
77698>>>>>>>        End_Procedure
77699>>>>>>>
77699>>>>>>>    End_Object 
77700>>>>>>>
77700>>>>>>>    Object oSearch_bn is a Button
77702>>>>>>>        Set Label to "&Search..."
77703>>>>>>>        Set Location to 115 145
77704>>>>>>>        Set peAnchors to anBottomRight
77705>>>>>>>
77705>>>>>>>        Procedure OnClick
77708>>>>>>>            Send Search of oSelList
77709>>>>>>>        End_Procedure
77710>>>>>>>
77710>>>>>>>    End_Object 
77711>>>>>>>
77711>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77712>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77713>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77714>>>>>>>
77714>>>>>>>
77714>>>>>>>CD_End_Object // TipoMarcajeTable_sl
77716>>>>>>>>
77716>>>Use cMarcajeTableDataDictionary.dd
Including file: cMarcajeTableDataDictionary.dd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\cMarcajeTableDataDictionary.dd)
77716>>>>>Use DataDict.pkg
77716>>>>>
77716>>>>>Open MarcajeTable
77718>>>>>Open EmpleadoTable
77720>>>>>Open TipoMarcajeTable
77722>>>>>Open sysemFile
77724>>>>>
77724>>>>>Register_Object TipoMarcajeTable_sl
77724>>>>>Register_Object LISTAMARCAJESLS
77724>>>>>
77724>>>>>Class cMarcajeTableDataDictionary is a DataDictionary
77725>>>>>    
77725>>>>>    Procedure Construct_Object
77727>>>>>        Forward Send Construct_Object
77729>>>>>        Set Main_File to MarcajeTable.File_Number
77730>>>>>
77730>>>>>        Set Add_System_File to sysemFile.File_Number DD_Lock_On_All
77731>>>>>
77731>>>>>        Set Add_Server_File to EmpleadoTable.File_Number
77732>>>>>        Set Add_Server_File to TipoMarcajeTable.File_Number
77733>>>>>
77733>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77734>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77735>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77736>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77737>>>>>
77737>>>>>        Set Key_Field_State Field MarcajeTable.Codigo to True
77738>>>>>        Set Field_Auto_Increment Field MarcajeTable.Codigo to File_Field sysemFile.CodigoMarcaje
77739>>>>>        Set Field_Option Field MarcajeTable.Codigo DD_CAPSLOCK to True
77740>>>>>        Set Field_Prompt_Object Field MarcajeTable.Codigo to LISTAMARCAJESLS
77741>>>>>
77741>>>>>        Set Field_Option Field MarcajeTable.EmpleadoCodigo DD_REQUIRED to True
77742>>>>>
77742>>>>>        Set Field_Option Field MarcajeTable.FechaMarcaje DD_CAPSLOCK to True
77743>>>>>        Set Field_Option Field MarcajeTable.FechaMarcaje DD_REQUIRED to True
77744>>>>>
77744>>>>>        Set Field_Option Field MarcajeTable.HoraMarcaje DD_CAPSLOCK to True
77745>>>>>        Set Field_Option Field MarcajeTable.HoraMarcaje DD_REQUIRED to True
77746>>>>>
77746>>>>>        Set Field_Prompt_Object Field MarcajeTable.TipoMarcaje to TipoMarcajeTable_sl
77747>>>>>        Set Field_Option Field MarcajeTable.TipoMarcaje DD_REQUIRED to True
77748>>>>>
77748>>>>>    End_Procedure
77749>>>>>
77749>>>>>End_Class
77750>>>>>
77750>>>>>Use LISTAMARCAJESLS.sl
Including file: LISTAMARCAJESLS.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\LISTAMARCAJESLS.sl)
77750>>>>>>>// LISTAMARCAJESLS.sl
77750>>>>>>>// MarcajeTable Lookup List
77750>>>>>>>
77750>>>>>>>Use DFClient.pkg
77750>>>>>>>Use cDbCJGridPromptList.pkg
77750>>>>>>>Use cDbCJGridColumn.pkg
77750>>>>>>>Use Windows.pkg
77750>>>>>>>
77750>>>>>>>Use cNacionalidadDataDictionary.dd
77750>>>>>>>Use cEmpleadoTableDataDictionary.dd
77750>>>>>>>Use cTipoMarcajeTableDataDictionary.dd
77750>>>>>>>Use cMarcajeTableDataDictionary.dd
77750>>>>>>>
77750>>>>>>>CD_Popup_Object LISTAMARCAJESLS is a dbModalPanel
77768>>>>>>>>
77768>>>>>>>    Set Location to 5 5
77769>>>>>>>    Set Size to 134 246
77770>>>>>>>    Set Label To "MarcajeTable Lookup List"
77771>>>>>>>    Set Border_Style to Border_Thick
77772>>>>>>>    Set Minimize_Icon to False
77773>>>>>>>
77773>>>>>>>
77773>>>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77775>>>>>>>    End_Object 
77776>>>>>>>
77776>>>>>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
77778>>>>>>>        Set DDO_Server To oNacionalidad_DD
77779>>>>>>>    End_Object 
77780>>>>>>>
77780>>>>>>>    Object oTipoMarcajeTable_DD is a cTipoMarcajeTableDataDictionary
77782>>>>>>>    End_Object 
77783>>>>>>>
77783>>>>>>>    Object oMarcajeTable_DD is a cMarcajeTableDataDictionary
77785>>>>>>>        Set DDO_Server To oEmpleadoTable_DD
77786>>>>>>>        Set DDO_Server To oTipoMarcajeTable_DD
77787>>>>>>>    End_Object 
77788>>>>>>>
77788>>>>>>>    Set Main_DD To oMarcajeTable_DD
77789>>>>>>>    Set Server  To oMarcajeTable_DD
77790>>>>>>>
77790>>>>>>>
77790>>>>>>>
77790>>>>>>>    Object oSelList is a cDbCJGridPromptList
77792>>>>>>>        Set Size to 105 236
77793>>>>>>>        Set Location to 5 5
77794>>>>>>>        Set peAnchors to anAll
77795>>>>>>>        Set psLayoutSection to "LISTAMARCAJESLS_oSelList"
77796>>>>>>>        Set Ordering to 1
77797>>>>>>>        Set pbAutoServer to True
77798>>>>>>>
77798>>>>>>>        Object oMarcajeTable_Codigo is a cDbCJGridColumn
77800>>>>>>>            Entry_Item MarcajeTable.Codigo
77801>>>>>>>            Set piWidth to 90
77802>>>>>>>            Set psCaption to "Codigo"
77803>>>>>>>        End_Object
77804>>>>>>>
77804>>>>>>>        Object oMarcajeTable_EmpleadoCodigo is a cDbCJGridColumn
77806>>>>>>>            Entry_Item EmpleadoTable.Codigo
77807>>>>>>>            Set piWidth to 90
77808>>>>>>>            Set psCaption to "EmpleadoCodigo"
77809>>>>>>>        End_Object
77810>>>>>>>
77810>>>>>>>        Object oMarcajeTable_FechaMarcaje is a cDbCJGridColumn
77812>>>>>>>            Entry_Item MarcajeTable.FechaMarcaje
77813>>>>>>>            Set piWidth to 90
77814>>>>>>>            Set psCaption to "FechaMarcaje"
77815>>>>>>>        End_Object
77816>>>>>>>
77816>>>>>>>        Object oMarcajeTable_HoraMarcaje is a cDbCJGridColumn
77818>>>>>>>            Entry_Item MarcajeTable.HoraMarcaje
77819>>>>>>>            Set piWidth to 132
77820>>>>>>>            Set psCaption to "HoraMarcaje"
77821>>>>>>>        End_Object
77822>>>>>>>
77822>>>>>>>        Object oMarcajeTable_TipoMarcaje is a cDbCJGridColumn
77824>>>>>>>            Entry_Item TipoMarcajeTable.Codigo
77825>>>>>>>            Set piWidth to 90
77826>>>>>>>            Set psCaption to "TipoMarcaje"
77827>>>>>>>        End_Object
77828>>>>>>>
77828>>>>>>>
77828>>>>>>>    End_Object 
77829>>>>>>>
77829>>>>>>>    Object oOk_bn is a Button
77831>>>>>>>        Set Label to "&Ok"
77832>>>>>>>        Set Location to 115 83
77833>>>>>>>        Set peAnchors to anBottomRight
77834>>>>>>>
77834>>>>>>>        Procedure OnClick
77837>>>>>>>            Send OK of oSelList
77838>>>>>>>        End_Procedure
77839>>>>>>>
77839>>>>>>>    End_Object 
77840>>>>>>>
77840>>>>>>>    Object oCancel_bn is a Button
77842>>>>>>>        Set Label to "&Cancel"
77843>>>>>>>        Set Location to 115 137
77844>>>>>>>        Set peAnchors to anBottomRight
77845>>>>>>>
77845>>>>>>>        Procedure OnClick
77848>>>>>>>            Send Cancel of oSelList
77849>>>>>>>        End_Procedure
77850>>>>>>>
77850>>>>>>>    End_Object 
77851>>>>>>>
77851>>>>>>>    Object oSearch_bn is a Button
77853>>>>>>>        Set Label to "&Search..."
77854>>>>>>>        Set Location to 115 191
77855>>>>>>>        Set peAnchors to anBottomRight
77856>>>>>>>
77856>>>>>>>        Procedure OnClick
77859>>>>>>>            Send Search of oSelList
77860>>>>>>>        End_Procedure
77861>>>>>>>
77861>>>>>>>    End_Object 
77862>>>>>>>
77862>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77863>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77864>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77865>>>>>>>
77865>>>>>>>
77865>>>>>>>CD_End_Object // LISTAMARCAJESLS
77867>>>>>>>>
77867>>>>>Use TipoMarcajeTable.sl
77867>>>Use cDbCJGrid.pkg
77867>>>Use cdbCJGridColumn.pkg
77867>>>
77867>>>ACTIVATE_VIEW Activate_MARCAJES FOR MARCAJES
77877>>>>
77877>>>Object MARCAJES is a dbView
77879>>>    Set Location to 5 5
77880>>>    Set Size to 301 585
77881>>>    Set Label To "MARCAJES"
77882>>>    Set Border_Style to Border_Thick
77883>>>
77883>>>
77883>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77885>>>    End_Object 
77886>>>
77886>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
77888>>>        Set DDO_Server To oNacionalidad_DD
77889>>>    End_Object 
77890>>>
77890>>>    Object oTipoMarcajeTable_DD is a cTipoMarcajeTableDataDictionary
77892>>>    End_Object 
77893>>>
77893>>>    Object oMarcajeTable_DD is a cMarcajeTableDataDictionary
77895>>>        Set DDO_Server To oEmpleadoTable_DD
77896>>>        Set DDO_Server To oTipoMarcajeTable_DD
77897>>>    End_Object 
77898>>>
77898>>>    Set Main_DD To oMarcajeTable_DD
77899>>>    Set Server  To oMarcajeTable_DD
77900>>>
77900>>>    Object oDbCJGrid1 is a cDbCJGrid
77902>>>        Set Size to 262 526
77903>>>        Set Location to 22 23
77904>>>
77904>>>        Object oMarcajeTable_Codigo is a cDbCJGridColumn
77906>>>            Entry_Item MarcajeTable.Codigo
77907>>>            Set piWidth to 168
77908>>>            Set psCaption to "Codigo"
77909>>>        End_Object
77910>>>
77910>>>        Object oMarcajeTable_EmpleadoCodigo is a cDbCJGridColumn
77912>>>            Entry_Item EmpleadoTable.Codigo
77913>>>            Set piWidth to 168
77914>>>            Set psCaption to "Empleado Codigo"
77915>>>        End_Object
77916>>>
77916>>>        Object oMarcajeTable_FechaMarcaje is a cDbCJGridColumn
77918>>>            Entry_Item MarcajeTable.FechaMarcaje
77919>>>            Set piWidth to 168
77920>>>            Set psCaption to "Fecha Marcaje"
77921>>>        End_Object
77922>>>
77922>>>        Object oMarcajeTable_HoraMarcaje is a cDbCJGridColumn
77924>>>            Entry_Item MarcajeTable.HoraMarcaje
77925>>>            Set piWidth to 247
77926>>>            Set psCaption to "HoraMarcaje"
77927>>>        End_Object
77928>>>
77928>>>        Object oMarcajeTable_TipoMarcaje is a cDbCJGridColumn
77930>>>            Entry_Item TipoMarcajeTable.Codigo
77931>>>            Set piWidth to 169
77932>>>            Set psCaption to "Tipo Marcaje"
77933>>>        End_Object
77934>>>    End_Object
77935>>>
77935>>>
77935>>>End_Object 
77936>        Use MARCAJES.rv
Including file: MARCAJES.rv    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\MARCAJES.rv)
77936>>>Use Windows.pkg
77936>>>Use DFRptVw.pkg
77936>>>Use DFRpt.pkg
77936>>>Use File_Dlg.Pkg
77936>>>Use DfAllEnt.pkg
77936>>>
77936>>>Activate_View Activate_MARCAJES for MARCAJES
77946>>>>
77946>>>Object MARCAJES is a ReportView
77948>>>    Set Location to 6 6
77949>>>    Set Size to 119 210
77950>>>    Set Label to "MARCAJES"
77951>>>
77951>>>    Object oSaveAsDialog is a SaveAsDialog
77953>>>    End_Object
77954>>>
77954>>>    Procedure StartReport
77957>>>        Integer iOutputDevice 
77957>>>        Handle hoWorkspace
77957>>>        String sFileName sCurrentDirectory sDataPath
77957>>>    
77957>>>        Get Output_Device_Mode to iOutputDevice
77958>>>    
77958>>>        Case Begin
77958>>>            Case (iOutputDevice = PRINT_TO_WINDOW)
77960>>>                Get_Current_Directory to sCurrentDirectory
77961>>>                Get phoWorkspace Of ghoApplication to hoWorkspace
77962>>>                Get psDataPath Of hoWorkspace to sDataPath
77963>>>                Get PathAtIndex Of hoWorkspace sDataPath 1 to sDataPath
77964>>>                Set_Directory sDataPath
77965>>>                Make_Temp_File "TXT" sFileName
77966>>>                Set_Directory sCurrentDirectory
77967>>>                If (Right(sDataPath, 1) <> Sysconf(SYSCONF_DIR_SEPARATOR)) Begin
77969>>>                    Move (sDataPath - Sysconf(SYSCONF_DIR_SEPARATOR)) To sDataPath
77970>>>                End
77970>>>>
77970>>>                Move (sDataPath - sFileName) to sFileName
77971>>>                Set Output_Device_Name to sFileName
77972>>>                Case Break
77973>>>            Case (iOutputDevice = PRINT_TO_PRINTER)
77976>>>                Set Output_Device_Name to "WinLST:"
77977>>>                Case Break
77978>>>          
77978>>>        Case End
77978>>>    
77978>>>        Send Run_Report
77979>>>    
77979>>>        If (iOutputDevice = PRINT_TO_WINDOW) Begin
77981>>>            Runprogram Background "NotePad" sFileName
77982>>>            EraseFile sFileName
77983>>>>
77983>>>        End
77983>>>>
77983>>>    End_Procedure
77984>>>    
77984>>>    Object oBasicReport is a BasicReport
77986>>>        // Set Server To DDOName
77986>>>        
77986>>>        // Create a new file with the images for the report. Include this filename in the
77986>>>        // component with a USE statement. Replace the HeaderSection, BodySection, FooterSection
77986>>>        // with the imagenames you've created.
77986>>>        // NOTE: 
77986>>>        // - Image names must be unique throughout the program
77986>>>        // - Images start at the first column of the sourcecode in the format /ImageName
77986>>>        // - End of an image is the start of a new one or a /*
77986>>>        Function Starting_Main_Report Returns Integer
77989>>>            Integer iRetval
77989>>>            
77989>>>            Forward Get Starting_Main_Report to iRetval
77991>>>            
77991>>>            Function_Return iRetval
77992>>>        End_Function
77993>>>     
77993>>>
77993>>>    End_Object
77994>>>
77994>>>    Object TxtReporte is a Form
77996>>>        Set Size to 13 100
77997>>>        Set Location to 36 77
77998>>>        Set Label to "Seleccionar"
77999>>>        Set Prompt_Button_Mode to PB_PromptOn
78000>>>    
78000>>>        // OnChange is called on every changed character
78000>>>    //    Procedure OnChange
78000>>>    //        String sValue
78000>>>    //    
78000>>>    //        Get Value to sValue
78000>>>    //    End_Procedure
78000>>>    Set Prompt_Object to (EmpleadoTable_sl(Current_Object))
78001>>>    
78001>>>        Procedure Prompt_Callback Integer hSL
78004>>>            Set initial_column of hSL to 0
78005>>>            Set export_column of hSL to 0
78006>>>            
78006>>>
78006>>>        End_Procedure
78007>>>    
78007>>>    End_Object
78008>>>
78008>>>    Object BtnGenerarReporte is a Button
78010>>>        Set Size to 14 100
78011>>>        Set Location to 67 78
78012>>>        Set Label to "Generar Reporte"
78013>>>    
78013>>>        // fires when the button is clicked
78013>>>        Procedure OnClick
78016>>>            Send GenerarRerporte
78017>>>        End_Procedure
78018>>>    
78018>>>    End_Object
78019>>>    
78019>>>    // Procedimiento para dar inicio a la generacion del reporte
78019>>>    Procedure GenerarRerporte
78022>>>        String sDatoGenerador
78022>>>        
78022>>>        Move '' to sDatoGenerador  // asignamos valor vacio a nuestra variable
78023>>>        Get Value of TxtReporte to sDatoGenerador // TxtReporte es la caja de texto en nuestro form. traemos us valor y lo asignamos a nuestro sDatoGenerador
78024>>>        
78024>>>        //Creamos una condicion para verificar que sDatoGenerador no este vacio
78024>>>        If (Trim(sDatoGenerador)) ne '' Begin
78026>>>            Clear MarcajeTable  //tabla
78027>>>            Move (Trim(sDatoGenerador)) to MarcajeTable.Codigo  //atributo codiog de la tabla Marcajestable
78028>>>            Find eq MarcajeTable by Index.1   // busca segun el indice
78029>>>>
78029>>>            If [not Found] Begin
78031>>>                Error 200 'Ingrese un Marcaje Valido' // si no se encuentra que retorne el mensaje
78032>>>>
78032>>>                Procedure_Return // retorna el procedimienot para hacer uso del sisema
78033>>>            End
78033>>>>
78033>>>        End
78033>>>>
78033>>>   
78033>>>   
78033>>>        Set Report_Name of (ReporteMarcajesObject(Current_Object)) to "ReporteMarcajes.rpt"
78034>>>        Send Run_Report to (ReporteMarcajesObject(Current_Object))
78035>>>    End_Procedure
78036>>>    
78036>>>   Object ReporteMarcajesObject is a WinQLReport  //Creamos el objeto
78038>>>        Set Output_Destination to WQL_PRINT_TO_WINDOW   // enviar la impresion de pantalla
78039>>>        
78039>>>        Procedure OnInitializeReport
78042>>>            
78042>>>            String var_MarcajesTable var_Parametros var_Seleccion      // declaracion de variable
78042>>>            
78042>>>            Move '' to var_MarcajesTable  // asignamos un valor vacio
78043>>>            
78043>>>            Forward Send OnInitializeReport  // lanzamos el iniciador del reporte
78045>>>            
78045>>>            Get Value of TxtReporte to var_MarcajesTable  // obtenes el valor de la caja de texto y lo asignamos a la variable
78046>>>            
78046>>>            Move '' to var_Parametros // asignamos vacio a parametros
78047>>>            
78047>>>            // Validamos que el lo que se le asigno a var_Marcajes no haya sido un dato vacio
78047>>>            If (var_MarcajesTable ne '') Begin
78049>>>                Move '' to var_Seleccion // asignamos vacio
78050>>>                Append var_Seleccion '{MarcajeTable.Codigo} =' ('"'+var_MarcajesTable+'"')  // adjuntamos la seleccion con el valor asignado
78052>>>            End
78052>>>>
78052>>>            
78052>>>            Append var_Parametros '"'
78053>>>            Append var_Parametros 'LISTA DE MARCAJES"'
78054>>>            
78054>>>     
78054>>>            Set SelectionFormula to var_Seleccion
78055>>>            Set Formula "Titulo" to var_Parametros
78056>>>                
78056>>>            
78056>>>            
78056>>>            
78056>>>        End_Procedure
78057>>>       
78057>>>    
78057>>>   End_Object
78058>>>    
78058>>>
78058>>>
78058>>>End_Object
78059>        Use Prueba.rv
Including file: Prueba.rv    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\Prueba.rv)
78059>>>Use Windows.pkg
78059>>>Use DFRptVw.pkg
78059>>>Use DFRpt.pkg
78059>>>Use File_Dlg.Pkg
78059>>>
78059>>>Activate_View Activate_Prueba for Prueba
78069>>>>
78069>>>Object Prueba is a ReportView
78071>>>    Set Location to 6 6
78072>>>    Set Size to 84 181
78073>>>    Set Label to "Prueba"
78074>>>
78074>>>    Object oSaveAsDialog is a SaveAsDialog
78076>>>    End_Object
78077>>>
78077>>>    Procedure StartReport
78080>>>        Integer iOutputDevice 
78080>>>        Handle hoWorkspace
78080>>>        String sFileName sCurrentDirectory sDataPath
78080>>>    
78080>>>        Get Output_Device_Mode to iOutputDevice
78081>>>    
78081>>>        Case Begin
78081>>>            Case (iOutputDevice = PRINT_TO_WINDOW)
78083>>>                Get_Current_Directory to sCurrentDirectory
78084>>>                Get phoWorkspace Of ghoApplication to hoWorkspace
78085>>>                Get psDataPath Of hoWorkspace to sDataPath
78086>>>                Get PathAtIndex Of hoWorkspace sDataPath 1 to sDataPath
78087>>>                Set_Directory sDataPath
78088>>>                Make_Temp_File "TXT" sFileName
78089>>>                Set_Directory sCurrentDirectory
78090>>>                If (Right(sDataPath, 1) <> Sysconf(SYSCONF_DIR_SEPARATOR)) Begin
78092>>>                    Move (sDataPath - Sysconf(SYSCONF_DIR_SEPARATOR)) To sDataPath
78093>>>                End
78093>>>>
78093>>>                Move (sDataPath - sFileName) to sFileName
78094>>>                Set Output_Device_Name to sFileName
78095>>>                Case Break
78096>>>            
78096>>>        Case End
78096>>>    
78096>>>        Send Run_Report
78097>>>    
78097>>>        If (iOutputDevice = PRINT_TO_WINDOW) Begin
78099>>>            Runprogram Background "NotePad" sFileName
78100>>>            EraseFile sFileName
78101>>>>
78101>>>        End
78101>>>>
78101>>>    End_Procedure
78102>>>    
78102>>>    Object oBasicReport is a BasicReport
78104>>>        // Set Server To DDOName
78104>>>        
78104>>>        // Create a new file with the images for the report. Include this filename in the
78104>>>        // component with a USE statement. Replace the HeaderSection, BodySection, FooterSection
78104>>>        // with the imagenames you've created.
78104>>>        // NOTE: 
78104>>>        // - Image names must be unique throughout the program
78104>>>        // - Images start at the first column of the sourcecode in the format /ImageName
78104>>>        // - End of an image is the start of a new one or a /*
78104>>>
78104>>>        Function Starting_Main_Report Returns Integer
78107>>>            Integer iRetval
78107>>>            
78107>>>            Forward Get Starting_Main_Report to iRetval
78109>>>            
78109>>>            Function_Return iRetval
78110>>>        End_Function
78111>>>
78111>>>      
78111>>>
78111>>>    End_Object
78112>>>    
78112>>>    On_Key Key_Alt+Key_O Send KeyAction of oOkButton
78113>>>  
78113>>>
78113>>>End_Object
78114>        Use R_Marcaje.rv
Including file: R_Marcaje.rv    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\R_Marcaje.rv)
78114>>>Use Windows.pkg
78114>>>Use DFRptVw.pkg
78114>>>Use DFRpt.pkg
78114>>>Use File_Dlg.Pkg
78114>>>Use dfEntry.pkg
78114>>>Use lista_empleado_sl.sl
Including file: lista_empleado_sl.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\lista_empleado_sl.sl)
78114>>>>>//**************************************************************
78114>>>>>// TableLookup.tpl for Windows application for Spanish 
78114>>>>>// translated by Moose Software (www.moose-software.com) 
78114>>>>>// 13/07/2010 Revised for VDF 16.0 by Moose Software
78114>>>>>// 05/02/2012 Revised for VDF 17.0 by Moose Software
78114>>>>>// 13/06/2013 Revised for VDF 17.1 by Moose Software
78114>>>>>// 02/05/2014 Revised for VDF 18.0 by Moose Software
78114>>>>>//*************************************************************
78114>>>>>
78114>>>>>Use Windows.pkg
78114>>>>>Use DFClient.pkg
78114>>>>>use DFSellst.pkg
78114>>>>>Use cNacionalidadDataDictionary.dd
78114>>>>>Use cEmpleadoTableDataDictionary.dd
78114>>>>>Use cTipoMarcajeTableDataDictionary.dd
78114>>>>>Use cMarcajeTableDataDictionary.dd
78114>>>>>
78114>>>>>Object oLista_empleado_sl is a dbModalPanel
78116>>>>>    Object oTipoMarcajeTable_DD is a cTipoMarcajeTableDataDictionary
78118>>>>>    End_Object
78119>>>>>
78119>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
78121>>>>>    End_Object
78122>>>>>
78122>>>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
78124>>>>>        Set DDO_Server to oNacionalidad_DD
78125>>>>>    End_Object
78126>>>>>
78126>>>>>    Object oMarcajeTable_DD is a cMarcajeTableDataDictionary
78128>>>>>        Set DDO_Server to oTipoMarcajeTable_DD
78129>>>>>        Set DDO_Server to oEmpleadoTable_DD
78130>>>>>    End_Object
78131>>>>>
78131>>>>>    Set Main_DD to oMarcajeTable_DD
78132>>>>>    Set Server to oMarcajeTable_DD
78133>>>>>
78133>>>>>    Set Size to 133 292
78134>>>>>    Set Location     to 4 5
78135>>>>>    Set Border_Style to Border_Thick
78136>>>>>    Set Label to "lista_empleado_sl"
78137>>>>>
78137>>>>>    Object oSelList is a dbList
78139>>>>>        Set peAnchors to anAll
78140>>>>>        Set Size      to 105 280
78141>>>>>        Set Location  to 6 6
78142>>>>>
78142>>>>>        Begin_Row
78145>>>>>            Entry_Item MarcajeTable.Codigo
78146>>>>>            Entry_Item MarcajeTable.FechaMarcaje
78147>>>>>            Entry_Item MarcajeTable.HoraMarcaje
78148>>>>>            Entry_Item TipoMarcajeTable.Codigo
78149>>>>>        End_Row
78154>>>>>
78154>>>>>        Set Main_File to MarcajeTable.File_Number
78155>>>>>
78155>>>>>        Set Form_Width 0 to 60
78156>>>>>        Set Header_Label 0 to "Codigo"
78157>>>>>        Set Form_Width 1 to 60
78158>>>>>        Set Header_Label 1 to "FechaMarcaje"
78159>>>>>        Set Form_Width 2 to 88
78160>>>>>        Set Header_Label 2 to "HoraMarcaje"
78161>>>>>        Set Form_Width 3 to 60
78162>>>>>        Set Header_Label 3 to "TipoMarcaje"
78163>>>>>    End_Object
78164>>>>>
78164>>>>>    Object oOK_bn is a Button
78166>>>>>        Set Label     to "&Aceptar"
78167>>>>>        Set Location  to 115 128
78168>>>>>        Set peAnchors to anBottomRight
78169>>>>>
78169>>>>>        Procedure OnClick
78172>>>>>            Send Ok of oSelList
78173>>>>>        End_Procedure
78174>>>>>
78174>>>>>    End_Object
78175>>>>>
78175>>>>>    Object oCancel_bn is a Button
78177>>>>>        Set Label     to "&Cancelar"
78178>>>>>        Set Location  to 115 182
78179>>>>>        Set peAnchors to anBottomRight
78180>>>>>
78180>>>>>        Procedure OnClick
78183>>>>>            Send Cancel of oSelList
78184>>>>>        End_Procedure
78185>>>>>
78185>>>>>    End_Object
78186>>>>>
78186>>>>>    Object oSearch_bn is a Button
78188>>>>>        Set Label     to "&Buscar..."
78189>>>>>        Set Location  to 115 236
78190>>>>>        Set peAnchors to anBottomRight
78191>>>>>
78191>>>>>        Procedure OnClick
78194>>>>>            Send Search of oSelList
78195>>>>>        End_Procedure
78196>>>>>
78196>>>>>    End_Object
78197>>>>>
78197>>>>>    On_Key Key_Alt+Key_A Send KeyAction of oOk_bn
78198>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
78199>>>>>    On_Key Key_Alt+Key_B Send KeyAction of oSearch_bn
78200>>>>>
78200>>>>>End_Object
78201>>>>>
78201>>>>>//*********************************************** end of TableLookup.tpl for Spanish ****************
78201>>>>>
78201>>>
78201>>>Activate_View Activate_R_Marcaje for R_Marcaje
78211>>>>
78211>>>Object R_Marcaje is a ReportView
78213>>>    Set Location to 6 6
78214>>>    Set Size to 172 246
78215>>>    Set Label to "Reporte Marcaje"
78216>>>//
78216>>>//   Object oSaveAsDialog is a SaveAsDialog
78216>>>//   End_Object
78216>>>//
78216>>>//    Procedure StartReport
78216>>>//        Integer iOutputDevice 
78216>>>//        Handle hoWorkspace
78216>>>//        String sFileName sCurrentDirectory sDataPath
78216>>>//    
78216>>>//        Get Output_Device_Mode to iOutputDevice
78216>>>//    
78216>>>//        Case Begin
78216>>>//            Case (iOutputDevice = PRINT_TO_WINDOW)
78216>>>//                Get_Current_Directory to sCurrentDirectory
78216>>>//                Get phoWorkspace of ghoApplication to hoWorkspace
78216>>>//                Get psDataPath of hoWorkspace to sDataPath
78216>>>//                Get PathAtIndex of hoWorkspace sDataPath 1 to sDataPath
78216>>>//                Set_Directory sDataPath
78216>>>//                Make_Temp_File "TXT" sFileName
78216>>>//                Set_Directory sCurrentDirectory
78216>>>//                If (Right(sDataPath, 1) <> Sysconf(SYSCONF_DIR_SEPARATOR)) Begin
78216>>>//                    Move (sDataPath - Sysconf(SYSCONF_DIR_SEPARATOR)) to sDataPath
78216>>>//                End
78216>>>//                Move (sDataPath - sFileName) to sFileName
78216>>>//                Set Output_Device_Name to sFileName
78216>>>//                Case Break
78216>>>//            
78216>>>//        Case End
78216>>>//    
78216>>>//        Send Run_Report
78216>>>//    
78216>>>//        If (iOutputDevice = PRINT_TO_WINDOW) Begin
78216>>>//            Runprogram Background "NotePad" sFileName
78216>>>//            EraseFile sFileName
78216>>>//        End
78216>>>//    End_Procedure
78216>>>//    
78216>>>//    Object oBasicReport is a BasicReport
78216>>>//        // Set Server To DDOName
78216>>>//        
78216>>>//        // Create a new file with the images for the report. Include this filename in the
78216>>>//        // component with a USE statement. Replace the HeaderSection, BodySection, FooterSection
78216>>>//        // with the imagenames you've created.
78216>>>//        // NOTE: 
78216>>>//        // - Image names must be unique throughout the program
78216>>>//        // - Images start at the first column of the sourcecode in the format /ImageName
78216>>>//        // - End of an image is the start of a new one or a /*
78216>>>//
78216>>>//        Function Starting_Main_Report Returns Integer
78216>>>//            Integer iRetval
78216>>>//            
78216>>>//            Forward Get Starting_Main_Report to iRetval
78216>>>//            
78216>>>//            Function_Return iRetval
78216>>>//        End_Function
78216>>>//
78216>>>//     
78216>>>//
78216>>>//    End_Object
78216>>>//
78216>>>    Object TxtReporteX is a Form
78218>>>        Set Size to 13 100
78219>>>        Set Location to 20 79
78220>>>        Set Label to "Seleccionar"
78221>>>        Set Prompt_Button_Mode to PB_PromptOn
78222>>>    
78222>>>        // OnChange is called on every changed character
78222>>>    //    Procedure OnChange
78222>>>    //        String sValue
78222>>>    //    
78222>>>    //        Get Value to sValue
78222>>>    //    End_Procedure
78222>>>    Set Prompt_Object to (oLista_empleado_sl(Current_Object))
78223>>>   // Set Prompt_Object to (LISTAMARCAJESLS(Current_Object))
78223>>>    
78223>>>        Procedure Prompt_Callback Integer hSL
78226>>>            Set initial_column of hSL to 0
78227>>>            Set export_column of hSL to 0
78228>>>            
78228>>>
78228>>>        End_Procedure
78229>>>    
78229>>>    End_Object
78230>>>    Object BtnGenerarReporte is a Button
78232>>>        Set Size to 14 100
78233>>>        Set Location to 145 15
78234>>>        Set Label to "Generar Reporte"
78235>>>    
78235>>>        // fires when the button is clicked
78235>>>        Procedure OnClick
78238>>>            Send GenerarRerporte
78239>>>        End_Procedure
78240>>>    
78240>>>    End_Object
78241>>>    
78241>>>     // Procedimiento para dar inicio a la generacion del reporte
78241>>>    Procedure GenerarRerporte
78244>>>        Integer sDatoGenerador
78244>>>        
78244>>>        Move 0 to sDatoGenerador  // asignamos valor vacio a nuestra variable
78245>>>        Get Value of (TxtReporteX(Current_Object)) item 0 to sDatoGenerador// TxtReporte es la caja de texto en nuestro form. traemos us valor y lo asignamos a nuestro sDatoGenerador
78246>>>        //Creamos una condicion para verificar que sDatoGenerador no este vacio
78246>>>        If (Trim(sDatoGenerador)) ne 0 Begin
78248>>>            Clear MarcajeTable  //tabla
78249>>>            Move (Trim(sDatoGenerador)) to MarcajeTable.Codigo  //atributo codiog de la tabla Marcajestable
78250>>>            Find eq MarcajeTable by Index.1   // busca segun el indice
78251>>>>
78251>>>            If [not Found] Begin
78253>>>                Error 200 'Ingrese un Marcaje Valido' // si no se encuentra que retorne el mensaje
78254>>>>
78254>>>                Procedure_Return // retorna el procedimienot para hacer uso del sisema
78255>>>            End
78255>>>>
78255>>>        End
78255>>>>
78255>>>   
78255>>>   
78255>>>        Set Report_Name of (ReporteMarcajesObject(Current_Object)) to "ReporteMarcajes.rpt"
78256>>>        Send Run_Report to (ReporteMarcajesObject(Current_Object))
78257>>>    End_Procedure
78258>>>    
78258>>>   Object ReporteMarcajesObject is a WinQLReport  //Creamos el objeto WinQLReport
78260>>>        Set Output_Destination to WQL_PRINT_TO_WINDOW   // enviar la impresion de pantalla
78261>>>        
78261>>>        Procedure OnInitializeReport
78264>>>             Local String var_Parametros
78264>>>             Local Integer var_MarcajesTable        // declaracion de variable
78264>>>             Local String var_Seleccion
78264>>>            
78264>>>            Forward Send OnInitializeReport  // lanzamos el iniciador del reporte
78266>>>            
78266>>>            Move 0 to var_MarcajesTable  // asignamos un valor vacio
78267>>>            
78267>>>          //  Get Value of (TxtReporteX(Current_Object)) item 0 to var_MarcajesTable  // obtenes el valor de la caja de texto y lo asignamos a la variable
78267>>>            Get Value of TxtReporteX to var_MarcajesTable
78268>>>            Move '' to var_Parametros // asignamos vacio a parametros
78269>>>            
78269>>>            // Validamos que el lo que se le asigno a var_Marcajes no haya sido un dato vacio
78269>>>            If (var_MarcajesTable ne 0) Begin
78271>>>                //Move 0 to var_Seleccion // asignamos vacio
78271>>>                Append var_Seleccion '{MarcajeTable.Codigo} = ' ('"'+var_MarcajesTable+'"')  // adjuntamos la seleccion con el valor asignado
78273>>>                //Append var_Seleccion '{MarcajeTable.Codigo} = ' (var_MarcajesTable)
78273>>>            End
78273>>>>
78273>>>            
78273>>>            Append var_Parametros '"'
78274>>>            Append var_Parametros 'LISTA DE MARCAJES DE TRABAJADORES"'
78275>>>            
78275>>>     
78275>>>            Set SelectionFormula to var_Seleccion
78276>>>            Set Formula "Titulo" to var_Parametros
78277>>>                
78277>>>            
78277>>>        End_Procedure
78278>>>       
78278>>>    
78278>>>   End_Object
78279>>>
78279>>>    Object GrupoFechas is a Group
78281>>>        Set Size to 30 122
78282>>>        Set Location to 108 119
78283>>>        Set Label to "Rango de Fechas"
78284>>>        Set Color to clWhite
78285>>>        Set Bitmap_Style to Bitmap_Tile
78286>>>
78286>>>        Object TxtFechaDe is a Form
78288>>>            Set Size to 13 44
78289>>>            Set Location to 13 12
78290>>>            Set Label to "De"
78291>>>            Set Label_Col_Offset to 10
78292>>>        
78292>>>            // OnChange is called on every changed character
78292>>>        //    Procedure OnChange
78292>>>        //        String sValue
78292>>>        //    
78292>>>        //        Get Value to sValue
78292>>>        //    End_Procedure
78292>>>        
78292>>>        End_Object
78293>>>
78293>>>        Object TxtFechaA is a Form
78295>>>            Set Size to 13 44
78296>>>            Set Location to 13 71
78297>>>            Set Label to "A"
78298>>>            Set Label_Col_Offset to 10
78299>>>        
78299>>>            // OnChange is called on every changed character
78299>>>        //    Procedure OnChange
78299>>>        //        String sValue
78299>>>        //    
78299>>>        //        Get Value to sValue
78299>>>        //    End_Procedure
78299>>>        
78299>>>        End_Object
78300>>>    End_Object
78301>>>
78301>>>    Object oRadioGroup1 is a RadioGroup
78303>>>        Set Location to 46 16
78304>>>        Set Size to 93 101
78305>>>        Set Label to "GENERAR REPORTE POR"
78306>>>        Set Color to clWhite
78307>>>    
78307>>>        Object OpRegistroUnico is a Radio
78309>>>            Set Label to "Codigo de Registro"
78310>>>            Set Size to 10 61
78311>>>            Set Location to 20 13
78312>>>            Set Color to clWhite
78313>>>        End_Object
78314>>>    
78314>>>        Object OpCodigoEmpleado is a Radio
78316>>>            Set Label to "Codigo Empleado"
78317>>>            Set Size to 10 61
78318>>>            Set Location to 35 13
78319>>>            Set Color to clWhite
78320>>>        End_Object
78321>>>    
78321>>>        Object OpNacionalidad is a Radio
78323>>>            Set Label to "Nacionalidad"
78324>>>            Set Size to 10 61
78325>>>            Set Location to 51 13
78326>>>            Set Color to clWhite
78327>>>        End_Object
78328>>>    
78328>>>        Procedure Notify_Select_State Integer iToItem Integer iFromItem
78331>>>            Forward Send Notify_Select_State iToItem iFromItem
78333>>>            // for augmentation
78333>>>        End_Procedure
78334>>>
78334>>>        Object OpFechas is a Radio
78336>>>            Set Label to "Fechas"
78337>>>            Set Size to 10 61
78338>>>            Set Location to 66 13
78339>>>            Set Color to clWhite
78340>>>
78340>>>            Procedure OnChange
78343>>>                Forward Send OnChange
78345>>>                
78345>>>     
78345>>>            End_Procedure
78346>>>
78346>>>            Procedure Mouse_Click Integer iWindowNumber Integer iPosition
78349>>>                Forward Send Mouse_Click iWindowNumber iPosition
78351>>>                If (OpFechas = True) Begin
78353>>>                    Set Visible_State of TxtFechaDe to True
78354>>>                    Set Visible_State of TxtFechaA to True
78355>>>                    Set Visible_State of GrupoFechas to True
78356>>>                    
78356>>>                End 
78356>>>>
78356>>>                
78356>>>                Else Begin
78357>>>                    Set Visible_State of TxtFechaDe to False
78358>>>                    Set Visible_State of TxtFechaA to False
78359>>>                    Set Visible_State of GrupoFechas to False
78360>>>                End
78360>>>>
78360>>>            End_Procedure
78361>>>        End_Object
78362>>>    
78362>>>        // If you set Current_Radio, you must set it AFTER the
78362>>>        // radio objects have been created AND AFTER Notify_Select_State has been
78362>>>        // created. i.e. Set in bottom-code of object at the end!!
78362>>>    //    Set Current_Radio to 0
78362>>>    
78362>>>    End_Object
78363>>>    
78363>>>    
78363>>>    
78363>>>    
78363>>>    
78363>>>    
78363>>>    
78363>>>   
78363>>>
78363>>>End_Object
78364>
78364>        Procedure Activate_About
78367>            Send DoAbout "" "" "" "" ""
78368>        End_Procedure
78369>
78369>    End_Object
78370>
78370>End_Object
78371>
78371>Start_UI
78372>
78372>//************************** end of WindowsProject.tpl for Spanish **************
78372>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 44625
Total Resources: 0
Total Commands : 78371
Total Windows  : 1
Total Pages    : 1
Static Data    : 478525
Message area   : 544922
Total Blocks   : 28159
