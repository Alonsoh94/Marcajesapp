Compiling Program: C:\DataFlex Projects\MARCAJESAPP\AppSrc\JUEVESAPPMARCAJES.src
Memory Available: 2147483646
1>//**************************************************************
1>// WindowsProject.tpl for Spanish translated by Moose Software (www.moose-software.com) 
1>// 28/10/2008 revised for VDF 14.1 by Moose Software  
1>// 13/07/2010 Revised for VDF 16.0 by Moose Software
1>// 05/02/2012 Revised for VDF 17.0 by Moose Software
1>// 13/06/2013 Revised for VDF 17.1 by Moose Software
1>// 02/05/2014 Revised for VDF 18.0 by Moose Software
1>//*************************************************************************************
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 18.2\Pkg\dfallent.pkd)
75339>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardCommandBarSystem.pkg)
75339>>>// these are all the packages used in a standard MDI menubar/toolbar system
75339>>>
75339>>>Use cCJCommandBarSystem.pkg
75339>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardMenuItemClasses.pkg)
75339>>>>>Use Dfpanel.pkg
75339>>>>>Use cCJCommandBarSystem.pkg
75339>>>>>Use LanguageText.pkg
75339>>>>>
75339>>>>>
75339>>>>>Class cCJUndoMenuItem is a cCJMenuItem
75340>>>>>    
75340>>>>>    Procedure Construct_Object
75342>>>>>        Forward Send Construct_Object
75344>>>>>        Set psCaption   to C_$CaptionUndo
75345>>>>>        Set psToolTip to C_$ToolTipUndo
75346>>>>>        Set psDescription to C_$DescUndo
75347>>>>>        Set psImage to "ActionUndo.ico"
75348>>>>>        Set pbActiveUpdate to True
75349>>>>>        Set psCategory to C_$CategoryEdit
75350>>>>>        Set psShortcut to C_$Key_Ctrl_Z
75351>>>>>    End_Procedure
75352>>>>>
75352>>>>>    Procedure OnExecute Variant vCommandBarControl
75354>>>>>        Send Undo of (focus(Self))
75355>>>>>    End_Procedure
75356>>>>>    
75356>>>>>    Function IsEnabled Returns Boolean
75358>>>>>        Boolean bEnabled
75358>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
75359>>>>>        Function_Return bEnabled
75360>>>>>    End_Function
75361>>>>>         
75361>>>>>End_Class
75362>>>>>
75362>>>>>
75362>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
75363>>>>>    
75363>>>>>    Procedure Construct_Object
75365>>>>>        Forward Send Construct_Object
75367>>>>>        Set psCaption   to C_$CaptionDelete
75368>>>>>        Set psToolTip to C_$ToolTipDelete
75369>>>>>        Set psDescription to C_$DescDelete
75370>>>>>        Set psImage to "actionDelete.ico"
75371>>>>>        Set psShortcut to C_$Key_Delete
75372>>>>>        Set pbActiveUpdate to True
75373>>>>>        Set psCategory to C_$CategoryEdit
75374>>>>>    End_Procedure
75375>>>>>
75375>>>>>
75375>>>>>    Procedure OnExecute Variant vCommandBarControl
75377>>>>>        Send Delete of (focus(Self))
75378>>>>>    End_Procedure
75379>>>>>    
75379>>>>>    Function IsEnabled Returns Boolean
75381>>>>>        Boolean bEnabled
75381>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
75382>>>>>        Function_Return bEnabled
75383>>>>>    End_Function
75384>>>>>         
75384>>>>>End_Class
75385>>>>>
75385>>>>>
75385>>>>>Class cCJCutMenuItem is a cCJMenuItem
75386>>>>>    
75386>>>>>    Procedure Construct_Object
75388>>>>>        Forward Send Construct_Object
75390>>>>>        Set psCaption   to C_$CaptionCut
75391>>>>>        Set psToolTip to C_$TooltipCut
75392>>>>>        Set psDescription to C_$DescCut
75393>>>>>        Set psImage to "actionCut.ico"
75394>>>>>        Set psShortcut to C_$Key_Ctrl_X
75395>>>>>        Set pbActiveUpdate to True
75396>>>>>        Set psCategory to C_$CategoryEdit
75397>>>>>    End_Procedure
75398>>>>>
75398>>>>>
75398>>>>>    Procedure OnExecute Variant vCommandBarControl
75400>>>>>        Send Cut of (focus(Self))
75401>>>>>    End_Procedure
75402>>>>>    
75402>>>>>    Function IsEnabled Returns Boolean
75404>>>>>        Boolean bEnabled
75404>>>>>        Get CanCut of (Focus(Self)) to bEnabled
75405>>>>>        Function_Return bEnabled
75406>>>>>    End_Function
75407>>>>>         
75407>>>>>End_Class
75408>>>>>
75408>>>>>
75408>>>>>Class cCJCopyMenuItem is a cCJMenuItem
75409>>>>>    
75409>>>>>    Procedure Construct_Object
75411>>>>>        Forward Send Construct_Object
75413>>>>>        Set psCaption   to C_$CaptionCopy
75414>>>>>        Set psToolTip to C_$ToolTipCopy
75415>>>>>        Set psDescription to C_$DescCopy
75416>>>>>        Set psImage to "actionCopy.ico"
75417>>>>>        Set psShortcut to C_$Key_Ctrl_C
75418>>>>>        Set pbActiveUpdate to True
75419>>>>>        Set psCategory to C_$CategoryEdit
75420>>>>>    End_Procedure
75421>>>>>
75421>>>>>
75421>>>>>    Procedure OnExecute Variant vCommandBarControl
75423>>>>>        Send Copy of (focus(Self))
75424>>>>>    End_Procedure
75425>>>>>    
75425>>>>>    Function IsEnabled Returns Boolean
75427>>>>>        Boolean bEnabled
75427>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
75428>>>>>        Function_Return bEnabled
75429>>>>>    End_Function
75430>>>>>         
75430>>>>>End_Class
75431>>>>>
75431>>>>>
75431>>>>>Class cCJPasteMenuItem is a cCJMenuItem
75432>>>>>    
75432>>>>>    Procedure Construct_Object
75434>>>>>        Forward Send Construct_Object
75436>>>>>        Set psCaption   to C_$CaptionPaste
75437>>>>>        Set psToolTip to C_$ToolTipPaste
75438>>>>>        Set psDescription to C_$DescPaste
75439>>>>>        Set psImage to "actionPaste.ico"
75440>>>>>        Set pbActiveUpdate to True
75441>>>>>        Set psShortcut to C_$Key_Ctrl_V
75442>>>>>        Set psCategory to C_$CategoryEdit
75443>>>>>    End_Procedure
75444>>>>>
75444>>>>>
75444>>>>>    Procedure OnExecute Variant vCommandBarControl
75446>>>>>        Send Paste of (focus(Self))
75447>>>>>    End_Procedure
75448>>>>>    
75448>>>>>    Function IsEnabled Returns Boolean
75450>>>>>        Boolean bEnabled
75450>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
75451>>>>>        Function_Return bEnabled
75452>>>>>    End_Function
75453>>>>>         
75453>>>>>End_Class
75454>>>>>
75454>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
75455>>>>>    
75455>>>>>    Procedure Construct_Object
75457>>>>>        Forward Send Construct_Object
75459>>>>>        Set psCaption   to C_$CaptionSelectAll
75460>>>>>        Set psToolTip to C_$ToolTipSelectAll
75461>>>>>        Set psDescription to C_$DescSelectAll
75462>>>>>        Set pbActiveUpdate to True
75463>>>>>        Set psShortcut to C_$Key_Ctrl_A
75464>>>>>        Set psCategory to C_$CategoryEdit
75465>>>>>    End_Procedure
75466>>>>>
75466>>>>>
75466>>>>>    Procedure OnExecute Variant vCommandBarControl
75468>>>>>        Send Select_All of (focus(Self))
75469>>>>>    End_Procedure
75470>>>>>    
75470>>>>>    Function IsEnabled Returns Boolean
75472>>>>>        Boolean bEnabled
75472>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
75473>>>>>        Function_Return bEnabled
75474>>>>>    End_Function
75475>>>>>         
75475>>>>>End_Class
75476>>>>>
75476>>>>> 
75476>>>>>Class cCJExitMenuItem is a cCJMenuItem
75477>>>>>
75477>>>>>    Procedure Construct_Object
75479>>>>>        Forward Send Construct_Object
75481>>>>>        Set psCaption to C_$CaptionExit
75482>>>>>        Set psToolTip to C_$ToolTipExit
75483>>>>>        Set psDescription to C_$ToolTipExit
75484>>>>>        Set psShortcut to C_$Key_Alt_F4
75485>>>>>        Set psCategory to C_$CategoryFile
75486>>>>>    End_Procedure
75487>>>>>
75487>>>>>    Procedure OnExecute Variant vCommandBarControl
75489>>>>>        Send Exit_Application of Desktop
75490>>>>>    End_Procedure
75491>>>>>
75491>>>>>End_Class           
75492>>>>>
75492>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
75493>>>>>
75493>>>>>    Procedure Construct_Object
75495>>>>>        Forward Send Construct_Object
75497>>>>>        Set psCaption to C_$CaptionHelp
75498>>>>>        Set psDescription to C_$ToolTipHelp
75499>>>>>        Set psToolTip to C_$DescHelp
75500>>>>>        Set psImage to "ActionHelp.ico"
75501>>>>>        Set psShortcut to "F1"
75502>>>>>        Set psCategory to C_$CategoryHelp
75503>>>>>    End_Procedure
75504>>>>>    
75504>>>>>    Procedure OnExecute Variant vCommandBarControl
75506>>>>>        Send Help of (Focus(Self))
75507>>>>>    End_Procedure
75508>>>>>
75508>>>>>End_Class
75509>>>>>
75509>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
75510>>>>>
75510>>>>>    Procedure Construct_Object
75512>>>>>        Forward Send Construct_Object
75514>>>>>        Set psCaption to C_$CaptionAddStatusbar
75515>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
75516>>>>>        Set psDescription to  C_$DescAddStatusbar
75517>>>>>        Set psCategory to C_$CategoryWindow
75518>>>>>    End_Procedure
75519>>>>>
75519>>>>>    Procedure OnExecute Variant vCommandBarControl
75521>>>>>        Handle hoCommandBars hoClientArea
75521>>>>>        Get CommandBarSystemObject to hoCommandBars
75522>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75523>>>>>        If hoClientArea Begin
75525>>>>>            // the clientarea's parent panel has message
75525>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
75526>>>>>        End
75526>>>>>>
75526>>>>>    End_Procedure
75527>>>>>
75527>>>>>     Function IsChecked Returns Boolean
75529>>>>>        Boolean bOn
75529>>>>>        Handle hoCommandBars hoClientArea
75529>>>>>        Get CommandBarSystemObject to hoCommandBars
75530>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75531>>>>>        If hoClientArea Begin
75533>>>>>            // the clientarea's parent panel has message
75533>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
75534>>>>>        End
75534>>>>>>
75534>>>>>        Function_Return bOn
75535>>>>>     End_Function
75536>>>>>End_Class
75537>>>>>
75537>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
75538>>>>>
75538>>>>>    Procedure Construct_Object
75540>>>>>        Forward Send Construct_Object
75542>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
75543>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
75544>>>>>        Set psDescription to C_$DescAutoArrangeIcons
75545>>>>>        Set psCategory to C_$CategoryWindow
75546>>>>>    End_Procedure
75547>>>>>
75547>>>>>    Procedure OnExecute Variant vCommandBarControl
75549>>>>>        Handle hoCommandBars hoClientArea
75549>>>>>        Get CommandBarSystemObject to hoCommandBars
75550>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75551>>>>>        If hoClientArea Begin
75553>>>>>            // the clientarea's parent panel has message
75553>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
75554>>>>>        End
75554>>>>>>
75554>>>>>    End_Procedure
75555>>>>>    
75555>>>>>     Function IsChecked Returns Boolean
75557>>>>>        Boolean bOn
75557>>>>>        Handle hoCommandBars hoClientArea
75557>>>>>        Get CommandBarSystemObject to hoCommandBars
75558>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75559>>>>>        If hoClientArea Begin
75561>>>>>            // the clientarea's parent panel has message
75561>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
75562>>>>>        End
75562>>>>>>
75562>>>>>        Function_Return bOn
75563>>>>>     End_Function
75564>>>>>End_Class
75565>>>>>
75565>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
75566>>>>>
75566>>>>>    Procedure Construct_Object
75568>>>>>        Forward Send Construct_Object
75570>>>>>        Set psCaption to C_$CaptionRestoreMenus
75571>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
75572>>>>>        Set psDescription to C_$DescRestoreMenus
75573>>>>>        Set psCategory to C_$CategoryWindow
75574>>>>>    End_Procedure
75575>>>>>
75575>>>>>    Procedure OnExecute Variant vCommandBarControl
75577>>>>>        Handle hoCommandBars
75577>>>>>        Get CommandBarSystemObject to hoCommandBars
75578>>>>>        Send RestoreLayout of hoCommandBars
75579>>>>>    End_Procedure
75580>>>>>    
75580>>>>>End_Class
75581>>>>>
75581>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
75582>>>>>
75582>>>>>    Procedure Construct_Object
75584>>>>>        Forward Send Construct_Object
75586>>>>>        Set psCaption to C_$CaptionCascade
75587>>>>>        Set psToolTip to C_$ToolTipCascade
75588>>>>>        Set psDescription to  C_$DescCascade
75589>>>>>        Set psImage to "ActionCascade.ico"
75590>>>>>        Set psCategory to C_$CategoryWindow
75591>>>>>    End_Procedure
75592>>>>>    
75592>>>>>    Procedure OnExecute Variant vCommandBarControl
75594>>>>>        Handle hoCommandBars hoClientArea
75594>>>>>        Get CommandBarSystemObject to hoCommandBars
75595>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75596>>>>>        If hoClientArea Begin
75598>>>>>            Send Cascade_Windows of hoClientArea
75599>>>>>        End
75599>>>>>>
75599>>>>>    End_Procedure
75600>>>>>End_Class
75601>>>>>
75601>>>>>Class cCJTileHorizontally is a cCJMenuItem
75602>>>>>
75602>>>>>    Procedure Construct_Object
75604>>>>>        Forward Send Construct_Object
75606>>>>>        Set psCaption to C_$CaptionTileHorizontally 
75607>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
75608>>>>>        Set psDescription to  C_$DescTileHorizontally
75609>>>>>        Set psImage to "ActionTileHorizontally.ico"
75610>>>>>        Set psCategory to C_$CategoryWindow
75611>>>>>    End_Procedure
75612>>>>>
75612>>>>>    Procedure OnExecute Variant vCommandBarControl
75614>>>>>        Handle hoCommandBars hoClientArea
75614>>>>>        Get CommandBarSystemObject to hoCommandBars
75615>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75616>>>>>        If hoClientArea Begin
75618>>>>>            Send Tile_Windows_Horizontal of hoClientArea
75619>>>>>        End
75619>>>>>>
75619>>>>>    End_Procedure
75620>>>>>End_Class
75621>>>>>
75621>>>>>Class cCJTileVertically is a cCJMenuItem
75622>>>>>
75622>>>>>    Procedure Construct_Object
75624>>>>>        Forward Send Construct_Object
75626>>>>>        Set psCaption to C_$CaptionTileVertically  
75627>>>>>        Set psToolTip to C_$ToolTipTileVertically
75628>>>>>        Set psDescription to  C_$DescTileVertically
75629>>>>>        Set psImage to "ActionTileVertically.ico"
75630>>>>>        Set psCategory to C_$CategoryWindow
75631>>>>>    End_Procedure
75632>>>>>
75632>>>>>    Procedure OnExecute Variant vCommandBarControl
75634>>>>>        Handle hoCommandBars hoClientArea
75634>>>>>        Get CommandBarSystemObject to hoCommandBars
75635>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75636>>>>>        If hoClientArea Begin
75638>>>>>            Send Tile_Windows_Vertical of hoClientArea
75639>>>>>        End
75639>>>>>>
75639>>>>>    End_Procedure
75640>>>>>End_Class
75641>>>>>
75641>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
75642>>>>>
75642>>>>>    Procedure Construct_Object
75644>>>>>        Forward Send Construct_Object
75646>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
75647>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
75648>>>>>        Set psDescription to  C_$DescMinimizeWindows
75649>>>>>        Set psCategory to C_$CategoryWindow
75650>>>>>    End_Procedure
75651>>>>>
75651>>>>>    Procedure OnExecute Variant vCommandBarControl
75653>>>>>        Handle hoCommandBars hoClientArea
75653>>>>>        Get CommandBarSystemObject to hoCommandBars
75654>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75655>>>>>        If hoClientArea Begin
75657>>>>>            // the clientarea's parent panel has message
75657>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
75658>>>>>        End
75658>>>>>>
75658>>>>>    End_Procedure
75659>>>>>End_Class
75660>>>>>
75660>>>>>
75660>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
75661>>>>>
75661>>>>>    Procedure Construct_Object
75663>>>>>        Forward Send Construct_Object
75665>>>>>        Set psCaption to C_$CaptionRestoreWindows
75666>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
75667>>>>>        Set psDescription to  C_$DescRestoreWindows
75668>>>>>        Set psCategory to C_$CategoryWindow
75669>>>>>    End_Procedure
75670>>>>>
75670>>>>>    Procedure OnExecute Variant vCommandBarControl
75672>>>>>        Handle hoCommandBars hoClientArea
75672>>>>>        Get CommandBarSystemObject to hoCommandBars
75673>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75674>>>>>        If hoClientArea Begin
75676>>>>>            // the clientarea's parent panel has message
75676>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
75677>>>>>        End
75677>>>>>>
75677>>>>>    End_Procedure
75678>>>>>End_Class
75679>>>>>
75679>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
75680>>>>>
75680>>>>>    Procedure Construct_Object
75682>>>>>        Forward Send Construct_Object
75684>>>>>        Set psCaption to C_$CaptionArrangeIcons  
75685>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
75686>>>>>        Set psDescription to  C_$DescArrangeIcons
75687>>>>>        Set psCategory to C_$CategoryWindow
75688>>>>>    End_Procedure
75689>>>>>
75689>>>>>    Procedure OnExecute Variant vCommandBarControl
75691>>>>>        Handle hoCommandBars hoClientArea
75691>>>>>        Get CommandBarSystemObject to hoCommandBars
75692>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75693>>>>>        If hoClientArea Begin
75695>>>>>            Send Arrange_Icons of hoClientArea
75696>>>>>        End
75696>>>>>>
75696>>>>>    End_Procedure
75697>>>>>
75697>>>>>End_Class
75698>>>>>    
75698>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJAboutMenuItem.pkg)
75698>>>>>Use cCJCommandBarSystem.pkg
75698>>>>>Use LanguageText.pkg
75698>>>>>
75698>>>>>// It is expected that if you use this class that you provide an about object that is
75698>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
75698>>>>>// because you may wish to create your own custom about package.
75698>>>>>
75698>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
75699>>>>>
75699>>>>>    Procedure Construct_Object
75701>>>>>        Forward Send Construct_Object
75703>>>>>        Set psCaption to C_$CaptionAbout
75704>>>>>        Set psDescription to C_$ToolTipAbout
75705>>>>>        Set psToolTip to C_$DescAbout
75706>>>>>        Set psImage to "ActionAbout.ico"
75707>>>>>        Set psCategory to C_$CategoryHelp
75708>>>>>    End_Procedure
75709>>>>>    
75709>>>>>    Procedure OnExecute Variant vCommandBarControl
75711>>>>>        Handle hoCommandBars hoClientArea
75711>>>>>        Get CommandBarSystemObject to hoCommandBars
75712>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75713>>>>>        If hoClientArea Begin
75715>>>>>            Send Activate_About of hoClientArea
75716>>>>>        End
75716>>>>>>
75716>>>>>    End_Procedure
75717>>>>>
75717>>>>>End_Class
75718>>>>>
75718>>>>>
75718>>>Use cCJDeoMenuItemClasses.pkg
75718>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJMDIWindowsMenuItem.pkg)
75718>>>>>Use cCJCommandBarSystem.pkg
75718>>>>>
75718>>>>>Register_Function Client_ID Returns Integer
75718>>>>>
75718>>>>>// only used by cCJMDIWIndowsMenuItem
75718>>>>>Class cCJMDIWindowItem is a cCJMenuItem
75719>>>>>
75719>>>>>    Procedure Construct_Object
75721>>>>>        Forward Send Construct_Object
75723>>>>>        Property Handle phWindow 0 // object id of view
75724>>>>>        Set pbControlFlagNoMovable to True
75725>>>>>        Set pbActiveUpdate to True
75726>>>>>    End_Procedure
75727>>>>>    
75727>>>>>    Procedure OnExecute Variant vCommandBarControl
75729>>>>>        Handle hWindow
75729>>>>>        Get phWindow to hWindow
75730>>>>>        Send Activate_View of hWindow
75731>>>>>    End_Procedure
75732>>>>>    
75732>>>>>End_Class                
75733>>>>>
75733>>>>>
75733>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
75734>>>>>    
75734>>>>>    Procedure Construct_Object
75736>>>>>        Forward Send Construct_Object
75738>>>>>        Property Handle[] phArrayOfWindows
75739>>>>>        Set peControlType to xtpControlPopup
75740>>>>>        Set psCategory to C_$CategoryWindow
75741>>>>>    End_Procedure
75742>>>>>    
75742>>>>>     // This adds MDI windows to the existing menu items.
75742>>>>>     // This removes any existing windows menus and always adds a new set to the end
75742>>>>>
75742>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
75744>>>>>        Handle  hClientArea hView
75744>>>>>        String  sLabel
75744>>>>>        Integer i iWindows
75744>>>>>        Handle[] hArrayOfWindows
75745>>>>>        Variant vItem
75745>>>>>        
75745>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
75745>>>>>        // also assume that destroying an action removes all menu instances of that action
75745>>>>>        Get phArrayOfWindows to hArrayOfWindows
75746>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
75747>>>>>        For i from 0 to (iWindows-1)
75753>>>>>>
75753>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
75754>>>>>        Loop
75755>>>>>>
75755>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
75756>>>>>
75756>>>>>        // Add all views to this menu. Create the action and add the item
75756>>>>>        Move 0 to i
75757>>>>>        Get Client_Id to hClientArea // object id of client area
75758>>>>>        If (hClientArea > 0) Begin
75760>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
75761>>>>>            While (hView <> 0)
75765>>>>>                If (Active_State(hView)) Begin
75767>>>>>                    // create the action
75767>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
75768>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
75769>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
75770>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
75771>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
75773>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
75774>>>>>                    End
75774>>>>>>
75774>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
75775>>>>>                    If (i=0) Begin
75777>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
75778>>>>>                    End
75778>>>>>>
75778>>>>>                    // Create a menu item for this action
75778>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
75779>>>>>                    Increment i
75780>>>>>                End
75780>>>>>>
75780>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
75781>>>>>            Loop
75782>>>>>>
75782>>>>>        End
75782>>>>>>
75782>>>>>
75782>>>>>        Set phArrayOfWindows to hArrayOfWindows
75783>>>>>
75783>>>>>     End_Procedure
75784>>>>>     
75784>>>>>End_Class
75785>>>>>
75785>
75785>Object oHtmlHelp is a cHtmlHelp
75787>End_Object
75788>
75788>Object oApplication is a cApplication
75790>    Set peHelpType to htHtmlHelp
75791>End_Object
75792>
75792>Object oToolTipController is a cToolTipController
75794>    Move Self to ghoToolTipController
75795>End_Object
75796>
75796>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oEditContextMenu.pkg)
75796>>>Use cCJStandardMenuItemClasses.pkg
75796>>>
75796>>>Object oEditContextMenu is a cCJContextMenu
75798>>>    
75798>>>    Move Self to Default_Form_Floating_Menu_ID
75799>>>    
75799>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75801>>>    End_Object
75802>>>    
75802>>>    Object oCutMenuItem is a cCJCutMenuItem
75804>>>        Set pbControlBeginGroup to True
75805>>>    End_Object
75806>>>    
75806>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75808>>>    End_Object
75809>>>
75809>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75811>>>    End_Object
75812>>>
75812>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75814>>>    End_Object
75815>>>
75815>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75817>>>        Set pbControlBeginGroup to True
75818>>>    End_Object
75819>>>
75819>>>End_Object
75820>>>
75820>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oDEOEditContextMenu17.pkg)
75820>>>Use Windows.pkg
75820>>>Use cCJStandardMenuItemClasses.pkg
75820>>>Use cCJDeoMenuItemClasses.pkg
75820>>>
75820>>>
75820>>>Object oDEOEditContextMenu17 is a cCJContextMenu
75822>>>    
75822>>>    Move Self to Default_dbFloating_Menu_ID
75823>>>    
75823>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75825>>>    End_Object
75826>>>    
75826>>>    Object oCutMenuItem is a cCJCutMenuItem
75828>>>        Set pbControlBeginGroup to True
75829>>>    End_Object
75830>>>    
75830>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75832>>>    End_Object
75833>>>
75833>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75835>>>    End_Object
75836>>>
75836>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75838>>>    End_Object
75839>>>
75839>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75841>>>        Set pbControlBeginGroup to True
75842>>>    End_Object
75843>>>
75843>>>    Object oPromptMenuItem is a cCJPromptMenuItem
75845>>>        Set pbControlBeginGroup to True
75846>>>    End_Object
75847>>>
75847>>>    Object oFindNextMenu is a cCJFindNextMenuItem
75849>>>        Set pbControlBeginGroup to True
75850>>>    End_Object
75851>>>
75851>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75853>>>    End_Object
75854>>>
75854>>>    Object oClearMenuItem is a cCJClearMenuItem
75856>>>        Set pbControlBeginGroup to True
75857>>>    End_Object
75858>>>
75858>>>    Object oClearAllMenu is a cCJClearAllMenuItem
75860>>>    End_Object
75861>>>
75861>>>    Object oSaveMenu is a cCJSaveMenuItem
75863>>>    End_Object
75864>>>    
75864>>>    Object oDeleteMenu is a cCJDeleteMenuItem
75866>>>    End_Object
75867>>>
75867>>>    Object oRememberitem is a cCJRememberFieldMenuItem
75869>>>        Set pbControlBeginGroup to True
75870>>>    End_Object
75871>>>
75871>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
75873>>>    End_Object
75874>>>
75874>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
75876>>>    End_Object
75877>>>
75877>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
75879>>>    End_Object
75880>>>
75880>>>End_Object
75881>
75881>Object oMain is a Panel
75883>    Set Label to "Mi Proyecto"
75884>    Set Location to 4 3
75885>    Set Size to 300 589
75886>
75886>    Object oCommandBarSystem is a cCJCommandBarSystem
75888>        Set pbTimerUpdate to True
75889>
75889>        Procedure OnCreateCommandBars
75892>            Handle hoOptions
75892>            Get OptionsObject to hoOptions
75893>            Forward Send OnCreateCommandBars
75895>        End_Procedure
75896>
75896>        Object oMenuBar is a cCJMenuBar
75898>
75898>            Object oFileMenu is a cCJMenuItem
75900>                Set peControlType to xtpControlPopup          
75901>                Set psCaption   to "Archivo"    // &F   <--------------------------
75902>                Set psDescription to "Buscar, Grabar, Borrar, limpiar informaci¢n o salir de esta aplicaci¢n."
75903>                Set psCategory to "Men£s"
75904>
75904>                Object oClearMenuItem is a cCJClearMenuItem
75906>                    Set pbAddToDesignerMenu to True
75907>                End_Object
75908>
75908>                Object oClearAllMenu is a cCJClearAllMenuItem
75910>                    Set pbAddToDesignerMenu to True
75911>                End_Object
75912>
75912>                Object oPromptMenuItem is a cCJPromptMenuItem
75914>                    Set pbAddToDesignerMenu to True
75915>                    Set pbControlBeginGroup to True
75916>                End_Object
75917>
75917>                Object oFindMenuItem is a cCJFindMenuItem
75919>                    Set pbAddToDesignerMenu to True
75920>                    Set pbControlBeginGroup to True
75921>                End_Object
75922>
75922>                Object oFindNextMenu is a cCJFindNextMenuItem
75924>                    Set pbAddToDesignerMenu to True
75925>                End_Object
75926>
75926>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75928>                    Set pbAddToDesignerMenu to True
75929>                End_Object
75930>
75930>                Object oFindFirstMenu is a cCJFindFirstMenuItem
75932>                    Set pbAddToDesignerMenu to True
75933>                End_Object
75934>
75934>                Object oFindLastMenu is a cCJFindLastMenuItem
75936>                    Set pbAddToDesignerMenu to True
75937>                End_Object
75938>
75938>                Object oSaveMenuItem is a cCJSaveMenuItem
75940>                    Set pbAddToDesignerMenu to True
75941>                    Set pbControlBeginGroup to True
75942>                End_Object
75943>
75943>                Object oDeleteMenuItem is a cCJDeleteMenuItem
75945>                    Set pbAddToDesignerMenu to True
75946>                End_Object
75947>
75947>                Object oExitMenu is a cCJExitMenuItem
75949>                    Set pbControlBeginGroup to True
75950>                End_Object
75951>
75951>            End_Object
75952>
75952>            Object oViewMenu is a cCJMenuItem
75954>                Set peControlType to xtpControlPopup
75955>                Set psCaption to "&Vistas"
75956>                Set psToolTip to "Vistas"
75957>               Set psDescription to "Vistas disponibles"
75958>
75958>               Object oEMPLEADOSMenuItem is a cCJMenuItem
75960>                   Set psCaption to "EMPLEADOS"
75961>                   Set psTooltip to "EMPLEADOS"
75962>               
75962>                   Procedure OnExecute Variant vCommandBarControl
75965>                       Handle hoClient
75965>                       Get Client_Id to hoClient
75966>                       Send Activate_EMPLEADOS of hoClient
75967>                   End_Procedure
75968>               End_Object
75969>
75969>               Object oMARCAJESMenuItem is a cCJMenuItem
75971>                   Set psCaption to "MARCAJES"
75972>                   Set psTooltip to "MARCAJES"
75973>               
75973>                   Procedure OnExecute Variant vCommandBarControl
75976>                       Handle hoClient
75976>                       Get Client_Id to hoClient
75977>                       Send Activate_MARCAJES of hoClient
75978>                   End_Procedure
75979>               End_Object
75980>            End_Object
75981>            
75981>            Object oReportMenu is a cCJMenuItem
75983>                Set peControlType to xtpControlPopup
75984>                Set psCaption to "&Informes"
75985>                Set psToolTip to "Informes"
75986>                Set psDescription to "Informes disponibles"
75987>            End_Object
75988>
75988>            Object oNavigateMenu is a cCJMenuItem
75990>                Set peControlType to xtpControlPopup      
75991>                Set psCaption to "&Navegar"    
75992>                Set psTooltip to "Navegar"    
75993>                Set psDescription to "Desplazarse a diferentes areas de la aplicaci¢n"
75994>
75994>                Object oNextAreaMenu is a cCJNextAreaMenu
75996>                End_Object
75997>
75997>                Object oPriorAreaMenu is a cCJPriorAreaMenu
75999>                End_Object
76000>
76000>                Object oNextViewMenu is a cCJNextViewMenu
76002>                End_Object
76003>
76003>                Object oPriorViewMenu is a cCJPriorViewMenu
76005>                End_Object
76006>
76006>                Object oPromptMenu is a cCJPromptMenuItem
76008>                    Set pbControlBeginGroup to True
76009>                End_Object
76010>
76010>                Object oZoomMenu is a cCJZoomMenuItem
76012>                End_Object
76013>
76013>            End_Object
76014>
76014>            Object oWindowMenu is a cCJMDIWindowsMenuItem
76016>                Set peControlType to xtpControlPopup
76017>                Set psCaption to "Ventana"      // &W <---------------
76018>                Set psToolTip to "Ventana"
76019>                Set psDescription to "Muestre vistas actuales y fije otras opciones de visualizaci¢n."
76020>
76020>                // These are the static windows items. More will be created in onInitPopup 
76020>                Object oDisplayOptionsMenu is a cCJMenuItem
76022>                    Set peControlType to xtpControlPopup          
76023>                    Set psCaption to "Opciones de visualizaci¢n"  // &D <--------------
76024>                    Set psToolTip to "Opciones de visualizaci¢n"
76025>                    Set psDescription to "Fije opciones de visualizaci¢n"
76026>
76026>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
76028>                    End_Object
76029>
76029>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
76031>                    End_Object
76032>
76032>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
76034>                        Set pbControlBeginGroup to True
76035>                    End_Object
76036>
76036>                End_Object
76037>
76037>                Object oCascadeMenu is a cCJCascadeMenuItem
76039>                    Set pbControlBeginGroup to True
76040>                End_Object
76041>
76041>                Object oHorizTile is a cCJTileHorizontally
76043>                End_Object
76044>
76044>                Object oVertTile is a cCJTileVertically
76046>                End_Object
76047>
76047>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
76049>                    Set pbControlBeginGroup to True
76050>                End_Object
76051>
76051>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
76053>                End_Object
76054>
76054>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
76056>                    Set pbControlBeginGroup to True
76057>                End_Object
76058>
76058>            End_Object
76059>
76059>            Object oHelpMenu is a cCJMenuItem
76061>                Set peControlType to xtpControlPopup    
76062>                Set psCaption to "&Ayuda"   // &H    <----------------------
76063>                Set psDescription to "Informaci¢n para aprender y para usar esta aplicaci¢n VDF"
76064>                Set psToolTip to "Ayuda"
76065>
76065>                Object oHelpMenuItem is a cCJHelpMenuItem 
76067>                End_Object
76068>
76068>                Object oAboutMenuItem is a cCJAboutMenuItem
76070>                End_Object
76071>
76071>            End_Object
76072>
76072>        End_Object
76073>
76073>        Object oFindToolBar is a cCJToolbar
76075>            Set psTitle to "Barra de herramientas de b£squeda"
76076>
76076>            Object oFindFirstTool is a cCJFindFirstMenuItem
76078>            End_Object
76079>
76079>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
76081>            End_Object
76082>
76082>            Object oFindMenuTool is a cCJFindMenuItem
76084>            End_Object
76085>
76085>            Object oFindNextTool is a cCJFindNextMenuItem
76087>            End_Object
76088>
76088>            Object oFindLastTool is a cCJFindLastMenuItem
76090>            End_Object
76091>
76091>            Object oPromptToolItem is a cCJPromptMenuItem
76093>                Set pbControlBeginGroup to True
76094>            End_Object
76095>
76095>        End_Object
76096>
76096>        Object oFileToolBar is a cCJToolbar
76098>            Set psTitle to "Barra de herramientas de introducci¢n de datos"
76099>
76099>            Object oClearToolItem is a cCJClearMenuItem
76101>                Set peControlStyle to xtpButtonIconAndCaption
76102>            End_Object
76103>
76103>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
76105>                Set peControlStyle to xtpButtonIconAndCaption
76106>            End_Object
76107>
76107>            Object oSaveToolItem is a cCJSaveMenuItem
76109>                Set peControlStyle to xtpButtonIconAndCaption
76110>                Set pbControlBeginGroup to True
76111>            End_Object
76112>
76112>            Object oDeleteToolItem is a cCJDeleteMenuItem
76114>                Set peControlStyle to xtpButtonIconAndCaption
76115>            End_Object
76116>
76116>        End_Object
76117>
76117>        Object oEditToolBar is a cCJToolbar
76119>            Set psTitle to "Barra de herramientas de edici¢n"
76120>
76120>            Object oCutToolbarItem is a cCJCutMenuItem
76122>            End_Object
76123>
76123>            Object oCopyToolbarItem is a cCJCopyMenuItem
76125>            End_Object
76126>
76126>            Object oPasteToolbarItem is a cCJPasteMenuItem
76128>            End_Object
76129>
76129>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
76131>                Set pbControlBeginGroup to True
76132>            End_Object
76133>
76133>        End_Object
76134>
76134>        Object oRememberToolbar is a cCJToolbar
76136>            Set psTitle to C_$Remember
76137>
76137>            Object oRememberItems is a cCJMenuItem
76139>
76139>                Set peControlType to xtpControlPopup
76140>                Set peControlStyle to xtpButtonCaption
76141>                Set psCaption to C_$Remember
76142>                
76142>                Object oMenuItem is a cCJRememberFieldMenuItem
76144>                    Set peControlStyle to xtpButtonIconAndCaption
76145>                End_Object
76146>                
76146>                Object oMenuItem is a cCJRememberLastFieldMenuItem
76148>                    Set peControlStyle to xtpButtonIconAndCaption
76149>                End_Object
76150>                
76150>                Object oMenuItem is a cCJUnRememberFieldMenuItem
76152>                    Set peControlStyle to xtpButtonIconAndCaption
76153>                End_Object
76154>                
76154>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
76156>                    Set peControlStyle to xtpButtonIconAndCaption
76157>                End_Object
76158>
76158>            End_Object
76159>            
76159>        End_Object
76160>        
76160>        Object oStatusBar is a cCJStatusBar
76162>
76162>            Object oStatusPane1 is a cCJStatusBarPane
76164>                Set piID to sbpIDIdlePane
76165>                Set pbStyleStretch to True
76166>            End_Object
76167>
76167>            Object oStatusPane2 is a cCJStatusBarPane
76169>                Set phoViewPane to Self
76170>                Set pbStyleStretch to True
76171>            End_Object
76172>
76172>        End_Object
76173>
76173>    End_Object
76174>
76174>    Object oClientArea is a ClientArea
76176>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\StdAbout.pkg)
76176>>>//************************************************************************
76176>>>// Confidential Trade Secret.
76176>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76176>>>// as an unpublished work.  All rights reserved.
76176>>>// DataFlex is a registered trademark of Data Access Corporation.
76176>>>//
76176>>>//************************************************************************
76176>>>//************************************************************************
76176>>>//
76176>>>// $File name  : StdAbout.pkg
76176>>>// $File title : Standard about object package for VDF
76176>>>// Notice      :
76176>>>// $Author(s)  : John Tuohy
76176>>>//
76176>>>// $Rev History
76176>>>//
76176>>>// JT 06/27/97   File created
76176>>>//************************************************************************
76176>>>
76176>>>// This provides a quick and simple way to create an about package for a program.
76176>>>// You need to create a message inside you client area called Activate_About.
76176>>>// Within this message you should send the message DoAbout passing needed
76176>>>// string information.
76176>>>//
76176>>>//       Procedure Activate_About
76176>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
76176>>>//       End_Procedure
76176>>>//    where: sTitle =     Name of application. If none provided, uses caption
76176>>>//                        bar title
76176>>>//           sVersion   = Version Line. If none provided, will be blank
76176>>>//           sCopyRight = Copyright Line. If none provided, will be blank
76176>>>//           sAuthor    = Author name, blank if none provided
76176>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
76176>>>//                        is used.
76176>>>// It is expected that you will place this in your own object package. For
76176>>>// example an order about package may look like this:
76176>>>//
76176>>>//   // OrderAbout.pkg
76176>>>//   Use StdAbout.pkg
76176>>>//   Procedure Activate_About
76176>>>//      String sTitle sCopyright sVersion sAuthor
76176>>>//      Move "My Order Entry System" to sTitle
76176>>>//      Move "Version 2.1" to sVersion
76176>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
76176>>>//      Move "John Smith"  to sAuthor
76176>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
76176>>>//   end_procedure
76176>>>//   // end of file.
76176>>>
76176>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\Dfabout.pkg)
76176>>>>>//************************************************************************
76176>>>>>// Confidential Trade Secret.
76176>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76176>>>>>// as an unpublished work.  All rights reserved.
76176>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
76176>>>>>//
76176>>>>>//************************************************************************
76176>>>>>//************************************************************************
76176>>>>>//
76176>>>>>// $File name  : DfAbout.pkg
76176>>>>>// $File title : About class support
76176>>>>>// Notice      :
76176>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
76176>>>>>//
76176>>>>>// $Rev History
76176>>>>>//
76176>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
76176>>>>>//                Windows for the size first. 
76176>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
76176>>>>>//                with anchor technique. Removed unnessary property in the
76176>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
76176>>>>>//                object To better look in Windows XP. Repositioned the close
76176>>>>>//                button in the sysinfo dialog To line up with the display area
76176>>>>>//                Replaced obsolete code and techniques. Removed dead code.
76176>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
76176>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
76176>>>>>//                the global Workspace object, if it is present
76176>>>>>// JJT 11/05/98   Added version information
76176>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
76176>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
76176>>>>>//                workspace package.
76176>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
76176>>>>>//                class can create this object.
76176>>>>>//                Cleaned up the interface (used correct classes and messages)
76176>>>>>//                Added workspace reporting support To sys-info.
76176>>>>>//                Turned off wrapping in the sys-info editor.
76176>>>>>// KR  ??/??/96   File created
76176>>>>>//************************************************************************
76176>>>>>Use LanguageText.pkg
76176>>>>>Use Windows.pkg
76176>>>>>Use DFbitmap.pkg
76176>>>>>Use GlobalFunctionsProcedures.pkg
76176>>>>>Use cTextEdit.pkg
76176>>>>>
76176>>>>>Use cli.pkg
Including file: cli.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cli.pkg)
76176>>>>>>>//*****************************************************************************
76176>>>>>>>//*** CLI.PKG                                                               ***
76176>>>>>>>//***                                                                       ***
76176>>>>>>>//*** Author: Ben Weijers                                                   ***
76176>>>>>>>//***         Data Access Nederland                                         ***
76176>>>>>>>//***         10 September 1998                                             ***
76176>>>>>>>//***                                                                       ***
76176>>>>>>>//*** Purpose:                                                              ***
76176>>>>>>>//***   CLI specific functionality. There are several connectivity kits     ***
76176>>>>>>>//***   based on  SQL/92 CLI. Those are:                                    ***
76176>>>>>>>//***    - ODBC_DRV  The Data Access CK for ODBC                            ***
76176>>>>>>>//***    - DB2_DRV   The Data Access CK for DB2                             ***
76176>>>>>>>//***    - MSSQLDRV  The Data Access CK for Microsoft SQL Server            ***
76176>>>>>>>//***                                                                       ***
76176>>>>>>>//***   This package defines the common functionality for all CLI based     ***
76176>>>>>>>//***   drivers.                                                            ***
76176>>>>>>>//***                                                                       ***
76176>>>>>>>//***   Updated:  May 23rd 2008 (Current CK build: 5.0.0.53 )               ***
76176>>>>>>>//***             Added NULLABLE and DEFAULT attributes for DATETIME type   ***
76176>>>>>>>//***   Updated:  Apr  6th 2009 (Current CK build: 5.0.0.61 )               ***
76176>>>>>>>//***             Added DF_DRIVER_MATCH_CLIENT_SERVER_VERSION attribute     ***
76176>>>>>>>//***                   DF_DRIVER_SQLSERVER_CLIENT_VERSION    attribute     ***
76176>>>>>>>//***   Updated:  Mar 30th 2012 (Current CK build: 5.1.0.93 )               ***
76176>>>>>>>//***             Added SQLSERVER2012CLIENT return value for                ***
76176>>>>>>>//***             DF_DRIVER_SQLSERVER_CLIENT_VERSION attribute              ***
76176>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
76176>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
76176>>>>>>>//***             mssqldrv.pkg                                              ***
76176>>>>>>>//***   Updated:  april 23, 2013 (Current CK build: 6.0.0.4)                ***
76176>>>>>>>//***             Added type mappings attributes                            ***
76176>>>>>>>//***   Updated:  october 11, 2013 (Current CK build: 6.0.0.18)             ***
76176>>>>>>>//***             Added DF_FILE_SQL_FILTER_EQ attribute                     ***
76176>>>>>>>//*****************************************************************************
76176>>>>>>>
76176>>>>>>>//*** We are not using ifndef below because that is not supported in Character Mode
76176>>>>>>>//*** Driver attributes
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//------------------------------------------------------------
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//-------------------------------------
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*** Replacement for logical column number that indicates all columns
76176>>>>>>>
76176>>>>>>>//*** Possible DF_FILE_GENERATE_RECORD_ID_METHOD values
76176>>>>>>>
76176>>>>>>>//*** Possible DF_FIELD_READ_ONLY values
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*** Possible DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA values
76176>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK5        1       
76176>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK6        2   
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>// Moved to Mssqldrv.pkg
76176>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
76176>>>>>>>//#REPLACE SQLSERVERUNKNOWNCLIENT  0
76176>>>>>>>//#REPLACE SQLSERVER2000CLIENT     8          //   "SQL Server"
76176>>>>>>>//#REPLACE SQLSERVER2005CLIENT     9          //   "SQL Native Client"
76176>>>>>>>//#REPLACE SQLSERVER2008CLIENT    10          //   "SQL Server Native Client 10.0"
76176>>>>>>>//#Replace SQLSERVER2012CLIENT    11          //   "SQL Server Native Client 11.0"
76176>>>>>>>
76176>>>>>>>//*** Possible SQL Column type values
76176>>>>>>>Define SQL_UNKNOWN_TYPE   For    0
76176>>>>>>>Define SQL_CHAR           For    1
76176>>>>>>>Define SQL_NUMERIC        For    2
76176>>>>>>>Define SQL_DECIMAL        For    3
76176>>>>>>>Define SQL_INTEGER        For    4
76176>>>>>>>Define SQL_SMALLINT       For    5
76176>>>>>>>Define SQL_FLOAT          For    6
76176>>>>>>>Define SQL_REAL           For    7
76176>>>>>>>Define SQL_DOUBLE         For    8
76176>>>>>>>Define SQL_DATETIME       For    9
76176>>>>>>>Define SQL_VARCHAR        For   12
76176>>>>>>>Define SQL_TYPE_DATE      For   91
76176>>>>>>>Define SQL_TYPE_TIME      For   92
76176>>>>>>>Define SQL_TYPE_TIMESTAMP for   93
76176>>>>>>>// Moved to mssqldrv.pkg
76176>>>>>>>//Define SQL_TYPE_TIMESTAMP2 for   (-200) //SQL server datetime2 type */
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>Define SQL_DATE           For    9
76176>>>>>>>Define SQL_INTERVAL       For   10
76176>>>>>>>Define SQL_TIME           For   10
76176>>>>>>>Define SQL_TIMESTAMP      For   11
76176>>>>>>>Define SQL_LONGVARCHAR    For  (-1)
76176>>>>>>>Define SQL_BINARY         For  (-2)
76176>>>>>>>Define SQL_VARBINARY      For  (-3)
76176>>>>>>>Define SQL_LONGVARBINARY  For  (-4)
76176>>>>>>>Define SQL_BIGINT         For  (-5)
76176>>>>>>>Define SQL_TINYINT        For  (-6)
76176>>>>>>>Define SQL_BIT            For  (-7)
76176>>>>>>>Define SQL_WCHAR          For  (-8)
76176>>>>>>>Define SQL_WVARCHAR       For  (-9)
76176>>>>>>>Define SQL_WLONGVARCHAR   For (-10)
76176>>>>>>>Define SQL_GUID           For (-11)
76176>>>>>>>
76176>>>>>>>//*** Driver level attributes
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*** Error number constants
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*** Call driver function identifiers
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*** Init data source types
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*** Dummy strings used in the commands
76176>>>>>>>    String  CLI$StrDummy 255
76176>>>>>>>    Integer CLI$IntDummy
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*****************************************************************************
76176>>>>>>>//*** CLI_SetConstraint <FileNum> <NewState>                                ***
76176>>>>>>>//***                                                                       ***
76176>>>>>>>//***   Setup a constraint for a file.                                      ***
76176>>>>>>>//*****************************************************************************
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*****************************************************************************
76176>>>>>>>//*** CLI_Set_Driver_Atrtribute / CLI_Get_Driver_Attribute                  ***
76176>>>>>>>//***                                                                       ***
76176>>>>>>>//*** Set or get an attribute at driver level. These attributes, when set,  ***
76176>>>>>>>//*** will be set for the remainder of the session or until set again. To   ***
76176>>>>>>>//*** permanently set driver level attributes change the driver             ***
76176>>>>>>>//*** configuration file.                                                   ***
76176>>>>>>>//*****************************************************************************
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*****************************************************************************
76176>>>>>>>//*** Class  : cCLIHandler                                                  ***
76176>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76176>>>>>>>//***          call several CLI releated methods.                           ***
76176>>>>>>>//*****************************************************************************
76176>>>>>>>
76176>>>>>>>Class cCLIHandler Is An Array
76177>>>>>>>
76177>>>>>>>    Procedure Construct_Object Integer iImage
76179>>>>>>>        Forward Send Construct_object iImage
76181>>>>>>>
76181>>>>>>>        Property String  psDriverID       Public ""
76182>>>>>>>    End_Procedure // Construct_Object
76183>>>>>>>
76183>>>>>>>
76183>>>>>>>
76183>>>>>>>    //***
76183>>>>>>>    //*** Fucntion: CKRevsion
76183>>>>>>>    //*** Purpose : The revsion of a CLI Connectivity Kit
76183>>>>>>>    //***
76183>>>>>>>
76183>>>>>>>    Function CKRevision Returns String
76185>>>>>>>        Local String  sDriverID
76185>>>>>>>        Local String  sRevision
76185>>>>>>>        Local String  sVoid
76185>>>>>>>        Local Integer iRetval
76185>>>>>>>
76185>>>>>>>        Get psDriverID To sDriverID
76186>>>>>>>        If (sDRiverID <> "") Begin
76188>>>>>>>            Move (Repeat(" ", 255)) To sRevision
76189>>>>>>>            Call_Driver 0 sDRiverID Function CLI_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76194>>>>>>>        End
76194>>>>>>>>
76194>>>>>>>
76194>>>>>>>        Function_Return sRevision
76195>>>>>>>    End_Function // CKRevision
76196>>>>>>>
76196>>>>>>>
76196>>>>>>>
76196>>>>>>>    //***
76196>>>>>>>    //*** Function: ExtractPartFromRevision
76196>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76196>>>>>>>    //***
76196>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76196>>>>>>>    //***
76196>>>>>>>
76196>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76198>>>>>>>        Local Integer iPartRev
76198>>>>>>>        Local Integer iCurrentPart
76198>>>>>>>        Local Integer iSeparatorPos
76198>>>>>>>
76198>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76201>>>>>>>
76201>>>>>>>        Move 0 To iCurrentPart
76202>>>>>>>        Repeat
76202>>>>>>>>
76202>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76203>>>>>>>            If (iSeparatorPos > 0) Begin
76205>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76206>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76207>>>>>>>                Increment iCurrentPart
76208>>>>>>>            End
76208>>>>>>>>
76208>>>>>>>            Else If (sRevision <> "") Begin
76211>>>>>>>                Move sRevision To iPartRev
76212>>>>>>>                Move "" To sRevision
76213>>>>>>>                Increment iCurrentPart
76214>>>>>>>            End
76214>>>>>>>>
76214>>>>>>>            Else ;                Move -1 To iPartRev
76216>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76218>>>>>>>
76218>>>>>>>        Function_Return iPartRev
76219>>>>>>>    End_Function // EcxtractPartFromRevision
76220>>>>>>>
76220>>>>>>>
76220>>>>>>>
76220>>>>>>>    //***
76220>>>>>>>    //*** Function: CKMajorRevision
76220>>>>>>>    //*** Purpose : Returns the major revision of the CK
76220>>>>>>>    //***
76220>>>>>>>
76220>>>>>>>    Function CKMajorRevision Returns Integer
76222>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76223>>>>>>>    End_Function // CKMajorRevision
76224>>>>>>>
76224>>>>>>>
76224>>>>>>>
76224>>>>>>>    //***
76224>>>>>>>    //*** Function: CKMinorRevision
76224>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76224>>>>>>>    //***
76224>>>>>>>
76224>>>>>>>    Function CKMinorRevision Returns Integer
76226>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76227>>>>>>>    End_Function // CKMinorRevision
76228>>>>>>>
76228>>>>>>>
76228>>>>>>>
76228>>>>>>>    //***
76228>>>>>>>    //*** Function: CKReleaseRevision
76228>>>>>>>    //*** Purpose : Returns the release revision of the CK
76228>>>>>>>    //***
76228>>>>>>>
76228>>>>>>>    Function CKReleaseRevision Returns Integer
76230>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76231>>>>>>>    End_Function // CKReleaseRevision
76232>>>>>>>
76232>>>>>>>
76232>>>>>>>
76232>>>>>>>    //***
76232>>>>>>>    //*** Function: CKBuildRevision
76232>>>>>>>    //*** Purpose : Returns the major revision of the CK
76232>>>>>>>    //***
76232>>>>>>>
76232>>>>>>>    Function CKBuildRevision Returns Integer
76234>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76235>>>>>>>    End_Function // CKBuildRevision
76236>>>>>>>
76236>>>>>>>
76236>>>>>>>
76236>>>>>>>    //***
76236>>>>>>>    //*** Function: IsMinimalRevision
76236>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76236>>>>>>>    //***
76236>>>>>>>
76236>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76238>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76241>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76244>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76247>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76250>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76253>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76257>>>>>>>            End
76257>>>>>>>>
76257>>>>>>>        End
76257>>>>>>>>
76257>>>>>>>
76257>>>>>>>        Function_Return (FALSE)
76258>>>>>>>    End_Function // IsMinimalRevision
76259>>>>>>>
76259>>>>>>>
76259>>>>>>>
76259>>>>>>>    //***
76259>>>>>>>    //*** Function: RegistrationName
76259>>>>>>>    //*** Purpose : Returns the Connectiivty Kit registration name.
76259>>>>>>>    //***
76259>>>>>>>
76259>>>>>>>    Function RegistrationName Returns String
76261>>>>>>>        Local String  sRegistration
76261>>>>>>>        Local String  sDRiverId
76261>>>>>>>        Local String  sVoid
76261>>>>>>>        Local Integer iRetval
76261>>>>>>>
76261>>>>>>>        Get psDriverID To sDriverID
76262>>>>>>>        If (sDRiverID <> "") Begin
76264>>>>>>>            Move (Repeat(" ", 255)) To sRegistration
76265>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETREGNAME Callback 0 Passing sRegistration sVoid 0 Result iRetval
76270>>>>>>>        End
76270>>>>>>>>
76270>>>>>>>
76270>>>>>>>        Function_Return sRegistration
76271>>>>>>>    End_Function // RegistrationName
76272>>>>>>>
76272>>>>>>>
76272>>>>>>>
76272>>>>>>>    //***
76272>>>>>>>    //*** Function: SerialNumber
76272>>>>>>>    //*** Purpose : Returns the Connectiivty Kit serial number.
76272>>>>>>>    //***
76272>>>>>>>
76272>>>>>>>    Function SerialNumber Returns Integer
76274>>>>>>>        Local String  sDRiverId
76274>>>>>>>        Local String  sVoid
76274>>>>>>>        Local Integer iRetval
76274>>>>>>>
76274>>>>>>>        Get psDriverID To sDriverID
76275>>>>>>>        If (sDRiverID <> "") Begin
76277>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETSERIALNUM Callback 0 Passing sVoid sVoid 0 Result iRetval
76282>>>>>>>        End
76282>>>>>>>>
76282>>>>>>>
76282>>>>>>>        Function_Return iRetval
76283>>>>>>>    End_Function // SerialNumber
76284>>>>>>>
76284>>>>>>>
76284>>>>>>>
76284>>>>>>>    //***
76284>>>>>>>    //*** Function: MaxUsers
76284>>>>>>>    //*** Purpose : Returns the Connectiivty Kit maximum number of users.
76284>>>>>>>    //***
76284>>>>>>>
76284>>>>>>>    Function MaxUsers Returns Integer
76286>>>>>>>        Local String  sDRiverId
76286>>>>>>>        Local String  sVoid
76286>>>>>>>        Local Integer iRetval
76286>>>>>>>
76286>>>>>>>        Get psDriverID To sDriverID
76287>>>>>>>        If (sDRiverID <> "") Begin
76289>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETMAXUSERS Callback 0 Passing sVoid sVoid 0 Result iRetval
76294>>>>>>>        End
76294>>>>>>>>
76294>>>>>>>
76294>>>>>>>        Function_Return iRetval
76295>>>>>>>    End_Function // MaxUsers
76296>>>>>>>
76296>>>>>>>
76296>>>>>>>
76296>>>>>>>    //***
76296>>>>>>>    //*** Procedure: DumpStatus
76296>>>>>>>    //*** Purpose  : Dump the current status of the drver in the passed disk file.
76296>>>>>>>    //***
76296>>>>>>>
76296>>>>>>>    Procedure DumpStatus String sFileName
76298>>>>>>>        Local String  sVoid
76298>>>>>>>        Local String  sDriverID
76298>>>>>>>        Local Integer iVoid
76298>>>>>>>
76298>>>>>>>        Get psDriverID To sDriverID
76299>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_DUMPSTATUS Callback 0 Passing sFileName sVoid iVoid Result iVoid
76306>>>>>>>    End_Procedure // DumpStatus
76307>>>>>>>
76307>>>>>>>
76307>>>>>>>
76307>>>>>>>    //***
76307>>>>>>>    //*** Procedure: ReadConfiguration
76307>>>>>>>    //*** Purpose  : Reset all driver level configurable attributes to the
76307>>>>>>>    //***            default value and then reread the configuration.
76307>>>>>>>    //***
76307>>>>>>>
76307>>>>>>>    Procedure ReadConfiguration
76309>>>>>>>        Local String  sVoid
76309>>>>>>>        Local String  sDriverID
76309>>>>>>>        Local Integer iVoid
76309>>>>>>>
76309>>>>>>>        Get psDriverID To sDriverID
76310>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_READCONFIGURATION Callback 0 Passing sVoid sVoid iVoid Result iVoid
76317>>>>>>>    End_Procedure // ReadConfiguration
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>    //***
76318>>>>>>>    //*** Function: TextToRIMValue
76318>>>>>>>    //*** Purpose : Convert a text to the corresponding
76318>>>>>>>    //***           Generate_Record_ID_Method attribute value
76318>>>>>>>    //***
76318>>>>>>>
76318>>>>>>>    Function TextToRIMValue String sText Returns Integer
76320>>>>>>>        If (sText = "None") ;            Function_return RIM_NONE
76323>>>>>>>        Else If (sText = "Identity Column") ;            Function_return RIM_IDENTITY_COLUMN
76327>>>>>>>        Else If (sText = "Dispenser Table") ;            Function_return RIM_DISPENSER_TABLE
76331>>>>>>>        Else If (sText = "External") ;            Function_return RIM_EXTERNAL
76335>>>>>>>    End_Function // TextToRIMValue
76336>>>>>>>
76336>>>>>>>
76336>>>>>>>
76336>>>>>>>    //***
76336>>>>>>>    //*** Function: RIMValueTotext
76336>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76336>>>>>>>    //***           corresponding text.
76336>>>>>>>    //***
76336>>>>>>>
76336>>>>>>>    Function RIMValueToText Integer iAttrValue Returns String
76338>>>>>>>        If (iAttrValue = RIM_NONE) ;            Function_return "None"
76341>>>>>>>        Else If (iAttrValue = RIM_IDENTITY_COLUMN) ;            Function_return "Identity Column"
76345>>>>>>>        Else If (iAttrValue = RIM_DISPENSER_TABLE) ;            Function_return "Dispenser Table"
76349>>>>>>>        Else If (iAttrValue = RIM_EXTERNAL) ;            Function_return "External"
76353>>>>>>>    End_Function // RIMValueToText
76354>>>>>>>
76354>>>>>>>
76354>>>>>>>
76354>>>>>>>    //***
76354>>>>>>>    //*** Function: TextToROValue
76354>>>>>>>    //*** Purpose : Convert a text to the corresponding
76354>>>>>>>    //***           Generate_Record_ID_Method attribute value
76354>>>>>>>    //***
76354>>>>>>>
76354>>>>>>>    Function TextToROValue String sText Returns Integer
76356>>>>>>>        If (sText = "No") ;            Function_return RO_NO
76359>>>>>>>        Else If (sText = "Ignore Change") ;            Function_return RO_IGNORECHANGE
76363>>>>>>>        Else If (sText = "Accept Change") ;            Function_return RO_ACCEPTCHANGE
76367>>>>>>>        Else If (sText = "Error On Change") ;            Function_return RO_ERRORONCHANGE
76371>>>>>>>    End_Function // TextToRIMValue
76372>>>>>>>
76372>>>>>>>
76372>>>>>>>
76372>>>>>>>    //***
76372>>>>>>>    //*** Function: ROValueTotext
76372>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76372>>>>>>>    //***           corresponding text.
76372>>>>>>>    //***
76372>>>>>>>
76372>>>>>>>    Function ROValueToText Integer iAttrValue Returns String
76374>>>>>>>        If (iAttrValue = RO_NO) ;            Function_return "No"
76377>>>>>>>        Else If (iAttrValue = RO_IGNORECHANGE) ;            Function_return "Ignore Change"
76381>>>>>>>        Else If (iAttrValue = RO_ACCEPTCHANGE) ;            Function_return "Accept Change"
76385>>>>>>>        Else If (iAttrValue = RO_ERRORONCHANGE) ;            Function_return "Error On Change"
76389>>>>>>>    End_Function // RIMValueToText
76390>>>>>>>
76390>>>>>>>
76390>>>>>>>
76390>>>>>>>    //***
76390>>>>>>>    //*** Function: LastDriverError
76390>>>>>>>    //*** Purpose : Return the text f the last error geneated by the driver.
76390>>>>>>>    //***
76390>>>>>>>
76390>>>>>>>    Function LastDriverError Returns String
76392>>>>>>>        Local String  sDriverID
76392>>>>>>>        Local String  sLastError
76392>>>>>>>        Local String  sLastErrorLength
76392>>>>>>>        Local Integer iLastErrorLength
76392>>>>>>>        Local Integer iVoid
76392>>>>>>>
76392>>>>>>>        //*** Initialize
76392>>>>>>>        Move "" To sLastError
76393>>>>>>>
76393>>>>>>>        Get psDriverID To sDriverID
76394>>>>>>>        If (sDriverID <> "") Begin
76396>>>>>>>            //*** Get the text of the last error
76396>>>>>>>            Move (Repeat(Character(" "), 14)) To sLastErrorlength
76397>>>>>>>            Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastErrorLength iVoid DRVR_LASTERRORTEXTLENGTH Result iVoid
76402>>>>>>>            Move (Left(sLastErrorLength, Pos(Character(0), sLastErrorLength) - 1)) To iLastErrorLength
76403>>>>>>>
76403>>>>>>>            If (iLastErrorLength > 0) Begin
76405>>>>>>>                Move (Repeat(Character(" "), iLastErrorLength + 1)) To sLastError
76406>>>>>>>                Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastError iVoid DRVR_LASTERRORTEXT Result iVoid
76411>>>>>>>                Move (Left(sLastError, Pos(Character(0), sLastError) - 1)) To sLastError
76412>>>>>>>            End
76412>>>>>>>>
76412>>>>>>>        End
76412>>>>>>>>
76412>>>>>>>
76412>>>>>>>        Function_Return sLastError
76413>>>>>>>    End_Function // LastDriverError
76414>>>>>>>
76414>>>>>>>
76414>>>>>>>
76414>>>>>>>    //***
76414>>>>>>>    //*** Function: EnumerateTables
76414>>>>>>>    //*** Purpose : Enumerate the tables in a database
76414>>>>>>>    //***
76414>>>>>>>
76414>>>>>>>    Function EnumerateTables String sLogin Returns Integer
76416>>>>>>>        Local String  sDriver
76416>>>>>>>        Local String  sVoid
76416>>>>>>>        Local Integer iNumTables
76416>>>>>>>        Local Integer iVoid
76416>>>>>>>
76416>>>>>>>        Get psDriverID To sDriver
76417>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_TABLES Callback 0 Passing sLogin sVoid iVoid Result iNumTables
76424>>>>>>>
76424>>>>>>>        Function_Return iNumTables
76425>>>>>>>    End_Function // EnumerateTables
76426>>>>>>>
76426>>>>>>>
76426>>>>>>>
76426>>>>>>>    //***
76426>>>>>>>    //*** Function: TableName
76426>>>>>>>    //*** Purpose : Returns the name of the table enumerated at the given position
76426>>>>>>>    //***
76426>>>>>>>
76426>>>>>>>    Function TableName Integer iIndex Returns String
76428>>>>>>>        Local String  sDriver
76428>>>>>>>        Local String  sTableName
76428>>>>>>>        Local String  sVoid
76428>>>>>>>        Local Integer iVoid
76428>>>>>>>
76428>>>>>>>        Get psDriverID To sDriver
76429>>>>>>>        If (sDriver <> "") Begin
76431>>>>>>>            Move (Repeat(" ", 255)) To sTableName
76432>>>>>>>            Call_driver 0 sDriver Function CLI_TABLENAME Callback 0 Passing sTableName sVoid iIndex Result iVoid
76437>>>>>>>        End
76437>>>>>>>>
76437>>>>>>>
76437>>>>>>>        Function_Return sTableName
76438>>>>>>>    End_Function // TableName
76439>>>>>>>
76439>>>>>>>
76439>>>>>>>
76439>>>>>>>    //***
76439>>>>>>>    //*** Function: SchemaName
76439>>>>>>>    //*** Purpose : Returns the name of the schema of the table enumerated at the given position
76439>>>>>>>    //***
76439>>>>>>>
76439>>>>>>>    Function SchemaName Integer iIndex Returns String
76441>>>>>>>        Local String  sDriver
76441>>>>>>>        Local String  sSchemaName
76441>>>>>>>        Local String  sVoid
76441>>>>>>>        Local Integer iVoid
76441>>>>>>>
76441>>>>>>>        Get psDriverID To sDriver
76442>>>>>>>        If (sDriver <> "") Begin
76444>>>>>>>            Move (Repeat(" ", 255)) To sSchemaName
76445>>>>>>>            Call_driver 0 sDriver Function CLI_TABLESCHEMA Callback 0 Passing sSchemaName sVoid iIndex Result iVoid
76450>>>>>>>        End
76450>>>>>>>>
76450>>>>>>>
76450>>>>>>>        Function_Return sSchemaName
76451>>>>>>>    End_Function // SchemaName
76452>>>>>>>
76452>>>>>>>
76452>>>>>>>
76452>>>>>>>    //***
76452>>>>>>>    //*** Function: TableType
76452>>>>>>>    //*** Purpose : Returns the type of the table enumerated at the given position.
76452>>>>>>>    //***           Types can be "TABLE", "VIEW", "SYSTEM TABLE", "GLOBAL TEMPORARY",
76452>>>>>>>    //***           "LOCAL TEMPORARY", "ALIAS", "SYNONYM"
76452>>>>>>>    //***
76452>>>>>>>
76452>>>>>>>    Function TableType Integer iIndex Returns String
76454>>>>>>>        Local String  sDriver
76454>>>>>>>        Local String  sTableType
76454>>>>>>>        Local String  sVoid
76454>>>>>>>        Local Integer iVoid
76454>>>>>>>
76454>>>>>>>        Get psDriverID To sDriver
76455>>>>>>>        If (sDriver <> "") Begin
76457>>>>>>>            Move (Repeat(" ", 25)) To sTableType
76458>>>>>>>            Call_driver 0 sDriver Function CLI_TABLETYPE Callback 0 Passing sTableType sVoid iIndex Result iVoid
76463>>>>>>>        End
76463>>>>>>>>
76463>>>>>>>
76463>>>>>>>        Function_Return sTableType
76464>>>>>>>    End_Function // TableType
76465>>>>>>>
76465>>>>>>>
76465>>>>>>>
76465>>>>>>>    //***
76465>>>>>>>    //*** Function: TableComment
76465>>>>>>>    //*** Purpose : Returns the comment of the table enumerated at the given position
76465>>>>>>>    //***
76465>>>>>>>
76465>>>>>>>    Function TableComment Integer iIndex Returns String
76467>>>>>>>        Local String  sDriver
76467>>>>>>>        Local String  sTableComment
76467>>>>>>>        Local String  sVoid
76467>>>>>>>        Local Integer iVoid
76467>>>>>>>
76467>>>>>>>        Get psDriverID To sDriver
76468>>>>>>>        If (sDriver <> "") Begin
76470>>>>>>>            Move (Repeat(" ", 255)) To sTableComment
76471>>>>>>>            Call_driver 0 sDriver Function CLI_TABLECOMMENT Callback 0 Passing sTableComment sVoid iIndex Result iVoid
76476>>>>>>>        End
76476>>>>>>>>
76476>>>>>>>
76476>>>>>>>        Function_Return sTableComment
76477>>>>>>>    End_Function // TableComment
76478>>>>>>>
76478>>>>>>>
76478>>>>>>>
76478>>>>>>>    //***
76478>>>>>>>    //*** Function: EnumerateColumns
76478>>>>>>>    //*** Purpose : Enumerate the columns in a table
76478>>>>>>>    //***
76478>>>>>>>
76478>>>>>>>    Function EnumerateColumns String sLogin String sTableName Returns Integer
76480>>>>>>>        Local String  sDriver
76480>>>>>>>        Local Integer iNumColumns
76480>>>>>>>        Local Integer iVoid
76480>>>>>>>
76480>>>>>>>        Get psDriverID To sDriver
76481>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_COLUMNS Callback 0 Passing sLogin sTablename iVoid Result iNumColumns
76488>>>>>>>
76488>>>>>>>        Function_Return iNumColumns
76489>>>>>>>    End_Function // EnumerateColumns
76490>>>>>>>
76490>>>>>>>
76490>>>>>>>
76490>>>>>>>    //***
76490>>>>>>>    //*** Function: ColumnName
76490>>>>>>>    //*** Purpose : Returns the name of the column enumerated at the given position
76490>>>>>>>    //***
76490>>>>>>>
76490>>>>>>>    Function ColumnName Integer iIndex Returns String
76492>>>>>>>        Local String  sDriver
76492>>>>>>>        Local String  sColumnName
76492>>>>>>>        Local String  sVoid
76492>>>>>>>        Local Integer iVoid
76492>>>>>>>
76492>>>>>>>        Get psDriverID To sDriver
76493>>>>>>>        If (sDriver <> "") Begin
76495>>>>>>>            Move (Repeat(" ", 255)) To sColumnName
76496>>>>>>>            Call_driver 0 sDriver Function CLI_COLUMNNAME Callback 0 Passing sColumnName sVoid iIndex Result iVoid
76501>>>>>>>        End
76501>>>>>>>>
76501>>>>>>>
76501>>>>>>>        Function_Return sColumnName
76502>>>>>>>    End_Function // ColumnName
76503>>>>>>>
76503>>>>>>>
76503>>>>>>>
76503>>>>>>>    //***
76503>>>>>>>    //*** Function: CLIDFDateToSQLDate
76503>>>>>>>    //*** Purpose : Convert a DataFlex date to a SQL date using the dummy zero date value.
76503>>>>>>>    //***
76503>>>>>>>
76503>>>>>>>    Function CLIDFDateToSQLDate String sDRiver Date dDFDate Returns String
76505>>>>>>>        Local String sSQLDate
76505>>>>>>>        Local Integer iOrgDateFmt
76505>>>>>>>        Local Integer iOrgDateSep
76505>>>>>>>
76505>>>>>>>        //*** Change date format to military, SQL dates are military dates
76505>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76508>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76511>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76514>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76517>>>>>>>
76517>>>>>>>        //*** We only need to convert if the date is 0
76517>>>>>>>        If (Integer(dDFDate = 0)) ;            CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sSQLDate
76526>>>>>>>        Else ;            Move dDFDate To sSQLDate
76528>>>>>>>
76528>>>>>>>        //*** Change date format back to original
76528>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76531>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76534>>>>>>>
76534>>>>>>>        Function_Return sSQLDate
76535>>>>>>>    End_Function // CLIDFDateToSQLDate
76536>>>>>>>
76536>>>>>>>
76536>>>>>>>
76536>>>>>>>    //***
76536>>>>>>>    //*** Function: CLISQLDateToDFDate
76536>>>>>>>    //*** Purpose : Convert a SQL date to a DataFlex date using the dummy zero date value.
76536>>>>>>>    //***
76536>>>>>>>
76536>>>>>>>    Function CLISQLDateToDFDate String sDRiver String sSQLDate Returns Date
76538>>>>>>>        Local Date dDFDate
76538>>>>>>>        Local String sDummyDateValue
76538>>>>>>>        Local Integer iOrgDateFmt
76538>>>>>>>        Local Integer iOrgDateSep
76538>>>>>>>
76538>>>>>>>        //*** Change date format to military, SQL dates are military dates
76538>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76541>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76544>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76547>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76550>>>>>>>
76550>>>>>>>        //*** We only need to convert if the date is the dummy zero date value
76550>>>>>>>        CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sDummyDateValue
76557>>>>>>>        If (sDummyDateValue = sSQLDate) ;            Move 0 To dDFDate
76560>>>>>>>        Else ;            Move sSQLDate To dDFDate
76562>>>>>>>
76562>>>>>>>        //*** Change date format back to original
76562>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76565>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76568>>>>>>>
76568>>>>>>>        Function_Return dDFDate
76569>>>>>>>    End_Function // CLISQLDateToDFDate
76570>>>>>>>
76570>>>>>>>
76570>>>>>>>
76570>>>>>>>    //***
76570>>>>>>>    //*** Function: RedirectConnection
76570>>>>>>>    //*** Purpose : Redirect an exisitng connection. The existing connection
76570>>>>>>>    //***           will point to another database but all tables will stay
76570>>>>>>>    //***           open!
76570>>>>>>>    //***
76570>>>>>>>
76570>>>>>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
76572>>>>>>>        Local String  sDriver
76572>>>>>>>        Local String  sVoid
76572>>>>>>>        Local Integer iResult
76572>>>>>>>        Local Integer iVoid
76572>>>>>>>
76572>>>>>>>        Get psDriverID To sDriver
76573>>>>>>>        If (sDriver <> "") Begin
76575>>>>>>>            Call_driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sOldConnection sNewConnection iVoid Result iResult
76580>>>>>>>        End
76580>>>>>>>>
76580>>>>>>>        Function_Return iResult
76581>>>>>>>    End_Function // RedirectConnect
76582>>>>>>>
76582>>>>>>>
76582>>>>>>>
76582>>>>>>>    //***
76582>>>>>>>    //*** Function: CreateConnectionID
76582>>>>>>>    //*** Purpose : Create a DataFlex side connection id that can be used later on.
76582>>>>>>>    //***
76582>>>>>>>
76582>>>>>>>    Function CreateConnectionID String sID String sConnStr Integer iOpt Returns Integer
76584>>>>>>>        Local String  sDriver
76584>>>>>>>        Local Integer iResult
76584>>>>>>>        Local Integer iOptions
76584>>>>>>>
76584>>>>>>>        Get psDriverID to sDriver
76585>>>>>>>        If (Num_Arguments = 2) ;            Move 0 to iOptions
76588>>>>>>>        Else ;            Move iOpt to iOptions
76590>>>>>>>        If (sDriver <> "") Begin
76592>>>>>>>            Call_Driver 0 sDriver Function CLI_CREATECONNECTIONID Callback 0 Passing sID sConnStr iOptions Result iResult
76597>>>>>>>        End
76597>>>>>>>>
76597>>>>>>>        Function_Return iResult
76598>>>>>>>    End_Function // CreateConnectionID
76599>>>>>>>
76599>>>>>>>
76599>>>>>>>
76599>>>>>>>    //***
76599>>>>>>>    //*** Function: DeleteConnectionID
76599>>>>>>>    //*** Purpose : Delete a DataFlex side connection id.
76599>>>>>>>    //***
76599>>>>>>>
76599>>>>>>>    Function DeleteConnectionID String sID Integer iIndex Returns Integer
76601>>>>>>>        Local String  sDriver
76601>>>>>>>        Local Integer iResult
76601>>>>>>>        Local String sVoid
76601>>>>>>>
76601>>>>>>>        Get psDriverID To sDriver
76602>>>>>>>        If (sDriver <> "") Begin
76604>>>>>>>            Call_Driver 0 sDriver Function CLI_DELETECONNECTIONID Callback 0 Passing sID sVoid iIndex Result iResult
76609>>>>>>>        End
76609>>>>>>>>
76609>>>>>>>        Function_Return iResult
76610>>>>>>>    End_Function // DeleteConnectionID
76611>>>>>>>
76611>>>>>>>End_Class // cCLIHandler
76612>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 18.2\Pkg\DFBTRDRV.PKG)
76612>>>>>>>//****************************************************************************
76612>>>>>>>//
76612>>>>>>>// $File name  : DFBTRDRV.PKG
76612>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
76612>>>>>>>// Notice      : This package contains constants and commands, used to call
76612>>>>>>>//               specific functions in the DFBTRDRV.
76612>>>>>>>// $Author(s)  : Eddy Kleinjan
76612>>>>>>>//
76612>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
76612>>>>>>>// Created     : 01-07-97 @ 12:00:00
76612>>>>>>>//
76612>>>>>>>// Changed     : 04-04-2001.
76612>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
76612>>>>>>>//
76612>>>>>>>// Changed     : June 6, 2001
76612>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
76612>>>>>>>//
76612>>>>>>>//               Added DFBTR_DDF_OWNER command.
76612>>>>>>>//
76612>>>>>>>// Changed     : June 12, 2001
76612>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
76612>>>>>>>//
76612>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
76612>>>>>>>//
76612>>>>>>>// Changed     : August 4, 2004
76612>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
76612>>>>>>>//
76612>>>>>>>//               Added cDfbtrdrvHandler class.
76612>>>>>>>//               New functions in this class:
76612>>>>>>>//                  Function CKRevision Returns String
76612>>>>>>>//                  Function CkUsesUri Returns Integer
76612>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76612>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76612>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76612>>>>>>>//
76612>>>>>>>// Changed     : September 30, 2005
76612>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
76612>>>>>>>//
76612>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
76612>>>>>>>//****************************************************************************
76612>>>>>>>Use Ui
76612>>>>>>>//
76612>>>>>>>// Driver Indentification
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//*** Driver attributes
76612>>>>>>>//
76612>>>>>>>// Call_Driver functions ID's
76612>>>>>>>//
76612>>>>>>>//
76612>>>>>>>// DFBTRFN_CONVERT_FILE options
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// DFBTRFN_SET_OWNER options
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to create all vars which may be needed
76612>>>>>>>// in other commands.
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to set the owner of a Btrieve file.
76612>>>>>>>// File must have been opened.
76612>>>>>>>// Filenumber needs to be passed.
76612>>>>>>>// To clear set the owner to "".
76612>>>>>>>// Examples:
76612>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
76612>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
76612>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
76612>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
76612>>>>>>>// To clear:
76612>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to parse DFBTR_SET_OWNVER
76612>>>>>>>// options.
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to parse for Callback
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to clear the owner of a Btrieve file.
76612>>>>>>>// File must have been opened.
76612>>>>>>>// Filenumber needs to be passed.
76612>>>>>>>// Examples:
76612>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to add a owner name to the internal list of ownernames
76612>>>>>>>// which will be tries when opening files.
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to remove all owners from the internal list of ownernames
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to set the owner name to be used when opening the DDF files.
76612>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
76612>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
76612>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to change the transaction type.
76612>>>>>>>// Valid types are:
76612>>>>>>>//     DFBTRTT_NONE
76612>>>>>>>//     DFBTRTT_EXCLUSIVE
76612>>>>>>>//     DFBTRTT_CONCURRENT
76612>>>>>>>//
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to get the current transaction type.
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to set explicit_locking
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to get explicit locking
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//*****************************************************************************
76612>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
76612>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76612>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
76612>>>>>>>//*****************************************************************************
76612>>>>>>>
76612>>>>>>>Class cDFBtrDrvHandler Is An Array
76613>>>>>>>
76613>>>>>>>    Procedure Construct_Object Integer iImage
76615>>>>>>>        Forward Send Construct_object iImage
76617>>>>>>>
76617>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
76618>>>>>>>    End_Procedure // Construct_Object
76619>>>>>>>
76619>>>>>>>
76619>>>>>>>
76619>>>>>>>    //***
76619>>>>>>>    //*** Function: CKRevsion
76619>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
76619>>>>>>>    //***
76619>>>>>>>
76619>>>>>>>    Function CKRevision Returns String
76621>>>>>>>        Local String  sDriverID
76621>>>>>>>        Local String  sRevision
76621>>>>>>>        Local String  sVoid
76621>>>>>>>        Local Integer iRetval
76621>>>>>>>
76621>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76621>>>>>>>        // This error would otherwise be raised when we have an older
76621>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76621>>>>>>>        Send Ignore_error To Error_object_Id 20491
76622>>>>>>>        Get psDriverID To sDriverID
76623>>>>>>>        Move (Repeat(" ", 255)) To sRevision
76624>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76629>>>>>>>        Send Trap_Error To Error_object_Id 20491
76630>>>>>>>        If (Trim(sRevision) = "") Begin
76632>>>>>>>            // Unable to get the revision. return all zeroes.
76632>>>>>>>            Move "0.0.0.0" To sRevision
76633>>>>>>>        End
76633>>>>>>>>
76633>>>>>>>        Function_Return sRevision
76634>>>>>>>    End_Function // CKRevision
76635>>>>>>>
76635>>>>>>>    Function CkUsesUri Returns Integer
76637>>>>>>>        Local String  sDriverID
76637>>>>>>>        Local String  sVoid1
76637>>>>>>>        Local String  sVoid2
76637>>>>>>>        Local Integer iRetval
76637>>>>>>>
76637>>>>>>>        Get psDriverID To sDriverID
76638>>>>>>>
76638>>>>>>>        Move 0 To iRetval
76639>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76639>>>>>>>        // This error would otherwise be raised when we have an older
76639>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
76639>>>>>>>        Send Ignore_error To Error_object_Id 20491
76640>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
76645>>>>>>>        Send Trap_Error To Error_object_Id 20491
76646>>>>>>>
76646>>>>>>>        Function_Return iRetval
76647>>>>>>>    End_Function // CKUsesUri
76648>>>>>>>
76648>>>>>>>
76648>>>>>>>
76648>>>>>>>    //***
76648>>>>>>>    //*** Function: ExtractPartFromRevsion
76648>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76648>>>>>>>    //***
76648>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76648>>>>>>>    //***
76648>>>>>>>
76648>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76650>>>>>>>        Local Integer iPartRev
76650>>>>>>>        Local Integer iCurrentPart
76650>>>>>>>        Local Integer iSeparatorPos
76650>>>>>>>
76650>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76653>>>>>>>
76653>>>>>>>        Move 0 To iCurrentPart
76654>>>>>>>        Repeat
76654>>>>>>>>
76654>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76655>>>>>>>            If (iSeparatorPos > 0) Begin
76657>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76658>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76659>>>>>>>                Increment iCurrentPart
76660>>>>>>>            End
76660>>>>>>>>
76660>>>>>>>            Else If (sRevision <> "") Begin
76663>>>>>>>                Move sRevision To iPartRev
76664>>>>>>>                Move "" To sRevision
76665>>>>>>>                Increment iCurrentPart
76666>>>>>>>            End
76666>>>>>>>>
76666>>>>>>>            Else ;                Move -1 To iPartRev
76668>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76670>>>>>>>
76670>>>>>>>        Function_Return iPartRev
76671>>>>>>>    End_Function // EcxtractPartFromRevision
76672>>>>>>>
76672>>>>>>>
76672>>>>>>>
76672>>>>>>>    //***
76672>>>>>>>    //*** Function: CKMajorRevision
76672>>>>>>>    //*** Purpose : Returns the major revision of the CK
76672>>>>>>>    //***
76672>>>>>>>
76672>>>>>>>    Function CKMajorRevision Returns Integer
76674>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76675>>>>>>>    End_Function // CKMajorRevision
76676>>>>>>>
76676>>>>>>>
76676>>>>>>>
76676>>>>>>>    //***
76676>>>>>>>    //*** Function: CKMinorRevision
76676>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76676>>>>>>>    //***
76676>>>>>>>
76676>>>>>>>    Function CKMinorRevision Returns Integer
76678>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76679>>>>>>>    End_Function // CKMinorRevision
76680>>>>>>>
76680>>>>>>>
76680>>>>>>>
76680>>>>>>>    //***
76680>>>>>>>    //*** Function: CKReleaseRevision
76680>>>>>>>    //*** Purpose : Returns the release revision of the CK
76680>>>>>>>    //***
76680>>>>>>>
76680>>>>>>>    Function CKReleaseRevision Returns Integer
76682>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76683>>>>>>>    End_Function // CKReleaseRevision
76684>>>>>>>
76684>>>>>>>
76684>>>>>>>
76684>>>>>>>    //***
76684>>>>>>>    //*** Function: CKBuildRevision
76684>>>>>>>    //*** Purpose : Returns the major revision of the CK
76684>>>>>>>    //***
76684>>>>>>>
76684>>>>>>>    Function CKBuildRevision Returns Integer
76686>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76687>>>>>>>    End_Function // CKBuildRevision
76688>>>>>>>
76688>>>>>>>
76688>>>>>>>
76688>>>>>>>    //***
76688>>>>>>>    //*** Function: IsMinimalRevision
76688>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76688>>>>>>>    //***
76688>>>>>>>
76688>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76690>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76693>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76696>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76699>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76702>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76705>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76709>>>>>>>            End
76709>>>>>>>>
76709>>>>>>>        End
76709>>>>>>>>
76709>>>>>>>
76709>>>>>>>        Function_Return (FALSE)
76710>>>>>>>    End_Function // IsMinimalRevision
76711>>>>>>>
76711>>>>>>>    //   Functions to query the Pervasive.SQL version:
76711>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
76711>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
76711>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
76711>>>>>>>    //
76711>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
76711>>>>>>>    //   in the following format:
76711>>>>>>>    //       <version>.<revision>.<type>
76711>>>>>>>    //   possible values for <type>:
76711>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
76711>>>>>>>    //         server using Workgroup authentication mode
76711>>>>>>>    //       C for client cache engine
76711>>>>>>>    //       D for DOS workstation
76711>>>>>>>    //       N for client Requester
76711>>>>>>>    //       S for NetWare server
76711>>>>>>>    //       T for 32-bit Windows server engine
76711>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
76711>>>>>>>    //
76711>>>>>>>    //   example:
76711>>>>>>>    //       8.50.T
76711>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
76711>>>>>>>    //   32-bits Windows server.
76711>>>>>>>    //
76711>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
76711>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
76711>>>>>>>    //
76711>>>>>>>    //   If the version information is not available or can not be obtained
76711>>>>>>>    //   the functions will return "0.0.0"
76711>>>>>>>
76711>>>>>>>
76711>>>>>>>    //***
76711>>>>>>>    //*** Function: PSQLRequesterVersionInfo
76711>>>>>>>    //*** Purpose : Returns the version information of the
76711>>>>>>>    //***           Pervasive.SQL Client requester.
76711>>>>>>>
76711>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76713>>>>>>>
76713>>>>>>>        Local String  sDriverID
76713>>>>>>>        Local String  sVersion
76713>>>>>>>        Local String  sVoid
76713>>>>>>>        Local Integer iRetval
76713>>>>>>>
76713>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76713>>>>>>>        // This error would otherwise be raised when we have an older
76713>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76713>>>>>>>        Send Ignore_error To Error_object_Id 20491
76714>>>>>>>        Get psDriverID To sDriverID
76715>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76716>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76721>>>>>>>        Send Trap_Error To Error_object_Id 20491
76722>>>>>>>        If (Trim(sVersion) = "") Begin
76724>>>>>>>            // Unable to get the revision. return all zeroes.
76724>>>>>>>            Move "0.0.0" To sVersion
76725>>>>>>>        End
76725>>>>>>>>
76725>>>>>>>        Function_Return sVersion
76726>>>>>>>    End_Function //  PSQLRequesterVersion
76727>>>>>>>
76727>>>>>>>    //***
76727>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
76727>>>>>>>    //*** Purpose : Returns the version information of the
76727>>>>>>>    //***           Pervasive.SQL Local Engine
76727>>>>>>>
76727>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76729>>>>>>>
76729>>>>>>>        Local String  sDriverID
76729>>>>>>>        Local String  sVersion
76729>>>>>>>        Local String  sVoid
76729>>>>>>>        Local Integer iRetval
76729>>>>>>>
76729>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76729>>>>>>>        // This error would otherwise be raised when we have an older
76729>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76729>>>>>>>        Send Ignore_error To Error_object_Id 20491
76730>>>>>>>        Get psDriverID To sDriverID
76731>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76732>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76737>>>>>>>        Send Trap_Error To Error_object_Id 20491
76738>>>>>>>        If (Trim(sVersion) = "") Begin
76740>>>>>>>            // Unable to get the revision. return all zeroes.
76740>>>>>>>            Move "0.0.0" To sVersion
76741>>>>>>>        End
76741>>>>>>>>
76741>>>>>>>        Function_Return sVersion
76742>>>>>>>    End_Function //  PSQLLocalEngineVersion
76743>>>>>>>
76743>>>>>>>    //***
76743>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
76743>>>>>>>    //*** Purpose : Returns the version information of the
76743>>>>>>>    //***           Pervasive.SQL Server Engine
76743>>>>>>>
76743>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76745>>>>>>>
76745>>>>>>>        Local String  sDriverID
76745>>>>>>>        Local String  sVersion
76745>>>>>>>        Local String  sVoid
76745>>>>>>>        Local Integer iRetval
76745>>>>>>>
76745>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76745>>>>>>>        // This error would otherwise be raised when we have an older
76745>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76745>>>>>>>        Send Ignore_error To Error_object_Id 20491
76746>>>>>>>        Get psDriverID To sDriverID
76747>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76748>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76753>>>>>>>        Send Trap_Error To Error_object_Id 20491
76754>>>>>>>        If (Trim(sVersion) = "") Begin
76756>>>>>>>            // Unable to get the revision. return all zeroes.
76756>>>>>>>            Move "0.0.0" To sVersion
76757>>>>>>>        End
76757>>>>>>>>
76757>>>>>>>        Function_Return sVersion
76758>>>>>>>    End_Function //  PSQLServerEngineVersion
76759>>>>>>>
76759>>>>>>>End_Class // cDfbtrdrvHandler
76760>>>>>>>
76760>>>>>
76760>>>>>
76760>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
76761>>>>>
76761>>>>>Register_Function phoWorkspace Returns Handle
76761>>>>>Register_Function Help_filename Returns String
76761>>>>>Register_Function GetHelpFile Returns String
76761>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
76761>>>>>
76761>>>>>//****************************************************************************
76761>>>>>// $Module type: FUNCTION
76761>>>>>// $Module name: Network_User_Name
76761>>>>>// $Author     : AK/VOO/KCR
76761>>>>>// Created     : 09-24-96 @ 19:17
76761>>>>>//
76761>>>>>// Description
76761>>>>>//    This function reads the current username Of windows and returns that
76761>>>>>//    name or an text unknown user
76761>>>>>//
76761>>>>>// $Rev History
76761>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
76761>>>>>//  07/25/2003  Replaced obsolete code
76761>>>>>//  09/24/1996  Module header created
76761>>>>>//****************************************************************************
76761>>>>>Function Network_User_Name for cDesktop Returns String
76763>>>>>    String sName
76763>>>>>    Integer iRetval iLength
76763>>>>>
76763>>>>>    Move 0 to iLength
76764>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
76765>>>>>    ZeroString iLength to sName
76766>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
76767>>>>>
76767>>>>>    If (iRetval = NO_ERROR) Begin
76769>>>>>        Function_Return (CString (sName))
76770>>>>>    End
76770>>>>>>
76770>>>>>    
76770>>>>>    Function_Return "User Unknown"
76771>>>>>End_Function
76772>>>>>
76772>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
76772>>>>>Type MEMORYSTATUS
76772>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
76772>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
76772>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
76772>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
76772>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
76772>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
76772>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
76772>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
76772>>>>>End_Type // MEMORYSTATUS
76772>>>>>
76772>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
76773>>>>>
76773>>>>>Struct tWinMemoryStatusEx
76773>>>>>    UInteger dwLength                
76773>>>>>    UInteger dwMemoryLoad          
76773>>>>>    UBigInt ullTotalPhys           
76773>>>>>    UBigInt ullAvailPhys           
76773>>>>>    UBigInt ullTotalPageFile       
76773>>>>>    UBigInt ullAvailPageFile       
76773>>>>>    UBigInt ullTotalVirtual        
76773>>>>>    UBigInt ullAvailVirtual        
76773>>>>>    UBigInt ullAvailExtendedVirtual
76773>>>>>End_Struct
76773>>>>>
76773>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
76774>>>>>
76774>>>>>Class SysinfoDisplay is a cTextEdit
76775>>>>>    Procedure Construct_Object
76777>>>>>        Forward Send Construct_Object
76779>>>>>
76779>>>>>        Set Location To 6 6
76780>>>>>        Set Size To 110 255
76781>>>>>        Set Read_Only_State To True
76782>>>>>        Set pbWrap to False
76783>>>>>    End_Procedure
76784>>>>>
76784>>>>>    //****************************************************************************
76784>>>>>    // $Module type: PROCEDURE
76784>>>>>    // $Module name: Show_Current_Directory
76784>>>>>    // $Author     : VOO
76784>>>>>    // Created     : 06-10-96 @ 15:24
76784>>>>>    //
76784>>>>>    // Description
76784>>>>>    //    This method will show the name Of the current directory in the system
76784>>>>>    //    information box
76784>>>>>    //
76784>>>>>    // $Rev History
76784>>>>>    //    06-10-96  Module header created
76784>>>>>    //****************************************************************************
76784>>>>>    Procedure Show_Current_Directory
76786>>>>>        String sDir
76786>>>>>
76786>>>>>        Get_Current_Directory To sDir
76787>>>>>
76787>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
76788>>>>>    End_Procedure
76789>>>>>
76789>>>>>    Procedure Show_Windows_Directory
76791>>>>>        String sWindir
76791>>>>>
76791>>>>>        Get_Windows_Directory To sWindir
76792>>>>>
76792>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
76793>>>>>    End_Procedure
76794>>>>>
76794>>>>>    Procedure Show_Current_User
76796>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
76797>>>>>    End_Procedure
76798>>>>>
76798>>>>>    Procedure Show_Number_Format
76800>>>>>        Integer iFormat
76800>>>>>        String sFormatText
76800>>>>>
76800>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
76803>>>>>        Move (Character (iFormat)) To sFormatText
76804>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
76805>>>>>
76805>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
76808>>>>>        Move (Character (iFormat)) to sFormatText
76809>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
76810>>>>>    End_Procedure
76811>>>>>
76811>>>>>    Procedure Show_Filelist_Name
76813>>>>>        String sFilename
76813>>>>>
76813>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
76816>>>>>
76816>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
76817>>>>>        Send AppendTextLn ""
76818>>>>>    End_Procedure
76819>>>>>
76819>>>>>    Procedure Show_Lock_Delay
76821>>>>>        Integer iLockdelay
76821>>>>>
76821>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
76824>>>>>
76824>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
76825>>>>>    End_Procedure
76826>>>>>
76826>>>>>    Procedure Show_Lock_Timeout
76828>>>>>        Integer iLockTimeout
76828>>>>>
76828>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
76831>>>>>
76831>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
76832>>>>>    End_Procedure
76833>>>>>
76833>>>>>    Procedure Show_Screen_Size
76835>>>>>        Integer iYscreensize iXscreensize
76835>>>>>
76835>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
76836>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
76837>>>>>
76837>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
76838>>>>>    End_Procedure
76839>>>>>
76839>>>>>    Procedure Show_Page_Size
76841>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
76842>>>>>    End_procedure
76843>>>>>
76843>>>>>    Procedure Show_Date
76845>>>>>        Date dToday
76845>>>>>
76845>>>>>        Sysdate dToday
76846>>>>>
76846>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
76847>>>>>    End_procedure
76848>>>>>
76848>>>>>    Procedure Show_Date_Format
76850>>>>>        Integer iDateFormat
76850>>>>>        String sDateFormat
76850>>>>>
76850>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
76853>>>>>        Case Begin
76853>>>>>            Case (iDateFormat = DF_DATE_USA)
76855>>>>>                Move C_$USA To sDateFormat
76856>>>>>                Case Break
76857>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
76860>>>>>                Move C_$European To sDateFormat
76861>>>>>                Case Break
76862>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
76865>>>>>                Move C_$Military To sDateFormat
76866>>>>>                Case Break
76867>>>>>            Case Else
76867>>>>>                Move C_$UnknownDateType To sDateFormat
76868>>>>>                Case Break
76869>>>>>        Case End
76869>>>>>
76869>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
76870>>>>>    End_Procedure
76871>>>>>
76871>>>>>    Procedure Show_Systemresources
76873>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76873>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76873>>>>>        Integer iRetval
76873>>>>>
76873>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
76874>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
76875>>>>>        If (iRetval = 0) Begin
76877>>>>>            Move (ShowLastError ()) to iRetval
76878>>>>>        End
76878>>>>>>
76878>>>>>
76878>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
76879>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
76880>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
76881>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
76882>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
76883>>>>>    End_Procedure
76884>>>>>
76884>>>>>    Procedure Show_Registration
76886>>>>>        String sRegName
76886>>>>>        Integer iSN iMaxUsers
76886>>>>>
76886>>>>>        Registration sRegName iSN
76887>>>>>>
76887>>>>>        
76887>>>>>        Get_Licensed_Max_Users to iMaxUsers
76888>>>>>
76888>>>>>        Send AppendTextLn ""
76889>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
76890>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
76891>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
76892>>>>>    End_Procedure
76893>>>>>
76893>>>>>    //****************************************************************************
76893>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
76893>>>>>    // To the workspace object passing the an object and message To send back
76893>>>>>    // To this object. It is expected that the workspace object will send this
76893>>>>>    // message for every line Of information it wants displayed (passing the
76893>>>>>    // information To be displayed
76893>>>>>    //****************************************************************************
76893>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
76893>>>>>
76893>>>>>    Procedure Show_ServicePack
76895>>>>>        String sKey sVersionDescription sVersion 
76895>>>>>        Handle hoRegistry
76895>>>>>        Boolean bExists bOpened
76895>>>>>        
76895>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
76896>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
76897>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
76898>>>>>
76898>>>>>        Move C_DFVersionRegistryRoot to sKey
76899>>>>>        Get KeyExists of hoRegistry sKey to bExists
76900>>>>>        If (bExists) Begin
76902>>>>>            Get OpenKey of hoRegistry sKey to bOpened
76903>>>>>            If (bOpened) Begin
76905>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
76906>>>>>                If (bExists) Begin
76908>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
76909>>>>>                End
76909>>>>>>
76909>>>>>                
76909>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
76910>>>>>                If (bExists) Begin
76912>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
76913>>>>>                End                
76913>>>>>>
76913>>>>>                Send CloseKey of hoRegistry
76914>>>>>            End
76914>>>>>>
76914>>>>>        End
76914>>>>>>
76914>>>>>        Send Destroy of hoRegistry
76915>>>>>
76915>>>>>        If (sVersionDescription <> "") Begin
76917>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
76918>>>>>           Send AppendTextLn ""
76919>>>>>        End
76919>>>>>>
76919>>>>>    End_Procedure
76920>>>>>    
76920>>>>>
76920>>>>>    Procedure Show_WorkspaceInformation
76922>>>>>        Integer hoWorkspace
76922>>>>>
76922>>>>>        If (ghoApplication <> 0) Begin
76924>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
76925>>>>>            If (hoWorkspace <> 0) Begin
76927>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
76928>>>>>                Send AppendTextLn ""
76929>>>>>            End
76929>>>>>>
76929>>>>>        End
76929>>>>>>
76929>>>>>    End_Procedure
76930>>>>>
76930>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
76932>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
76933>>>>>    End_Function
76934>>>>>
76934>>>>>    Procedure Show_Versions
76936>>>>>        Integer iVersion iRevision iBuild
76936>>>>>
76936>>>>>        Version_Information iVersion iRevision iBuild
76938>>>>>
76938>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
76939>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
76940>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
76941>>>>>    End_Procedure
76942>>>>>    
76942>>>>>    Function CKRevisionNumber String sDriverID Returns String
76944>>>>>        Handle hoCLIHandler
76944>>>>>        Handle hoDFBtrDrvHandler
76944>>>>>        String sCKRevision
76944>>>>>
76944>>>>>
76944>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
76946>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
76947>>>>>            Set psDriverID of hoCLIHandler to sDriverID
76948>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
76949>>>>>            Send Destroy of hoCLIHandler
76950>>>>>        End
76950>>>>>>
76950>>>>>        Else Begin
76951>>>>>            If (sDriverID = "DFBTRDRV") Begin
76953>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
76954>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
76955>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
76956>>>>>                Send Destroy of hoDFBtrDrvHandler
76957>>>>>            End
76957>>>>>>
76957>>>>>        End
76957>>>>>>
76957>>>>>        
76957>>>>>        Function_Return sCKRevision
76958>>>>>    End_Function
76959>>>>>    
76959>>>>>    
76959>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
76961>>>>>        
76961>>>>>        If (sDriverID = "DATAFLEX") Begin
76963>>>>>            Function_Return False
76964>>>>>        End
76964>>>>>>
76964>>>>>    
76964>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
76965>>>>>    End_Function    
76966>>>>>
76966>>>>>
76966>>>>>    //***
76966>>>>>    //*** BW
76966>>>>>    //*** Procedure: Show_Drivers
76966>>>>>    //*** Purpose  : Show loaded database drivers
76966>>>>>    //***
76966>>>>>
76966>>>>>    Procedure Show_Drivers
76968>>>>>        String sCurrentDriver sRevNumber
76968>>>>>        String sLoadedDrivers
76968>>>>>        Integer iNumberOfDrivers iCount
76968>>>>>        Boolean bOK
76968>>>>>
76968>>>>>        Move "" To sLoadedDrivers
76969>>>>>        Get_Attribute DF_NUMBER_DRIVERS To iNumberOfDrivers
76972>>>>>        For iCount From 1 To iNumberOfDrivers
76978>>>>>>
76978>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
76981>>>>>            If (sLoadedDrivers <> "") Begin
76983>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
76984>>>>>            End
76984>>>>>>
76984>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
76985>>>>>            If (bOK) Begin
76987>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
76988>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
76989>>>>>            End
76989>>>>>>
76989>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) To sLoadedDrivers
76990>>>>>        Loop
76991>>>>>>
76991>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
76992>>>>>    End_Procedure
76993>>>>>
76993>>>>>    Procedure Show_HelpFile
76995>>>>>        String sHelpFile
76995>>>>>        Integer eHelpType
76995>>>>>
76995>>>>>        If (ghoApplication <> 0) Begin
76997>>>>>            Get peHelpType Of ghoApplication To eHelpType
76998>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
77000>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
77001>>>>>            End
77001>>>>>>
77001>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
77004>>>>>                Get Help_filename Of Help_object_id To sHelpFile
77005>>>>>            End
77005>>>>>>
77005>>>>>            Else Begin
77006>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
77007>>>>>            End
77007>>>>>>
77007>>>>>
77007>>>>>            Send AppendTextLn ""
77008>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
77009>>>>>        End
77009>>>>>>
77009>>>>>    End_Procedure
77010>>>>>
77010>>>>>    Procedure Show_EnterAsTab
77012>>>>>        Boolean bEnterKeyAsTabKey
77012>>>>>        String sText
77012>>>>>
77012>>>>>        If (ghoApplication <> 0) Begin
77014>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
77015>>>>>            If (bEnterKeyAsTabKey) Begin
77017>>>>>                Move "True" To sText
77018>>>>>            End
77018>>>>>>
77018>>>>>            Else Begin
77019>>>>>                Move "False" To sText
77020>>>>>            End
77020>>>>>>
77020>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
77021>>>>>        End
77021>>>>>>
77021>>>>>    End_Procedure
77022>>>>>
77022>>>>>    //****************************************************************************
77022>>>>>    // $Module type: PROCEDURE
77022>>>>>    // $Module name: Add_Focus
77022>>>>>    // $Author     : VOO
77022>>>>>    // Created     : 24-09-96 @ 19:43
77022>>>>>    //
77022>>>>>    // Description
77022>>>>>    //    During activation we will remove the old information and add the newly
77022>>>>>    //    found systeminformation
77022>>>>>    //
77022>>>>>    // $Rev History
77022>>>>>    //    24-09-96  Module header created
77022>>>>>    //****************************************************************************
77022>>>>>    Procedure Add_Focus Integer hoRoot
77024>>>>>        Forward Send Add_Focus hoRoot
77026>>>>>
77026>>>>>        Send Delete_Data
77027>>>>>
77027>>>>>        Set Changed_State To False
77028>>>>>        Set Read_Only_State To True
77029>>>>>
77029>>>>>        Send Show_ServicePack
77030>>>>>        Send Show_Versions   
77031>>>>>        Send Show_Drivers         
77032>>>>>        Send Show_HelpFile
77033>>>>>        Send Show_Current_Directory
77034>>>>>        Send Show_Filelist_Name          
77035>>>>>        If (ghoApplication <> 0) Begin
77037>>>>>            Send Show_WorkSpaceInformation // added To show WS info
77038>>>>>        End
77038>>>>>>
77038>>>>>        Send Show_Current_User 
77039>>>>>        Send Show_Windows_Directory 
77040>>>>>        Send Show_Screen_Size
77041>>>>>        Send Show_Page_Size
77042>>>>>        Send Show_EnterAsTab        
77043>>>>>        Send Show_Number_Format
77044>>>>>        Send Show_Date_Format
77045>>>>>        Send Show_Lock_Delay
77046>>>>>        Send Show_Lock_Timeout
77047>>>>>        Send Show_Date
77048>>>>>        Send Show_Systemresources
77049>>>>>        Send Show_Registration
77050>>>>>        Send Beginning_of_Data
77051>>>>>
77051>>>>>        Set Icon to 'default.ico'
77052>>>>>    End_Procedure
77053>>>>>End_Class
77054>>>>>
77054>>>>>//****************************************************************************
77054>>>>>// $Module type: OBJECT
77054>>>>>// $Module name: Sysinfo_Dialog
77054>>>>>// $Author     : VOO
77054>>>>>// Created     : 24-09-96 @ 18:47
77054>>>>>//
77054>>>>>// Description
77054>>>>>//    This object shows the systeminformation on the screen
77054>>>>>//
77054>>>>>// $Rev History
77054>>>>>//    24-09-96  Module header created
77054>>>>>//****************************************************************************
77054>>>>>Class SysInfoDialog Is A ModalPanel
77055>>>>>    Procedure Construct_Object
77057>>>>>        Forward Send Construct_Object
77059>>>>>
77059>>>>>        Set Label to C_$SystemInformation
77060>>>>>        Set Size to 140 267
77061>>>>>        Set piMinSize to 140 267
77062>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77063>>>>>        Set Border_Style to Border_Thick
77064>>>>>
77064>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
77066>>>>>            Set peAnchors to anAll
77067>>>>>        End_Object
77068>>>>>
77068>>>>>        Object oCloseButton Is A Button
77070>>>>>            Set Label To C_$Close
77071>>>>>            Set Location To 120 210
77072>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
77073>>>>>            Set Default_State To True
77074>>>>>            Set peAnchors to anBottomRight
77075>>>>>        End_Object
77076>>>>>
77076>>>>>        On_Key kCancel Send Close_Panel
77077>>>>>    End_Procedure
77078>>>>>End_Class
77079>>>>>
77079>>>>>// Purpose:
77079>>>>>//
77079>>>>>// Ken Ross 12/17/96 5:16PM
77079>>>>>//
77079>>>>>Class AboutDialog Is A ModalPanel
77080>>>>>    Procedure Construct_Object
77082>>>>>        String sVdfRootDir
77082>>>>>
77082>>>>>        Forward Send Construct_Object
77084>>>>>
77084>>>>>        Set Label To C_$About
77085>>>>>        Set Size to 89 212
77086>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77087>>>>>
77087>>>>>        Object oSysInfoDialog Is A SysInfoDialog
77089>>>>>        End_Object
77090>>>>>
77090>>>>>        Object oBox Is A Container3d
77092>>>>>            Set Border_Style To Border_StaticEdge
77093>>>>>            Set Size to 63 202
77094>>>>>            Set Location To 4 5
77095>>>>>
77095>>>>>            Object oAboutGraphic Is A BitmapContainer
77097>>>>>                Set Border_Style To Border_None
77098>>>>>                Set Bitmap_Style To Bitmap_Center
77099>>>>>                Set Size To 48 48
77100>>>>>                Set Location To 7 2
77101>>>>>            End_Object
77102>>>>>
77102>>>>>            Object oProductName Is A TextBox
77104>>>>>                Set Label To C_$ProductName
77105>>>>>                Set Size To 10 45
77106>>>>>                Set Location To 8 53
77107>>>>>            End_Object
77108>>>>>
77108>>>>>            Object oVersion Is A TextBox
77110>>>>>                Set Label To C_$Version
77111>>>>>                Set Size To 10 25
77112>>>>>                Set Location To 21 53
77113>>>>>            End_Object
77114>>>>>
77114>>>>>            Object oCopyright Is A TextBox
77116>>>>>                Set Label To C_$Copyright
77117>>>>>                Set Size To 10 31
77118>>>>>                Set Location To 34 53
77119>>>>>            End_Object
77120>>>>>
77120>>>>>            Object oAuthor Is A TextBox
77122>>>>>                Set Label To C_$Author
77123>>>>>                Set Size To 10 22
77124>>>>>                Set Location To 46 53
77125>>>>>            End_Object
77126>>>>>        End_Object
77127>>>>>
77127>>>>>        Object oOKButton Is A Button
77129>>>>>            On_Item C_$OK Send Close_Panel
77130>>>>>            Set Size To 14 50
77131>>>>>            Set Location To 71 157
77132>>>>>        End_Object
77133>>>>>
77133>>>>>        Object oSysInfoButton Is A Button
77135>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
77136>>>>>            Set Size To 14 50
77137>>>>>            Set Location To 71 101
77138>>>>>        End_Object
77139>>>>>
77139>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
77140>>>>>
77140>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
77141>>>>>    End_Procedure
77142>>>>>
77142>>>>>    Procedure Set ProductName String sProductName
77144>>>>>        Set Label Of oProductName To sProductName
77145>>>>>    End_Procedure
77146>>>>>
77146>>>>>    Procedure Set Version String sVersion
77148>>>>>        Set Label Of oVersion To sVersion
77149>>>>>    End_Procedure
77150>>>>>
77150>>>>>    Procedure Set Copyright string sCopyright
77152>>>>>        Set Label Of oCopyright To sCopyright
77153>>>>>    End_Procedure
77154>>>>>
77154>>>>>    Procedure Set Author String sAuthor
77156>>>>>        Set Label Of oAuthor To sAuthor
77157>>>>>    End_Procedure
77158>>>>>
77158>>>>>    Procedure Set Logo string sLogo
77160>>>>>        // square bitmaps Of 42x42 work best
77160>>>>>        Set Bitmap Of oAboutGraphic To sLogo
77161>>>>>    End_Procedure
77162>>>>>
77162>>>>>    Procedure Show_Sysinfo
77164>>>>>        Send Popup_Modal Of oSysinfoDialog
77165>>>>>    End_Procedure
77166>>>>>
77166>>>>>    Procedure End_Construct_Object
77168>>>>>        Handle hoVersionInfo
77168>>>>>        Boolean bIncluded
77168>>>>>        Integer iMajor iMinor iRelease iBuild
77168>>>>>        String sLabel
77168>>>>>
77168>>>>>        Get Label Of oVersion To sLabel
77169>>>>>        If (sLabel = C_$VERSION) Begin
77171>>>>>            // set it To the version info Of the program, if available
77171>>>>>            If (ghoApplication <> 0) Begin
77173>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
77174>>>>>                If (hoVersionInfo <> 0) Begin
77176>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
77177>>>>>                    If (bIncluded) Begin
77179>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
77180>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
77181>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
77182>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
77183>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
77184>>>>>                        Set Version to sLabel
77185>>>>>                    End
77185>>>>>>
77185>>>>>                End
77185>>>>>>
77185>>>>>            End
77185>>>>>>
77185>>>>>        End
77185>>>>>>
77185>>>>>
77185>>>>>        Forward Send End_Construct_Object
77187>>>>>    End_Procedure
77188>>>>>End_Class
77189>>>
77189>>>// *************************************************************************
77189>>>//  Public message. This is the default message. It is expected that you will
77189>>>//   create your own message to override this
77189>>>// *************************************************************************
77189>>>
77189>>>Procedure Activate_About
77192>>>   Send DoAbout "" "" "" "" ""
77193>>>End_Procedure
77194>>>
77194>>>// *************************************************************************
77194>>>//  Public message. It is expected that you will send this message (most
77194>>>//  likely from Activate_About. This creates an about object, activates it
77194>>>//  and destroys it when done. It is not exepected that you will augment this.
77194>>>// *************************************************************************
77194>>>
77194>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
77197>>>        integer hoObj hoMain
77197>>>
77197>>>        // create object
77197>>>        Object About is an AboutDialog
77199>>>            // if no title passed use the label of the main panel
77199>>>            // (if a main panel exists).
77199>>>            if sTitle     eq '' Begin
77201>>>                Get Main_Window of desktop to hoMain
77202>>>                if hoMain Get Label of hoMain to sTitle
77205>>>            end
77205>>>>
77205>>>            set productname to sTitle
77206>>>            set version     to sVersion
77207>>>            set copyright   to sCopyRight
77208>>>            set author      to sAuthor
77209>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
77212>>>            Move self to hoObj // object Id
77213>>>        End_Object
77214>>>        Send Popup   of hoObj    // popup the about object
77215>>>        Send Destroy of hoObj // when done, it will be destroyed
77216>>>End_procedure
77217>        Use EMPLEADOS.vw
Including file: EMPLEADOS.vw    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\EMPLEADOS.vw)
77217>>>// C:\DataFlex Projects\JUEVESAPPMARCAJES\AppSrc\EMPLEADOS.vw
77217>>>// EMPLEADOS
77217>>>//
77217>>>
77217>>>Use DFClient.pkg
77217>>>Use DFEntry.pkg
77217>>>
77217>>>Use cNacionalidadDataDictionary.dd
Including file: cNacionalidadDataDictionary.dd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\cNacionalidadDataDictionary.dd)
77217>>>>>Use DataDict.pkg
77217>>>>>
77217>>>>>Open Nacionalidad
Including file: Nacionalidad.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\Nacionalidad.fd)
77219>>>>>Open sysemFile
Including file: sysemFile.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\sysemFile.fd)
77221>>>>>Open EmpleadoTable
Including file: EmpleadoTable.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\EmpleadoTable.fd)
77223>>>>>
77223>>>>>Register_Object Nacionalidad_sl
77223>>>>>
77223>>>>>Class cNacionalidadDataDictionary is a DataDictionary
77224>>>>>    
77224>>>>>    Procedure Construct_Object
77226>>>>>        Forward Send Construct_Object
77228>>>>>        Set Main_File to Nacionalidad.File_Number
77229>>>>>
77229>>>>>        Set Add_Client_File to EmpleadoTable.File_Number
77230>>>>>
77230>>>>>        Set Add_System_File to sysemFile.File_Number DD_Lock_On_All
77231>>>>>
77231>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77232>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77233>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77234>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77235>>>>>
77235>>>>>        Set Field_Option Field Nacionalidad.CodigoNacionalidad DD_CAPSLOCK to True
77236>>>>>        Set Key_Field_State Field Nacionalidad.CodigoNacionalidad to True
77237>>>>>        Set Field_Auto_Increment Field Nacionalidad.CodigoNacionalidad to File_Field sysemFile.CodigoNacionalidad
77238>>>>>        Set Field_Prompt_Object Field Nacionalidad.CodigoNacionalidad to Nacionalidad_sl
77239>>>>>
77239>>>>>        Set Field_Option Field Nacionalidad.Pais DD_CAPSLOCK to True
77240>>>>>
77240>>>>>    End_Procedure
77241>>>>>
77241>>>>>End_Class
77242>>>>>
77242>>>>>Use Nacionalidad.sl
Including file: Nacionalidad.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\Nacionalidad.sl)
77242>>>>>>>// Nacionalidad.sl
77242>>>>>>>// Nacionalidad Lookup List
77242>>>>>>>
77242>>>>>>>Use DFClient.pkg
77242>>>>>>>Use cDbCJGridPromptList.pkg
77242>>>>>>>Use cDbCJGridColumn.pkg
77242>>>>>>>Use Windows.pkg
77242>>>>>>>
77242>>>>>>>Use cNacionalidadDataDictionary.dd
77242>>>>>>>
77242>>>>>>>CD_Popup_Object Nacionalidad_sl is a dbModalPanel
77260>>>>>>>>
77260>>>>>>>    Set Location to 5 5
77261>>>>>>>    Set Size to 134 260
77262>>>>>>>    Set Label To "Nacionalidad Lookup List"
77263>>>>>>>    Set Border_Style to Border_Thick
77264>>>>>>>    Set Minimize_Icon to False
77265>>>>>>>
77265>>>>>>>
77265>>>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77267>>>>>>>    End_Object 
77268>>>>>>>
77268>>>>>>>    Set Main_DD To oNacionalidad_DD
77269>>>>>>>    Set Server  To oNacionalidad_DD
77270>>>>>>>
77270>>>>>>>
77270>>>>>>>
77270>>>>>>>    Object oSelList is a cDbCJGridPromptList
77272>>>>>>>        Set Size to 105 250
77273>>>>>>>        Set Location to 5 5
77274>>>>>>>        Set peAnchors to anAll
77275>>>>>>>        Set psLayoutSection to "Nacionalidad_sl_oSelList"
77276>>>>>>>        Set Ordering to 1
77277>>>>>>>        Set pbAutoServer to True
77278>>>>>>>
77278>>>>>>>        Object oNacionalidad_CodigoNacionalidad is a cDbCJGridColumn
77280>>>>>>>            Entry_Item Nacionalidad.CodigoNacionalidad
77281>>>>>>>            Set piWidth to 157
77282>>>>>>>            Set psCaption to "Codigo"
77283>>>>>>>        End_Object 
77284>>>>>>>
77284>>>>>>>        Object oNacionalidad_Pais is a cDbCJGridColumn
77286>>>>>>>            Entry_Item Nacionalidad.Pais
77287>>>>>>>            Set piWidth to 262
77288>>>>>>>            Set psCaption to "Pais"
77289>>>>>>>        End_Object 
77290>>>>>>>
77290>>>>>>>
77290>>>>>>>    End_Object 
77291>>>>>>>
77291>>>>>>>    Object oOk_bn is a Button
77293>>>>>>>        Set Label to "&Ok"
77294>>>>>>>        Set Location to 115 97
77295>>>>>>>        Set peAnchors to anBottomRight
77296>>>>>>>
77296>>>>>>>        Procedure OnClick
77299>>>>>>>            Send OK of oSelList
77300>>>>>>>        End_Procedure
77301>>>>>>>
77301>>>>>>>    End_Object 
77302>>>>>>>
77302>>>>>>>    Object oCancel_bn is a Button
77304>>>>>>>        Set Label to "&Cancel"
77305>>>>>>>        Set Location to 115 151
77306>>>>>>>        Set peAnchors to anBottomRight
77307>>>>>>>
77307>>>>>>>        Procedure OnClick
77310>>>>>>>            Send Cancel of oSelList
77311>>>>>>>        End_Procedure
77312>>>>>>>
77312>>>>>>>    End_Object 
77313>>>>>>>
77313>>>>>>>    Object oSearch_bn is a Button
77315>>>>>>>        Set Label to "&Search..."
77316>>>>>>>        Set Location to 115 205
77317>>>>>>>        Set peAnchors to anBottomRight
77318>>>>>>>
77318>>>>>>>        Procedure OnClick
77321>>>>>>>            Send Search of oSelList
77322>>>>>>>        End_Procedure
77323>>>>>>>
77323>>>>>>>    End_Object 
77324>>>>>>>
77324>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77325>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77326>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77327>>>>>>>
77327>>>>>>>
77327>>>>>>>CD_End_Object // Nacionalidad_sl
77329>>>>>>>>
77329>>>Use cEmpleadoTableDataDictionary.dd
Including file: cEmpleadoTableDataDictionary.dd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\cEmpleadoTableDataDictionary.dd)
77329>>>>>Use DataDict.pkg
77329>>>>>
77329>>>>>Open EmpleadoTable
77331>>>>>Open Nacionalidad
77333>>>>>Open sysemFile
77335>>>>>Open MarcajeTable
Including file: MarcajeTable.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\MarcajeTable.fd)
77337>>>>>
77337>>>>>Register_Object EmpleadoTable_sl
77337>>>>>Register_Object Nacionalidad_sl
77337>>>>>
77337>>>>>Class cEmpleadoTableDataDictionary is a DataDictionary
77338>>>>>    
77338>>>>>    Procedure Construct_Object
77340>>>>>        Forward Send Construct_Object
77342>>>>>        Set Main_File to EmpleadoTable.File_Number
77343>>>>>
77343>>>>>        Set Add_Client_File to MarcajeTable.File_Number
77344>>>>>
77344>>>>>        Set Add_System_File to sysemFile.File_Number DD_Lock_On_All
77345>>>>>
77345>>>>>        Set Add_Server_File to Nacionalidad.File_Number
77346>>>>>
77346>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77347>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77348>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77349>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77350>>>>>
77350>>>>>        Set Key_Field_State Field EmpleadoTable.Codigo to True
77351>>>>>        Set Field_Auto_Increment Field EmpleadoTable.Codigo to File_Field sysemFile.CodigoEmpleado
77352>>>>>        Set Field_Prompt_Object Field EmpleadoTable.Codigo to EmpleadoTable_sl
77353>>>>>
77353>>>>>        Set Field_Option Field EmpleadoTable.PrimerNombre DD_CAPSLOCK to True
77354>>>>>        Set Field_Option Field EmpleadoTable.PrimerNombre DD_REQUIRED to True
77355>>>>>
77355>>>>>        Set Field_Option Field EmpleadoTable.SegundoNombre DD_CAPSLOCK to True
77356>>>>>        Set Field_Option Field EmpleadoTable.SegundoNombre DD_REQUIRED to True
77357>>>>>
77357>>>>>        Set Field_Option Field EmpleadoTable.PrimerApellido DD_CAPSLOCK to True
77358>>>>>        Set Field_Option Field EmpleadoTable.PrimerApellido DD_REQUIRED to True
77359>>>>>
77359>>>>>        Set Field_Option Field EmpleadoTable.SegundoApellido DD_CAPSLOCK to True
77360>>>>>        Set Field_Option Field EmpleadoTable.SegundoApellido DD_REQUIRED to True
77361>>>>>        Set Field_Option Field EmpleadoTable.Nacionalidad DD_CAPSLOCK to True
77362>>>>>        Set Field_Prompt_Object Field EmpleadoTable.Nacionalidad to Nacionalidad_sl
77363>>>>>        Set Field_Option Field EmpleadoTable.Nacionalidad DD_REQUIRED to True
77364>>>>>
77364>>>>>    End_Procedure
77365>>>>>
77365>>>>>End_Class
77366>>>>>
77366>>>>>Use Nacionalidad.sl
77366>>>>>Use EmpleadoTable.sl
Including file: EmpleadoTable.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\EmpleadoTable.sl)
77366>>>>>>>// EmpleadoTable.sl
77366>>>>>>>// EmpleadoTable Lookup List
77366>>>>>>>
77366>>>>>>>Use DFClient.pkg
77366>>>>>>>Use cDbCJGridPromptList.pkg
77366>>>>>>>Use cDbCJGridColumn.pkg
77366>>>>>>>Use Windows.pkg
77366>>>>>>>
77366>>>>>>>Use cNacionalidadDataDictionary.dd
77366>>>>>>>Use cEmpleadoTableDataDictionary.dd
77366>>>>>>>
77366>>>>>>>CD_Popup_Object EmpleadoTable_sl is a dbModalPanel
77384>>>>>>>>
77384>>>>>>>    Set Location to 5 5
77385>>>>>>>    Set Size to 134 610
77386>>>>>>>    Set Label To "EmpleadoTable Lookup List"
77387>>>>>>>    Set Border_Style to Border_Thick
77388>>>>>>>    Set Minimize_Icon to False
77389>>>>>>>
77389>>>>>>>
77389>>>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77391>>>>>>>    End_Object 
77392>>>>>>>
77392>>>>>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
77394>>>>>>>        Set DDO_Server To oNacionalidad_DD
77395>>>>>>>    End_Object 
77396>>>>>>>
77396>>>>>>>    Set Main_DD To oEmpleadoTable_DD
77397>>>>>>>    Set Server  To oEmpleadoTable_DD
77398>>>>>>>
77398>>>>>>>
77398>>>>>>>
77398>>>>>>>    Object oSelList is a cDbCJGridPromptList
77400>>>>>>>        Set Size to 105 600
77401>>>>>>>        Set Location to 5 5
77402>>>>>>>        Set peAnchors to anAll
77403>>>>>>>        Set psLayoutSection to "EmpleadoTable_sl_oSelList"
77404>>>>>>>        Set Ordering to 1
77405>>>>>>>        Set pbAutoServer to True
77406>>>>>>>
77406>>>>>>>        Object oEmpleadoTable_Codigo is a cDbCJGridColumn
77408>>>>>>>            Entry_Item EmpleadoTable.Codigo
77409>>>>>>>            Set piWidth to 105
77410>>>>>>>            Set psCaption to "Codigo"
77411>>>>>>>        End_Object 
77412>>>>>>>
77412>>>>>>>        Object oEmpleadoTable_PrimerNombre is a cDbCJGridColumn
77414>>>>>>>            Entry_Item EmpleadoTable.PrimerNombre
77415>>>>>>>            Set piWidth to 262
77416>>>>>>>            Set psCaption to "Primer Nombre"
77417>>>>>>>        End_Object 
77418>>>>>>>
77418>>>>>>>        Object oEmpleadoTable_SegundoNombre is a cDbCJGridColumn
77420>>>>>>>            Entry_Item EmpleadoTable.SegundoNombre
77421>>>>>>>            Set piWidth to 262
77422>>>>>>>            Set psCaption to "Segundo Nombre"
77423>>>>>>>        End_Object 
77424>>>>>>>
77424>>>>>>>        Object oEmpleadoTable_PrimerApellido is a cDbCJGridColumn
77426>>>>>>>            Entry_Item EmpleadoTable.PrimerApellido
77427>>>>>>>            Set piWidth to 262
77428>>>>>>>            Set psCaption to "Primer Apellido"
77429>>>>>>>        End_Object 
77430>>>>>>>
77430>>>>>>>        Object oEmpleadoTable_SegundoApellido is a cDbCJGridColumn
77432>>>>>>>            Entry_Item EmpleadoTable.SegundoApellido
77433>>>>>>>            Set piWidth to 262
77434>>>>>>>            Set psCaption to "Segundo Apellido"
77435>>>>>>>        End_Object 
77436>>>>>>>
77436>>>>>>>        Object oNacionalidad_CodigoNacionalidad is a cDbCJGridColumn
77438>>>>>>>            Entry_Item Nacionalidad.CodigoNacionalidad
77439>>>>>>>            Set piWidth to 157
77440>>>>>>>            Set psCaption to "Nacionalidad"
77441>>>>>>>        End_Object 
77442>>>>>>>
77442>>>>>>>
77442>>>>>>>    End_Object 
77443>>>>>>>
77443>>>>>>>    Object oOk_bn is a Button
77445>>>>>>>        Set Label to "&Ok"
77446>>>>>>>        Set Location to 115 447
77447>>>>>>>        Set peAnchors to anBottomRight
77448>>>>>>>
77448>>>>>>>        Procedure OnClick
77451>>>>>>>            Send OK of oSelList
77452>>>>>>>        End_Procedure
77453>>>>>>>
77453>>>>>>>    End_Object 
77454>>>>>>>
77454>>>>>>>    Object oCancel_bn is a Button
77456>>>>>>>        Set Label to "&Cancel"
77457>>>>>>>        Set Location to 115 501
77458>>>>>>>        Set peAnchors to anBottomRight
77459>>>>>>>
77459>>>>>>>        Procedure OnClick
77462>>>>>>>            Send Cancel of oSelList
77463>>>>>>>        End_Procedure
77464>>>>>>>
77464>>>>>>>    End_Object 
77465>>>>>>>
77465>>>>>>>    Object oSearch_bn is a Button
77467>>>>>>>        Set Label to "&Search..."
77468>>>>>>>        Set Location to 115 555
77469>>>>>>>        Set peAnchors to anBottomRight
77470>>>>>>>
77470>>>>>>>        Procedure OnClick
77473>>>>>>>            Send Search of oSelList
77474>>>>>>>        End_Procedure
77475>>>>>>>
77475>>>>>>>    End_Object 
77476>>>>>>>
77476>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77477>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77478>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77479>>>>>>>
77479>>>>>>>
77479>>>>>>>CD_End_Object // EmpleadoTable_sl
77481>>>>>>>>
77481>>>
77481>>>ACTIVATE_VIEW Activate_EMPLEADOS FOR EMPLEADOS
77491>>>>
77491>>>Object EMPLEADOS is a dbView
77493>>>    Set Location to 5 5
77494>>>    Set Size to 168 512
77495>>>    Set Label To "EMPLEADOS"
77496>>>    Set Border_Style to Border_Thick
77497>>>
77497>>>
77497>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77499>>>    End_Object 
77500>>>
77500>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
77502>>>        Set DDO_Server To oNacionalidad_DD
77503>>>    End_Object 
77504>>>
77504>>>    Set Main_DD To oEmpleadoTable_DD
77505>>>    Set Server  To oEmpleadoTable_DD
77506>>>
77506>>>
77506>>>
77506>>>    Object oEmpleadoTableCodigo is a dbForm
77508>>>        Entry_Item EmpleadoTable.Codigo
77509>>>        Set Size to 13 262
77510>>>        Set Location to 5 61
77511>>>        Set peAnchors to anTopLeftRight
77512>>>        Set Label to "Codigo"
77513>>>        Set Label_Justification_mode to jMode_Left
77514>>>        Set Label_Col_Offset to 56
77515>>>        Set Label_row_Offset to 0
77516>>>    End_Object 
77517>>>
77517>>>    Object oEmpleadoTablePrimerNombre is a dbForm
77519>>>        Entry_Item EmpleadoTable.PrimerNombre
77520>>>        Set Size to 13 446
77521>>>        Set Location to 20 61
77522>>>        Set peAnchors to anTopLeftRight
77523>>>        Set Label to "Primer Nombre"
77524>>>        Set Label_Justification_mode to jMode_Left
77525>>>        Set Label_Col_Offset to 56
77526>>>        Set Label_row_Offset to 0
77527>>>    End_Object 
77528>>>
77528>>>    Object oEmpleadoTableSegundoNombre is a dbForm
77530>>>        Entry_Item EmpleadoTable.SegundoNombre
77531>>>        Set Size to 13 446
77532>>>        Set Location to 35 61
77533>>>        Set peAnchors to anTopLeftRight
77534>>>        Set Label to "Segundo Nombre"
77535>>>        Set Label_Justification_mode to jMode_Left
77536>>>        Set Label_Col_Offset to 56
77537>>>        Set Label_row_Offset to 0
77538>>>    End_Object 
77539>>>
77539>>>    Object oEmpleadoTablePrimerApellido is a dbForm
77541>>>        Entry_Item EmpleadoTable.PrimerApellido
77542>>>        Set Size to 13 446
77543>>>        Set Location to 50 61
77544>>>        Set peAnchors to anTopLeftRight
77545>>>        Set Label to "Primer Apellido"
77546>>>        Set Label_Justification_mode to jMode_Left
77547>>>        Set Label_Col_Offset to 56
77548>>>        Set Label_row_Offset to 0
77549>>>    End_Object 
77550>>>
77550>>>    Object oEmpleadoTableSegundoApellido is a dbForm
77552>>>        Entry_Item EmpleadoTable.SegundoApellido
77553>>>        Set Size to 13 446
77554>>>        Set Location to 65 61
77555>>>        Set peAnchors to anTopLeftRight
77556>>>        Set Label to "Segundo Apellido"
77557>>>        Set Label_Justification_mode to jMode_Left
77558>>>        Set Label_Col_Offset to 56
77559>>>        Set Label_row_Offset to 0
77560>>>    End_Object 
77561>>>
77561>>>    Object oNacionalidadCodigoNacionalidad is a dbForm
77563>>>        Entry_Item Nacionalidad.CodigoNacionalidad
77564>>>        Set Size to 13 292
77565>>>        Set Location to 80 61
77566>>>        Set peAnchors to anTopLeftRight
77567>>>        Set Label to "Nacionalidad"
77568>>>        Set Label_Justification_mode to jMode_Left
77569>>>        Set Label_Col_Offset to 56
77570>>>        Set Label_row_Offset to 0
77571>>>    End_Object 
77572>>>
77572>>>
77572>>>End_Object 
77573>        Use MARCAJES.vw
Including file: MARCAJES.vw    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\MARCAJES.vw)
77573>>>// C:\DataFlex Projects\JUEVESAPPMARCAJES\AppSrc\MARCAJES.vw
77573>>>// MARCAJES
77573>>>//
77573>>>
77573>>>Use DFClient.pkg
77573>>>Use DFEntry.pkg
77573>>>
77573>>>Use cNacionalidadDataDictionary.dd
77573>>>Use cEmpleadoTableDataDictionary.dd
77573>>>Use cTipoMarcajeTableDataDictionary.dd
Including file: cTipoMarcajeTableDataDictionary.dd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\cTipoMarcajeTableDataDictionary.dd)
77573>>>>>Use DataDict.pkg
77573>>>>>
77573>>>>>Open TipoMarcajeTable
Including file: TipoMarcajeTable.fd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\TipoMarcajeTable.fd)
77575>>>>>Open sysemFile
77577>>>>>Open MarcajeTable
77579>>>>>
77579>>>>>Register_Object TipoMarcajeTable_sl
77579>>>>>
77579>>>>>Class cTipoMarcajeTableDataDictionary is a DataDictionary
77580>>>>>    
77580>>>>>    Procedure Construct_Object
77582>>>>>        Forward Send Construct_Object
77584>>>>>        Set Main_File to TipoMarcajeTable.File_Number
77585>>>>>
77585>>>>>        Set Add_Client_File to MarcajeTable.File_Number
77586>>>>>
77586>>>>>        Set Add_System_File to sysemFile.File_Number DD_Lock_On_All
77587>>>>>
77587>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77588>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77589>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77590>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77591>>>>>
77591>>>>>        Set Key_Field_State Field TipoMarcajeTable.Codigo to True
77592>>>>>        Set Field_Auto_Increment Field TipoMarcajeTable.Codigo to File_Field sysemFile.CodigoTipoMarcaje
77593>>>>>        Set Field_Prompt_Object Field TipoMarcajeTable.Codigo to TipoMarcajeTable_sl
77594>>>>>
77594>>>>>    End_Procedure
77595>>>>>
77595>>>>>End_Class
77596>>>>>
77596>>>>>Use TipoMarcajeTable.sl
Including file: TipoMarcajeTable.sl    (C:\DataFlex Projects\MARCAJESAPP\AppSrc\TipoMarcajeTable.sl)
77596>>>>>>>// TipoMarcajeTable.sl
77596>>>>>>>// TipoMarcajeTable Lookup List
77596>>>>>>>
77596>>>>>>>Use DFClient.pkg
77596>>>>>>>Use cDbCJGridPromptList.pkg
77596>>>>>>>Use cDbCJGridColumn.pkg
77596>>>>>>>Use Windows.pkg
77596>>>>>>>
77596>>>>>>>Use cTipoMarcajeTableDataDictionary.dd
77596>>>>>>>
77596>>>>>>>CD_Popup_Object TipoMarcajeTable_sl is a dbModalPanel
77614>>>>>>>>
77614>>>>>>>    Set Location to 5 5
77615>>>>>>>    Set Size to 134 200
77616>>>>>>>    Set Label To "TipoMarcajeTable Lookup List"
77617>>>>>>>    Set Border_Style to Border_Thick
77618>>>>>>>    Set Minimize_Icon to False
77619>>>>>>>
77619>>>>>>>
77619>>>>>>>    Object oTipoMarcajeTable_DD is a cTipoMarcajeTableDataDictionary
77621>>>>>>>    End_Object 
77622>>>>>>>
77622>>>>>>>    Set Main_DD To oTipoMarcajeTable_DD
77623>>>>>>>    Set Server  To oTipoMarcajeTable_DD
77624>>>>>>>
77624>>>>>>>
77624>>>>>>>
77624>>>>>>>    Object oSelList is a cDbCJGridPromptList
77626>>>>>>>        Set Size to 105 190
77627>>>>>>>        Set Location to 5 5
77628>>>>>>>        Set peAnchors to anAll
77629>>>>>>>        Set psLayoutSection to "TipoMarcajeTable_sl_oSelList"
77630>>>>>>>        Set Ordering to 1
77631>>>>>>>        Set pbAutoServer to True
77632>>>>>>>
77632>>>>>>>        Object oTipoMarcajeTable_Codigo is a cDbCJGridColumn
77634>>>>>>>            Entry_Item TipoMarcajeTable.Codigo
77635>>>>>>>            Set piWidth to 105
77636>>>>>>>            Set psCaption to "Codigo"
77637>>>>>>>        End_Object 
77638>>>>>>>
77638>>>>>>>        Object oTipoMarcajeTable_TipoMarcaje is a cDbCJGridColumn
77640>>>>>>>            Entry_Item TipoMarcajeTable.TipoMarcaje
77641>>>>>>>            Set piWidth to 210
77642>>>>>>>            Set psCaption to "Tipo Marcaje"
77643>>>>>>>        End_Object 
77644>>>>>>>
77644>>>>>>>
77644>>>>>>>    End_Object 
77645>>>>>>>
77645>>>>>>>    Object oOk_bn is a Button
77647>>>>>>>        Set Label to "&Ok"
77648>>>>>>>        Set Location to 115 37
77649>>>>>>>        Set peAnchors to anBottomRight
77650>>>>>>>
77650>>>>>>>        Procedure OnClick
77653>>>>>>>            Send OK of oSelList
77654>>>>>>>        End_Procedure
77655>>>>>>>
77655>>>>>>>    End_Object 
77656>>>>>>>
77656>>>>>>>    Object oCancel_bn is a Button
77658>>>>>>>        Set Label to "&Cancel"
77659>>>>>>>        Set Location to 115 91
77660>>>>>>>        Set peAnchors to anBottomRight
77661>>>>>>>
77661>>>>>>>        Procedure OnClick
77664>>>>>>>            Send Cancel of oSelList
77665>>>>>>>        End_Procedure
77666>>>>>>>
77666>>>>>>>    End_Object 
77667>>>>>>>
77667>>>>>>>    Object oSearch_bn is a Button
77669>>>>>>>        Set Label to "&Search..."
77670>>>>>>>        Set Location to 115 145
77671>>>>>>>        Set peAnchors to anBottomRight
77672>>>>>>>
77672>>>>>>>        Procedure OnClick
77675>>>>>>>            Send Search of oSelList
77676>>>>>>>        End_Procedure
77677>>>>>>>
77677>>>>>>>    End_Object 
77678>>>>>>>
77678>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77679>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77680>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77681>>>>>>>
77681>>>>>>>
77681>>>>>>>CD_End_Object // TipoMarcajeTable_sl
77683>>>>>>>>
77683>>>Use cMarcajeTableDataDictionary.dd
Including file: cMarcajeTableDataDictionary.dd    (C:\DataFlex Projects\MARCAJESAPP\DDSrc\cMarcajeTableDataDictionary.dd)
77683>>>>>Use DataDict.pkg
77683>>>>>
77683>>>>>Open MarcajeTable
77685>>>>>Open EmpleadoTable
77687>>>>>Open TipoMarcajeTable
77689>>>>>Open sysemFile
77691>>>>>
77691>>>>>Register_Object TipoMarcajeTable_sl
77691>>>>>
77691>>>>>Class cMarcajeTableDataDictionary is a DataDictionary
77692>>>>>    
77692>>>>>    Procedure Construct_Object
77694>>>>>        Forward Send Construct_Object
77696>>>>>        Set Main_File to MarcajeTable.File_Number
77697>>>>>
77697>>>>>        Set Add_System_File to sysemFile.File_Number DD_Lock_On_All
77698>>>>>
77698>>>>>        Set Add_Server_File to EmpleadoTable.File_Number
77699>>>>>        Set Add_Server_File to TipoMarcajeTable.File_Number
77700>>>>>
77700>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77701>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77702>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77703>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77704>>>>>
77704>>>>>        Set Key_Field_State Field MarcajeTable.Codigo to True
77705>>>>>        Set Field_Auto_Increment Field MarcajeTable.Codigo to File_Field sysemFile.CodigoMarcaje
77706>>>>>        Set Field_Option Field MarcajeTable.Codigo DD_CAPSLOCK to True
77707>>>>>
77707>>>>>        Set Field_Option Field MarcajeTable.EmpleadoCodigo DD_REQUIRED to True
77708>>>>>
77708>>>>>        Set Field_Option Field MarcajeTable.FechaMarcaje DD_CAPSLOCK to True
77709>>>>>        Set Field_Option Field MarcajeTable.FechaMarcaje DD_REQUIRED to True
77710>>>>>
77710>>>>>        Set Field_Option Field MarcajeTable.HoraMarcaje DD_CAPSLOCK to True
77711>>>>>        Set Field_Option Field MarcajeTable.HoraMarcaje DD_REQUIRED to True
77712>>>>>
77712>>>>>        Set Field_Prompt_Object Field MarcajeTable.TipoMarcaje to TipoMarcajeTable_sl
77713>>>>>        Set Field_Option Field MarcajeTable.TipoMarcaje DD_REQUIRED to True
77714>>>>>
77714>>>>>    End_Procedure
77715>>>>>
77715>>>>>End_Class
77716>>>>>
77716>>>>>Use TipoMarcajeTable.sl
77716>>>Use cDbCJGrid.pkg
77716>>>Use cdbCJGridColumn.pkg
77716>>>
77716>>>ACTIVATE_VIEW Activate_MARCAJES FOR MARCAJES
77726>>>>
77726>>>Object MARCAJES is a dbView
77728>>>    Set Location to 5 5
77729>>>    Set Size to 301 585
77730>>>    Set Label To "MARCAJES"
77731>>>    Set Border_Style to Border_Thick
77732>>>
77732>>>
77732>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77734>>>    End_Object 
77735>>>
77735>>>    Object oEmpleadoTable_DD is a cEmpleadoTableDataDictionary
77737>>>        Set DDO_Server To oNacionalidad_DD
77738>>>    End_Object 
77739>>>
77739>>>    Object oTipoMarcajeTable_DD is a cTipoMarcajeTableDataDictionary
77741>>>    End_Object 
77742>>>
77742>>>    Object oMarcajeTable_DD is a cMarcajeTableDataDictionary
77744>>>        Set DDO_Server To oEmpleadoTable_DD
77745>>>        Set DDO_Server To oTipoMarcajeTable_DD
77746>>>    End_Object 
77747>>>
77747>>>    Set Main_DD To oMarcajeTable_DD
77748>>>    Set Server  To oMarcajeTable_DD
77749>>>
77749>>>    Object oDbCJGrid1 is a cDbCJGrid
77751>>>        Set Size to 262 526
77752>>>        Set Location to 22 23
77753>>>
77753>>>        Object oMarcajeTable_Codigo is a cDbCJGridColumn
77755>>>            Entry_Item MarcajeTable.Codigo
77756>>>            Set piWidth to 168
77757>>>            Set psCaption to "Codigo"
77758>>>        End_Object
77759>>>
77759>>>        Object oMarcajeTable_EmpleadoCodigo is a cDbCJGridColumn
77761>>>            Entry_Item EmpleadoTable.Codigo
77762>>>            Set piWidth to 168
77763>>>            Set psCaption to "Empleado Codigo"
77764>>>        End_Object
77765>>>
77765>>>        Object oMarcajeTable_FechaMarcaje is a cDbCJGridColumn
77767>>>            Entry_Item MarcajeTable.FechaMarcaje
77768>>>            Set piWidth to 168
77769>>>            Set psCaption to "Fecha Marcaje"
77770>>>        End_Object
77771>>>
77771>>>        Object oMarcajeTable_HoraMarcaje is a cDbCJGridColumn
77773>>>            Entry_Item MarcajeTable.HoraMarcaje
77774>>>            Set piWidth to 247
77775>>>            Set psCaption to "HoraMarcaje"
77776>>>        End_Object
77777>>>
77777>>>        Object oMarcajeTable_TipoMarcaje is a cDbCJGridColumn
77779>>>            Entry_Item TipoMarcajeTable.Codigo
77780>>>            Set piWidth to 169
77781>>>            Set psCaption to "Tipo Marcaje"
77782>>>        End_Object
77783>>>    End_Object
77784>>>
77784>>>
77784>>>End_Object 
77785>
77785>        Procedure Activate_About
77788>            Send DoAbout "" "" "" "" ""
77789>        End_Procedure
77790>
77790>    End_Object
77791>
77791>End_Object
77792>
77792>Start_UI
77793>
77793>//************************** end of WindowsProject.tpl for Spanish **************
77793>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 44492
Total Resources: 0
Total Commands : 77792
Total Windows  : 1
Total Pages    : 1
Static Data    : 474198
Message area   : 539097
Total Blocks   : 27971
